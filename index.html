<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
  <meta name="apple-mobile-web-app-capable" content="yes">
  <meta name="apple-mobile-web-app-status-bar-style" content="default">
  <meta name="format-detection" content="telephone=yes">
  <title>Fratelli Pazzi - Aut√©ntica Pizzer√≠a Napolitana en Madrid</title>
  <meta name="description" content="Fratelli Pazzi: aut√©ntica pizzer√≠a napolitana en Madrid. Pizzas artesanas con ingredientes de calidad.">
  <meta name="keywords" content="pizzer√≠a, pizza napolitana, Madrid, comida a domicilio, ofertas">
  <meta property="og:title" content="Fratelli Pazzi - Aut√©ntica Pizzer√≠a Napolitana">
  <meta property="og:description" content="Descubre nuestra carta de pizzas napolitanas y ofertas especiales. Pide online o vis√≠tanos en Madrid.">
  <link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Playfair+Display:wght@700&family=Open+Sans:wght@400;600&display=swap">
  
  <style>
    * { box-sizing: border-box; margin: 0; padding: 0; }
    
    /* LOADING ANIMATIONS */
    .fullscreen-loader {
      position: fixed;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      background: linear-gradient(135deg, #1a1a1a 0%, #2a2a2a 100%);
      display: flex;
      flex-direction: column;
      align-items: center;
      justify-content: center;
      z-index: 9999;
      opacity: 1;
      transition: opacity 0.8s ease, visibility 0.8s ease;
    }
    
    .fullscreen-loader.hidden {
      opacity: 0;
      visibility: hidden;
      pointer-events: none;
    }
    
    .logo-loader {
      position: relative;
      display: inline-block;
      text-align: center;
    }
    
    .logo-text {
      font-family: 'Playfair Display', serif;
      font-size: 48px;
      font-weight: 700;
      color: #D5786C;
      text-shadow: 2px 2px 4px rgba(0,0,0,0.3);
      animation: logoGlow 2s ease-in-out infinite alternate;
      margin-bottom: 15px;
    }
    
    @keyframes logoGlow {
      0% { 
        transform: scale(1);
        filter: brightness(1);
        text-shadow: 2px 2px 4px rgba(0,0,0,0.3);
      }
      100% { 
        transform: scale(1.05);
        filter: brightness(1.2);
        text-shadow: 0 0 30px rgba(213, 120, 108, 0.8), 2px 2px 4px rgba(0,0,0,0.3);
      }
    }
    
    .logo-underline {
      width: 0;
      height: 4px;
      background: linear-gradient(90deg, #D5786C, #e0958a);
      margin: 15px auto;
      border-radius: 2px;
      animation: underlineGrow 3s ease-in-out infinite;
    }
    
    @keyframes underlineGrow {
      0%, 100% { width: 0; }
      50% { width: 100%; }
    }
    
    .loading-text {
      color: #ccc;
      font-size: 18px;
      margin-top: 20px;
      animation: fadeInOut 2s ease-in-out infinite;
    }
    
    @keyframes fadeInOut {
      0%, 100% { opacity: 0.6; }
      50% { opacity: 1; }
    }

    /* SISTEMA DE NOTIFICACIONES MEJORADO */
    .notification-container {
      position: fixed;
      top: 100px;
      right: 20px;
      z-index: 15000;
      display: flex;
      flex-direction: column;
      gap: 15px;
      max-width: 420px;
      pointer-events: none;
    }

    .notification {
      background: white;
      border-radius: 16px;
      padding: 20px 25px;
      box-shadow: 0 12px 40px rgba(0, 0, 0, 0.15);
      border: 1px solid rgba(0, 0, 0, 0.08);
      position: relative;
      overflow: hidden;
      pointer-events: auto;
      transform: translateX(100%);
      opacity: 0;
      transition: all 0.4s cubic-bezier(0.4, 0, 0.2, 1);
      backdrop-filter: blur(10px);
      min-width: 350px;
    }

    .notification.show {
      transform: translateX(0);
      opacity: 1;
    }

    .notification::before {
      content: '';
      position: absolute;
      top: 0;
      left: 0;
      width: 5px;
      height: 100%;
      border-radius: 3px 0 0 3px;
    }

    /* Tipos de notificaci√≥n */
    .notification.success::before {
      background: linear-gradient(135deg, #28a745 0%, #20c997 100%);
    }

    .notification.error::before {
      background: linear-gradient(135deg, #dc3545 0%, #e74c3c 100%);
    }

    .notification.warning::before {
      background: linear-gradient(135deg, #ffc107 0%, #fd7e14 100%);
    }

    .notification.info::before {
      background: linear-gradient(135deg, #17a2b8 0%, #007bff 100%);
    }

    .notification.fratelli::before {
      background: linear-gradient(135deg, #D5786C 0%, #e0958a 100%);
    }

    .notification-header {
      display: flex;
      align-items: center;
      gap: 12px;
      margin-bottom: 12px;
    }

    .notification-icon {
      width: 32px;
      height: 32px;
      border-radius: 50%;
      display: flex;
      align-items: center;
      justify-content: center;
      font-size: 16px;
      font-weight: bold;
      flex-shrink: 0;
    }

    .notification.success .notification-icon {
      background: linear-gradient(135deg, #28a745 0%, #20c997 100%);
      color: white;
    }

    .notification.error .notification-icon {
      background: linear-gradient(135deg, #dc3545 0%, #e74c3c 100%);
      color: white;
    }

    .notification.warning .notification-icon {
      background: linear-gradient(135deg, #ffc107 0%, #fd7e14 100%);
      color: white;
    }

    .notification.info .notification-icon {
      background: linear-gradient(135deg, #17a2b8 0%, #007bff 100%);
      color: white;
    }

    .notification.fratelli .notification-icon {
      background: linear-gradient(135deg, #D5786C 0%, #e0958a 100%);
      color: white;
    }

    .notification-title {
      font-family: 'Playfair Display', serif;
      font-size: 16px;
      font-weight: 700;
      color: #333;
      margin: 0;
      line-height: 1.2;
    }

    .notification-message {
      color: #666;
      font-size: 14px;
      line-height: 1.5;
      margin: 0;
      white-space: pre-line;
    }

    .notification-message strong {
      color: #333;
      font-weight: 600;
    }

    .notification-close {
      position: absolute;
      top: 12px;
      right: 15px;
      background: none;
      border: none;
      color: #999;
      font-size: 18px;
      cursor: pointer;
      width: 24px;
      height: 24px;
      border-radius: 50%;
      display: flex;
      align-items: center;
      justify-content: center;
      transition: all 0.2s ease;
      opacity: 0.7;
    }

    .notification-close:hover {
      background: rgba(0, 0, 0, 0.05);
      color: #666;
      opacity: 1;
    }

    .notification-actions {
      display: flex;
      gap: 10px;
      margin-top: 15px;
      justify-content: flex-end;
    }

    .notification-btn {
      padding: 8px 16px;
      border: none;
      border-radius: 8px;
      font-size: 12px;
      font-weight: 600;
      cursor: pointer;
      transition: all 0.2s ease;
      text-transform: uppercase;
      letter-spacing: 0.5px;
    }

    .notification-btn.primary {
      background: linear-gradient(135deg, #D5786C 0%, #e0958a 100%);
      color: white;
    }

    .notification-btn.primary:hover {
      transform: translateY(-1px);
      box-shadow: 0 4px 12px rgba(213, 120, 108, 0.3);
    }

    .notification-btn.secondary {
      background: #f8f9fa;
      color: #6c757d;
      border: 1px solid #dee2e6;
    }

    .notification-btn.secondary:hover {
      background: #e9ecef;
      color: #495057;
    }

    .notification-progress {
      position: absolute;
      bottom: 0;
      left: 0;
      height: 3px;
      background: rgba(0, 0, 0, 0.1);
      border-radius: 0 0 16px 16px;
      overflow: hidden;
    }

    .notification-progress-bar {
      height: 100%;
      background: linear-gradient(90deg, #D5786C, #e0958a);
      width: 100%;
      transform-origin: left;
      animation: progressSlide 5s linear forwards;
    }

    @keyframes progressSlide {
      from { transform: scaleX(1); }
      to { transform: scaleX(0); }
    }

    /* Responsive para m√≥viles */
    @media (max-width: 768px) {
      .notification-container {
        top: 80px;
        right: 15px;
        left: 15px;
        max-width: none;
      }

      .notification {
        min-width: auto;
        width: 100%;
        padding: 16px 20px;
      }

      .notification-header {
        margin-bottom: 10px;
      }

      .notification-title {
        font-size: 15px;
      }

      .notification-message {
        font-size: 13px;
      }

      .notification-actions {
        margin-top: 12px;
      }

      .notification-btn {
        padding: 6px 12px;
        font-size: 11px;
      }
    }

    /* CONFIRMACI√ìN MODAL MEJORADA */
    .confirmation-modal {
      position: fixed;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      background: rgba(0, 0, 0, 0.6);
      display: flex;
      align-items: center;
      justify-content: center;
      z-index: 20000;
      opacity: 0;
      visibility: hidden;
      transition: all 0.3s ease;
      backdrop-filter: blur(5px);
      padding: 20px;
    }

    .confirmation-modal.show {
      opacity: 1;
      visibility: visible;
    }

    .confirmation-content {
      background: white;
      border-radius: 20px;
      padding: 30px;
      max-width: 450px;
      width: 100%;
      text-align: center;
      box-shadow: 0 20px 60px rgba(0, 0, 0, 0.3);
      transform: scale(0.8);
      transition: transform 0.3s ease;
      position: relative;
      overflow: hidden;
    }

    .confirmation-modal.show .confirmation-content {
      transform: scale(1);
    }

    .confirmation-icon {
      width: 60px;
      height: 60px;
      border-radius: 50%;
      background: linear-gradient(135deg, #D5786C 0%, #e0958a 100%);
      color: white;
      display: flex;
      align-items: center;
      justify-content: center;
      font-size: 24px;
      margin: 0 auto 20px;
      animation: pulseIcon 2s ease-in-out infinite;
    }

    @keyframes pulseIcon {
      0%, 100% { transform: scale(1); }
      50% { transform: scale(1.05); }
    }

    .confirmation-title {
      font-family: 'Playfair Display', serif;
      font-size: 22px;
      color: #333;
      margin-bottom: 15px;
      font-weight: 700;
    }

    .confirmation-message {
      color: #666;
      font-size: 16px;
      line-height: 1.5;
      margin-bottom: 25px;
      white-space: pre-line;
    }

    .confirmation-actions {
      display: flex;
      gap: 15px;
      justify-content: center;
    }

    .confirmation-btn {
      padding: 12px 24px;
      border: none;
      border-radius: 25px;
      font-size: 14px;
      font-weight: 600;
      cursor: pointer;
      transition: all 0.3s ease;
      text-transform: uppercase;
      letter-spacing: 0.5px;
      min-width: 120px;
    }

    .confirmation-btn.confirm {
      background: linear-gradient(135deg, #D5786C 0%, #e0958a 100%);
      color: white;
    }

    .confirmation-btn.confirm:hover {
      transform: translateY(-2px);
      box-shadow: 0 8px 25px rgba(213, 120, 108, 0.4);
    }

    .confirmation-btn.cancel {
      background: #f8f9fa;
      color: #6c757d;
      border: 2px solid #dee2e6;
    }

    .confirmation-btn.cancel:hover {
      background: #e9ecef;
      color: #495057;
    }

    /* PIZZA SPINNER para transiciones */
    .pizza-spinner {
      width: 40px;
      height: 40px;
      position: relative;
      animation: spin 1.5s linear infinite;
      margin: 20px auto;
    }
    
    .pizza-base {
      width: 100%;
      height: 100%;
      background: linear-gradient(135deg, #FFE4B5 0%, #DEB887 100%);
      border-radius: 50%;
      position: relative;
      box-shadow: 0 4px 15px rgba(222, 184, 135, 0.4);
    }
    
    .pizza-sauce {
      width: 75%;
      height: 75%;
      background: linear-gradient(135deg, #D5786C 0%, #c16b5f 100%);
      border-radius: 50%;
      position: absolute;
      top: 12.5%;
      left: 12.5%;
      box-shadow: inset 0 2px 8px rgba(0,0,0,0.2);
    }
    
    .pizza-cheese {
      width: 4px;
      height: 4px;
      background: white;
      border-radius: 50%;
      position: absolute;
      animation: cheeseFloat 2s ease-in-out infinite;
    }
    
    .pizza-cheese:nth-child(1) { top: 25%; left: 30%; animation-delay: 0s; }
    .pizza-cheese:nth-child(2) { top: 40%; left: 60%; animation-delay: 0.5s; }
    .pizza-cheese:nth-child(3) { top: 60%; left: 35%; animation-delay: 1s; }
    
    @keyframes spin {
      0% { transform: rotate(0deg); }
      100% { transform: rotate(360deg); }
    }
    
    @keyframes cheeseFloat {
      0%, 100% { transform: scale(1) translateY(0); opacity: 0.8; }
      50% { transform: scale(1.3) translateY(-1px); opacity: 1; }
    }
    
    /* TRANSICIONES DE SECCI√ìN */
    .section-transition {
      opacity: 0;
      transform: translateY(30px);
      transition: all 0.8s ease;
    }
    
    .section-transition.visible {
      opacity: 1;
      transform: translateY(0);
    }
    
    /* OVERLAY DE TRANSICI√ìN */
    .page-transition-overlay {
      position: fixed;
      top: 0;
      left: -100%;
      width: 100%;
      height: 100%;
      background: linear-gradient(90deg, transparent 0%, #D5786C 50%, transparent 100%);
      z-index: 8888;
      transition: left 0.6s ease;
      pointer-events: none;
    }
    
    .page-transition-overlay.active {
      left: 100%;
    }

    /* AUTH SECTION - Secci√≥n separada para login/registro */
    .auth-section {
      background: linear-gradient(135deg, #FBF4E8 0%, #f8f5f0 100%);
      padding: 60px 20px;
      margin: 0 auto;
      width: 100%;
      max-width: 100vw;
      box-sizing: border-box;
      border-bottom: 1px solid rgba(213, 120, 108, 0.1);
    }
    
    .auth-container {
      max-width: 800px;
      margin: 0 auto;
      text-align: center;
    }
    
    .auth-welcome {
      margin-bottom: 40px;
    }
    
    .auth-icon {
      font-size: 48px;
      margin-bottom: 20px;
      animation: pizzaRotate 3s ease-in-out infinite;
    }
    
    .auth-welcome h2 {
      font-family: 'Playfair Display', serif;
      font-size: 32px;
      color: #D5786C;
      margin-bottom: 15px;
      font-weight: 700;
    }
    
    .auth-welcome h2::before,
    .auth-welcome h2::after {
      display: none;
    }
    
    .auth-welcome p {
      font-size: 18px;
      color: #666;
      line-height: 1.6;
      max-width: 500px;
      margin: 0 auto;
    }
    
    .auth-buttons {
      display: flex;
      justify-content: center;
      gap: 30px;
      margin-bottom: 40px;
      flex-wrap: wrap;
    }
    
    .auth-btn {
      background: white;
      border: 2px solid #D5786C;
      border-radius: 20px;
      padding: 25px 35px;
      cursor: pointer;
      transition: all 0.4s cubic-bezier(0.4, 0, 0.2, 1);
      box-shadow: 0 8px 25px rgba(213, 120, 108, 0.15);
      position: relative;
      overflow: hidden;
      min-width: 280px;
      text-align: left;
    }
    
    .auth-btn::before {
      content: '';
      position: absolute;
      top: 0;
      left: -100%;
      width: 100%;
      height: 100%;
      background: linear-gradient(135deg, #D5786C 0%, #e0958a 100%);
      transition: left 0.4s ease;
      z-index: 0;
    }
    
    .btn-content {
      display: flex;
      align-items: center;
      gap: 15px;
      position: relative;
      z-index: 2;
    }
    
    .btn-icon {
      font-size: 24px;
      background: rgba(213, 120, 108, 0.1);
      width: 50px;
      height: 50px;
      border-radius: 50%;
      display: flex;
      align-items: center;
      justify-content: center;
      transition: all 0.3s ease;
    }
    
    .btn-text {
      display: flex;
      flex-direction: column;
      gap: 2px;
    }
    
    .btn-title {
      font-size: 16px;
      font-weight: 700;
      color: #333;
      transition: color 0.3s ease;
    }
    
    .btn-subtitle {
      font-size: 13px;
      color: #666;
      transition: color 0.3s ease;
    }
    
    .auth-btn:hover {
      transform: translateY(-5px);
      box-shadow: 0 15px 35px rgba(213, 120, 108, 0.25);
      border-color: transparent;
    }
    
    .auth-btn:hover::before {
      left: 0;
    }
    
    .auth-btn:hover .btn-title,
    .auth-btn:hover .btn-subtitle {
      color: white;
    }
    
    .auth-btn:hover .btn-icon {
      background: rgba(255, 255, 255, 0.2);
    }
    
    .register-primary {
      border-color: #D5786C;
    }
    
    .login-secondary {
      border-color: rgba(213, 120, 108, 0.5);
      background: rgba(255, 255, 255, 0.8);
    }
    
    .auth-benefits {
      display: flex;
      justify-content: center;
      gap: 40px;
      margin-bottom: 30px;
      flex-wrap: wrap;
    }
    
    .benefit-item {
      display: flex;
      align-items: center;
      gap: 10px;
      font-size: 14px;
      color: #555;
    }
    
    .benefit-icon {
      font-size: 18px;
      background: rgba(213, 120, 108, 0.1);
      width: 35px;
      height: 35px;
      border-radius: 50%;
      display: flex;
      align-items: center;
      justify-content: center;
    }
    
    .auth-stats {
      font-size: 13px;
      color: #888;
      font-style: italic;
    }

    /* PROFILE SECTION - Secci√≥n de perfil para usuarios logueados */
    .profile-section {
      background: linear-gradient(135deg, #253732 0%, #2d4139 100%);
      color: white;
      padding: 50px 20px;
      margin: 0 auto;
      width: 100%;
      max-width: 100vw;
      box-sizing: border-box;
      position: relative;
      overflow: hidden;
    }
    
    .profile-section::before {
      content: '';
      position: absolute;
      top: -50%;
      left: -50%;
      width: 200%;
      height: 200%;
      background: radial-gradient(circle, rgba(213, 120, 108, 0.08) 0%, transparent 50%);
      animation: rotate 40s linear infinite reverse;
    }
    
    .profile-container {
      max-width: 1200px;
      margin: 0 auto;
      position: relative;
      z-index: 2;
    }
    
    .profile-welcome {
      display: flex;
      align-items: center;
      justify-content: space-between;
      margin-bottom: 40px;
      flex-wrap: wrap;
      gap: 20px;
    }
    
    .profile-avatar {
      width: 80px;
      height: 80px;
      background: linear-gradient(135deg, #D5786C 0%, #e0958a 100%);
      border-radius: 50%;
      display: flex;
      align-items: center;
      justify-content: center;
      font-size: 32px;
      font-weight: 700;
      color: white;
      box-shadow: 0 8px 25px rgba(213, 120, 108, 0.3);
      border: 4px solid rgba(255, 255, 255, 0.2);
    }
    
    .profile-info {
      flex: 1;
      min-width: 200px;
    }
    
    .profile-info h2 {
      font-family: 'Playfair Display', serif;
      font-size: 28px;
      color: white;
      margin-bottom: 5px;
      font-weight: 700;
    }
    
    .profile-info h2::before,
    .profile-info h2::after {
      display: none;
    }
    
    .profile-info p {
      color: rgba(255, 255, 255, 0.8);
      font-size: 16px;
      margin: 0;
    }
    
    .profile-actions {
      display: flex;
      gap: 15px;
    }
    
    .profile-btn {
      background: rgba(255, 255, 255, 0.1);
      color: white;
      border: 1px solid rgba(255, 255, 255, 0.3);
      padding: 12px 20px;
      border-radius: 25px;
      cursor: pointer;
      transition: all 0.3s ease;
      font-weight: 600;
      font-size: 14px;
      display: flex;
      align-items: center;
      gap: 8px;
      backdrop-filter: blur(10px);
    }
    
    .profile-btn:hover {
      background: rgba(255, 255, 255, 0.2);
      transform: translateY(-2px);
      box-shadow: 0 8px 20px rgba(255, 255, 255, 0.1);
    }
    
    .profile-stats {
      display: grid;
      grid-template-columns: repeat(auto-fit, minmax(180px, 1fr));
      gap: 20px;
      margin-bottom: 40px;
    }
    
    .stat-card {
      background: rgba(255, 255, 255, 0.1);
      padding: 25px 20px;
      border-radius: 20px;
      text-align: center;
      backdrop-filter: blur(10px);
      border: 1px solid rgba(255, 255, 255, 0.2);
      transition: all 0.3s ease;
    }
    
    .stat-card:hover {
      transform: translateY(-5px);
      background: rgba(255, 255, 255, 0.15);
      box-shadow: 0 10px 30px rgba(0, 0, 0, 0.2);
    }
    
    .verification-card {
      background: rgba(255, 107, 107, 0.2);
      border-color: rgba(255, 107, 107, 0.4);
    }
    
    .stat-icon {
      font-size: 32px;
      margin-bottom: 15px;
      display: block;
    }
    
    .stat-number {
      display: block;
      font-size: 32px;
      font-weight: 700;
      color: #FFD700;
      margin-bottom: 5px;
    }
    
    .stat-label {
      color: rgba(255, 255, 255, 0.8);
      font-size: 14px;
      font-weight: 500;
    }
    
    .verify-btn {
      background: #ff6b6b;
      color: white;
      border: none;
      padding: 8px 16px;
      border-radius: 15px;
      font-size: 12px;
      font-weight: 600;
      cursor: pointer;
      transition: all 0.3s ease;
      margin-top: 10px;
    }
    
    .verify-btn:hover {
      background: #ff5252;
      transform: scale(1.05);
    }
    
    .profile-quick-actions {
      display: grid;
      grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
      gap: 15px;
      margin-bottom: 40px;
    }
    
    .quick-action-btn {
      background: rgba(255, 255, 255, 0.05);
      color: white;
      border: 1px solid rgba(255, 255, 255, 0.2);
      padding: 20px;
      border-radius: 15px;
      cursor: pointer;
      transition: all 0.3s ease;
      display: flex;
      align-items: center;
      gap: 15px;
      font-weight: 600;
      font-size: 15px;
      backdrop-filter: blur(10px);
    }
    
    .quick-action-btn:hover {
      background: rgba(213, 120, 108, 0.2);
      border-color: rgba(213, 120, 108, 0.4);
      transform: translateY(-3px);
      box-shadow: 0 8px 25px rgba(213, 120, 108, 0.2);
    }
    
    .action-icon {
      font-size: 24px;
      background: rgba(213, 120, 108, 0.3);
      width: 50px;
      height: 50px;
      border-radius: 50%;
      display: flex;
      align-items: center;
      justify-content: center;
    }
    
    .profile-progress {
      background: rgba(255, 255, 255, 0.1);
      padding: 25px;
      border-radius: 20px;
      backdrop-filter: blur(10px);
      border: 1px solid rgba(255, 255, 255, 0.2);
    }
    
    .progress-info {
      display: flex;
      justify-content: space-between;
      align-items: center;
      margin-bottom: 15px;
      flex-wrap: wrap;
      gap: 10px;
    }
    
    .progress-text {
      color: rgba(255, 255, 255, 0.9);
      font-weight: 600;
    }
    
    .progress-points {
      color: #FFD700;
      font-weight: 700;
      font-size: 16px;
    }
    
    .progress-bar {
      width: 100%;
      height: 12px;
      background: rgba(0, 0, 0, 0.3);
      border-radius: 6px;
      overflow: hidden;
      position: relative;
    }
    
    .progress-fill {
      height: 100%;
      background: linear-gradient(90deg, #FFD700 0%, #FFA500 100%);
      border-radius: 6px;
      transition: width 0.8s ease;
      position: relative;
    }
    
    .progress-fill::after {
      content: '';
      position: absolute;
      top: 0;
      left: -100%;
      width: 100%;
      height: 100%;
      background: linear-gradient(90deg, transparent, rgba(255, 255, 255, 0.4), transparent);
      animation: progressShine 2s ease-in-out infinite;
    }
    
    @keyframes progressShine {
      0% { left: -100%; }
      100% { left: 100%; }
    }
    
    /* BANNER DE OFERTA URGENTE */
    .urgent-offer-banner {
      position: fixed;
      top: 0;
      left: 0;
      width: 100%;
      background: linear-gradient(135deg, #d62828 0%, #f72c2c 100%);
      color: white;
      padding: 12px 20px;
      z-index: 1001;
      display: flex;
      align-items: center;
      justify-content: center;
      box-shadow: 0 4px 20px rgba(214, 40, 40, 0.4);
      animation: slideDown 0.5s ease;
      font-weight: 600;
    }
    
    .urgent-offer-banner.hidden {
      transform: translateY(-100%);
      transition: transform 0.3s ease;
    }
    
    @keyframes slideDown {
      from { transform: translateY(-100%); }
      to { transform: translateY(0); }
    }
    
    .offer-content {
      display: flex;
      align-items: center;
      gap: 15px;
      flex-wrap: wrap;
      font-size: 14px;
      justify-content: center;
      flex: 1;
    }
    
    .close-banner {
      background: none;
      border: none;
      color: white;
      font-size: 20px;
      cursor: pointer;
      padding: 5px;
      border-radius: 50%;
      width: 30px;
      height: 30px;
      display: flex;
      align-items: center;
      justify-content: center;
      transition: background 0.2s ease;
      position: absolute;
      right: 20px;
    }
    
    .offer-icon {
      font-size: 18px;
      animation: pulse 2s infinite;
    }
    
    @keyframes pulse {
      0%, 100% { transform: scale(1); }
      50% { transform: scale(1.1); }
    }
    
    .offer-text {
      font-size: 15px;
    }
    
    .offer-code {
      background: rgba(255, 255, 255, 0.2);
      padding: 4px 8px;
      border-radius: 6px;
      font-size: 13px;
      border: 1px solid rgba(255, 255, 255, 0.3);
    }
    
    .offer-timer {
      font-size: 13px;
      background: rgba(0, 0, 0, 0.2);
      padding: 4px 8px;
      border-radius: 6px;
    }
    
    .offer-cta {
      background: linear-gradient(135deg, #ffffff 0%, #f8f9fa 100%);
      color: #d62828;
      border: none;
      padding: 10px 20px;
      border-radius: 25px;
      font-weight: 700;
      font-size: 13px;
      cursor: pointer;
      transition: all 0.4s cubic-bezier(0.4, 0, 0.2, 1);
      text-transform: uppercase;
      letter-spacing: 0.8px;
      position: relative;
      overflow: hidden;
      box-shadow: 0 4px 15px rgba(255, 255, 255, 0.3);
      backdrop-filter: blur(10px);
      border: 2px solid rgba(255, 255, 255, 0.2);
    }
    
    .offer-cta::before {
      content: '';
      position: absolute;
      top: 0;
      left: -100%;
      width: 100%;
      height: 100%;
      background: linear-gradient(135deg, #d62828 0%, #f72c2c 100%);
      transition: left 0.4s ease;
      z-index: 0;
    }
    
    .offer-cta::after {
      content: 'üî•';
      position: absolute;
      top: 50%;
      right: 10px;
      transform: translateY(-50%);
      opacity: 0;
      transition: all 0.3s ease;
      z-index: 2;
      font-size: 14px;
    }
    
    .offer-cta span {
      position: relative;
      z-index: 2;
    }
    
    .offer-cta:hover {
      color: white;
      transform: scale(1.08);
      box-shadow: 0 8px 25px rgba(214, 40, 40, 0.4);
    }
    
    .offer-cta:hover::before {
      left: 0;
    }
    
    .offer-cta:hover::after {
      opacity: 1;
      right: 8px;
      animation: flame 0.6s ease infinite;
    }
    
    @keyframes flame {
      0%, 100% { transform: translateY(-50%) scale(1); }
      50% { transform: translateY(-50%) scale(1.1); }
    }
    
    .close-banner:hover {
      background: rgba(255, 255, 255, 0.2);
    }
    
    /* Ajustar header cuando est√° el banner */
    .with-banner {
      top: 60px;
    }

    body { 
      font-family: 'Open Sans', sans-serif; 
      background: linear-gradient(135deg, #FBF4E8 0%, #f8f5f0 100%);
      color: #333; 
      line-height: 1.6; 
      overflow-x: hidden;
      margin: 0;
      padding: 0;
      -webkit-overflow-scrolling: touch;
      scroll-behavior: smooth;
      -webkit-tap-highlight-color: rgba(213, 120, 108, 0.2);
      padding-top: 60px;
      width: 100%;
      min-height: 100vh;
      display: flex;
      flex-direction: column;
      align-items: center;
    }
    
    header { 
      background: linear-gradient(135deg, #FBF4E8 0%, #f8f5f0 100%);
      padding: 30px 20px; 
      text-align: center; 
      border-bottom: 1px solid #eee; 
      position: sticky; 
      top: 0; 
      z-index: 100; 
      box-shadow: 0 4px 20px rgba(0,0,0,0.08);
      backdrop-filter: blur(15px);
      transition: all 0.3s ease;
      -webkit-backdrop-filter: blur(15px);
      width: 100%;
      max-width: 100vw;
      margin: 0 auto;
    }
    
    /* Header compacto en scroll para m√≥vil */
    .header-scrolled {
      padding: 15px 20px;
      box-shadow: 0 6px 30px rgba(0,0,0,0.12);
    }
    
    .header-scrolled h1 {
      font-size: 28px;
    }
    
    .header-scrolled nav {
      margin-top: 10px;
    }
    
    .header-scrolled nav a {
      padding: 6px 8px;
      font-size: 12px;
    }
    
    header h1 { 
      font-family: 'Playfair Display', serif; 
      font-size: 42px; 
      color: #D5786C; 
      text-shadow: 2px 2px 4px rgba(0,0,0,0.1);
      margin-bottom: 15px;
      position: relative;
    }
    
    header h1::after {
      content: '';
      position: absolute;
      bottom: -8px;
      left: 50%;
      transform: translateX(-50%);
      width: 60px;
      height: 3px;
      background: linear-gradient(90deg, #D5786C, #e0958a);
      border-radius: 2px;
    }
    
    nav { 
      margin-top: 20px; 
      display: flex;
      justify-content: center;
      flex-wrap: wrap;
      gap: 25px;
      position: relative;
    }
    
    nav::before {
      content: '';
      position: absolute;
      top: -10px;
      left: 50%;
      transform: translateX(-50%);
      width: 200px;
      height: 1px;
      background: linear-gradient(90deg, transparent, rgba(213, 120, 108, 0.2), transparent);
    }
    
    nav a { 
      color: #333; 
      padding: 8px 12px;
      text-decoration: none; 
      font-weight: 500; 
      border-radius: 0;
      transition: all 0.2s ease;
      position: relative;
      overflow: hidden;
      border: none;
      letter-spacing: 0.3px;
      font-size: 14px;
      min-height: auto;
      min-width: auto;
      display: flex;
      align-items: center;
      justify-content: center;
      text-align: center;
      -webkit-tap-highlight-color: transparent;
      touch-action: manipulation;
      background: transparent;
      backdrop-filter: none;
      box-shadow: none;
    }
    
    nav a::before {
      content: '';
      position: absolute;
      bottom: 0;
      left: 50%;
      transform: translateX(-50%);
      width: 0;
      height: 2px;
      background: #D5786C;
      transition: width 0.3s ease;
      z-index: 1;
    }
    
    nav a::after {
      display: none;
    }
    
    nav a:hover {
      color: #D5786C;
      background: transparent;
      border-color: transparent;
      transform: none;
      box-shadow: none;
    }
    
    nav a:hover::before {
      width: 100%;
    }
    
    nav a:active {
      transform: none;
    }
    
    /* CONTADOR DE ACTIVIDAD EN TIEMPO REAL */
    .live-activity {
      background: linear-gradient(135deg, #253732 0%, #2d4139 100%);
      color: white;
      padding: 20px 40px;
      margin: 0 auto;
      border-radius: 0;
      width: 100%;
      max-width: 100vw;
      box-sizing: border-box;
    }
    
    .activity-content {
      max-width: 1200px;
      margin: 0 auto;
      display: flex;
      justify-content: center;
      align-items: center;
      gap: 40px;
      flex-wrap: wrap;
    }
    
    .activity-item {
      display: flex;
      align-items: center;
      gap: 8px;
      font-size: 15px;
      font-weight: 600;
      padding: 8px 15px;
      background: rgba(255, 255, 255, 0.1);
      border-radius: 20px;
      backdrop-filter: blur(10px);
      border: 1px solid rgba(255, 255, 255, 0.2);
    }
    
    .live-indicator {
      animation: blink 1.5s infinite;
    }
    
    @keyframes blink {
      0%, 50% { opacity: 1; }
      51%, 100% { opacity: 0.4; }
    }

    /* ¬øPOR QU√â FRATELLI PAZZI? */
    .why-us {
      background: linear-gradient(135deg, #FBF4E8 0%, #f8f5f0 100%);
      padding: 80px 20px;
      margin: 0 auto;
      width: 100%;
      max-width: 100vw;
      box-sizing: border-box;
    }
    
    .benefits-grid {
      display: grid;
      grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
      gap: 30px;
      max-width: 1200px;
      margin: 0 auto;
      margin-top: 50px;
    }
    
    .benefit-card {
      background: white;
      padding: 35px 25px;
      border-radius: 20px;
      text-align: center;
      box-shadow: 0 10px 30px rgba(0, 0, 0, 0.08);
      transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
      border: 1px solid rgba(213, 120, 108, 0.1);
      position: relative;
      overflow: hidden;
    }
    
    .benefit-card::before {
      content: '';
      position: absolute;
      top: 0;
      left: -100%;
      width: 100%;
      height: 100%;
      background: linear-gradient(90deg, transparent, rgba(213, 120, 108, 0.05), transparent);
      transition: left 0.5s ease;
    }
    
    .benefit-card:hover::before {
      left: 100%;
    }
    
    .benefit-card:hover {
      transform: translateY(-10px);
      box-shadow: 0 20px 40px rgba(0, 0, 0, 0.12);
      border-color: rgba(213, 120, 108, 0.2);
    }
    
    .benefit-icon {
      font-size: 48px;
      margin-bottom: 20px;
      display: block;
    }
    
    .benefit-card h3 {
      font-family: 'Playfair Display', serif;
      font-size: 22px;
      color: #D5786C;
      margin-bottom: 15px;
      font-weight: 700;
    }
    
    .benefit-card p {
      color: #666;
      line-height: 1.6;
      font-size: 16px;
    }
    
    .highlight {
      color: #D5786C;
      font-weight: 600;
    }

    /* PIZZAS M√ÅS PEDIDAS */
    .most-ordered {
      background: linear-gradient(135deg, rgba(213, 120, 108, 0.03) 0%, rgba(224, 149, 138, 0.03) 100%);
      padding: 80px 20px;
      margin: 0 auto;
      width: 100%;
      max-width: 100vw;
      box-sizing: border-box;
    }
    
    .featured-pizzas {
      display: grid;
      grid-template-columns: repeat(auto-fit, minmax(320px, 1fr));
      gap: 35px;
      max-width: 1200px;
      margin: 0 auto;
      margin-top: 50px;
    }
    
    .featured-pizza-card {
      background: white;
      border-radius: 24px;
      overflow: hidden;
      box-shadow: 0 15px 35px rgba(0, 0, 0, 0.1);
      transition: all 0.4s cubic-bezier(0.4, 0, 0.2, 1);
      border: 2px solid transparent;
      position: relative;
    }
    
    .featured-pizza-card.bestseller {
      border-color: #d62828;
      transform: scale(1.05);
    }
    
    .featured-pizza-card:hover {
      transform: translateY(-15px) scale(1.03);
      box-shadow: 0 25px 50px rgba(0, 0, 0, 0.15);
    }
    
    .featured-pizza-card.bestseller:hover {
      transform: translateY(-15px) scale(1.08);
    }
    
    .bestseller-badge {
      position: absolute;
      top: 15px;
      right: 15px;
      background: linear-gradient(135deg, #d62828 0%, #f72c2c 100%);
      color: white;
      padding: 8px 12px;
      border-radius: 20px;
      font-size: 12px;
      font-weight: 700;
      z-index: 10;
      animation: pulse 2s infinite;
      box-shadow: 0 4px 15px rgba(214, 40, 40, 0.4);
    }
    
    .popular-badge {
      position: absolute;
      top: 15px;
      right: 15px;
      background: linear-gradient(135deg, #D5786C 0%, #e0958a 100%);
      color: white;
      padding: 8px 12px;
      border-radius: 20px;
      font-size: 12px;
      font-weight: 700;
      z-index: 10;
      box-shadow: 0 4px 15px rgba(213, 120, 108, 0.4);
    }
    
    .featured-pizza-card img {
      width: 100%;
      height: 220px;
      object-fit: cover;
      transition: transform 0.3s ease;
    }
    
    .featured-pizza-card:hover img {
      transform: scale(1.1);
    }
    
    .featured-info {
      padding: 25px;
      text-align: center;
    }
    
    .featured-info h3 {
      font-family: 'Playfair Display', serif;
      font-size: 24px;
      color: #111;
      margin-bottom: 10px;
      font-weight: 700;
    }
    
    .customer-quote {
      font-style: italic;
      color: #666;
      margin-bottom: 20px;
      font-size: 15px;
    }
    
    .price-action {
      display: flex;
      align-items: center;
      justify-content: space-between;
      gap: 15px;
    }
    
    .featured-price {
      font-size: 28px;
      font-weight: 700;
      color: #D5786C;
      background: rgba(213, 120, 108, 0.1);
      padding: 10px 20px;
      border-radius: 25px;
    }
    
    .quick-order-btn {
      background: linear-gradient(135deg, #D5786C 0%, #e0958a 50%, #f4a99c 100%);
      color: white;
      border: none;
      padding: 14px 24px;
      border-radius: 25px;
      font-weight: 700;
      font-size: 14px;
      cursor: pointer;
      transition: all 0.4s cubic-bezier(0.4, 0, 0.2, 1);
      text-transform: uppercase;
      letter-spacing: 0.5px;
      flex: 1;
      max-width: 160px;
      position: relative;
      overflow: hidden;
      box-shadow: 0 6px 20px rgba(213, 120, 108, 0.3);
      backdrop-filter: blur(10px);
    }
    
    .quick-order-btn::before {
      content: '';
      position: absolute;
      top: 0;
      left: -100%;
      width: 100%;
      height: 100%;
      background: linear-gradient(135deg, #c16b5f 0%, #d07066 100%);
      transition: left 0.4s ease;
      z-index: 0;
    }
    
    .quick-order-btn::after {
      content: '‚ö°';
      position: absolute;
      top: 50%;
      right: 10px;
      transform: translateY(-50%);
      opacity: 0;
      transition: all 0.3s ease;
      z-index: 2;
      font-size: 16px;
    }
    
    .quick-order-btn span {
      position: relative;
      z-index: 2;
    }
    
    .quick-order-btn:hover {
      transform: translateY(-3px) scale(1.05);
      box-shadow: 0 12px 30px rgba(213, 120, 108, 0.4);
    }
    
    .quick-order-btn:hover::before {
      left: 0;
    }
    
    .quick-order-btn:hover::after {
      opacity: 1;
      right: 8px;
      animation: sparkle 0.6s ease;
    }
    
    @keyframes sparkle {
      0%, 100% { transform: translateY(-50%) rotate(0deg); }
      50% { transform: translateY(-50%) rotate(180deg); }
    }
    
    .quick-order-btn:active {
      transform: translateY(-1px) scale(1.02);
    }

    /* TESTIMONIOS Y RESE√ëAS */
    .testimonials {
      background: white;
      padding: 80px 20px;
      margin: 0 auto;
      width: 100%;
      max-width: 100vw;
      box-sizing: border-box;
    }
    
    .reviews-container {
      display: grid;
      grid-template-columns: repeat(auto-fit, minmax(350px, 1fr));
      gap: 25px;
      max-width: 1200px;
      margin: 0 auto;
      margin-top: 50px;
    }
    
    .review-card {
      background: linear-gradient(135deg, #FBF4E8 0%, #f8f5f0 100%);
      padding: 25px;
      border-radius: 20px;
      box-shadow: 0 8px 25px rgba(0, 0, 0, 0.06);
      border: 1px solid rgba(213, 120, 108, 0.1);
      transition: all 0.3s ease;
      position: relative;
    }
    
    .review-card:hover {
      transform: translateY(-5px);
      box-shadow: 0 15px 35px rgba(0, 0, 0, 0.1);
    }
    
    .review-header {
      display: flex;
      justify-content: space-between;
      align-items: flex-start;
      margin-bottom: 15px;
    }
    
    .reviewer-info {
      display: flex;
      align-items: center;
      gap: 12px;
    }
    
    .reviewer-avatar {
      width: 45px;
      height: 45px;
      background: linear-gradient(135deg, #D5786C 0%, #e0958a 100%);
      color: white;
      border-radius: 50%;
      display: flex;
      align-items: center;
      justify-content: center;
      font-weight: 700;
      font-size: 18px;
    }
    
    .reviewer-details h4 {
      margin: 0;
      font-size: 16px;
      color: #333;
      font-weight: 600;
    }
    
    .review-date {
      font-size: 13px;
      color: #666;
    }
    
    .stars {
      font-size: 16px;
    }
    
    .review-text {
      color: #555;
      line-height: 1.6;
      font-size: 15px;
      margin-bottom: 15px;
    }
    
    .google-badge {
      background: #4285F4;
      color: white;
      padding: 4px 10px;
      border-radius: 15px;
      font-size: 11px;
      font-weight: 600;
      display: inline-block;
      text-transform: uppercase;
      letter-spacing: 0.5px;
    }
    
    .google-rating-summary {
      text-align: center;
      margin-top: 50px;
      padding: 40px;
      background: linear-gradient(135deg, #253732 0%, #2d4139 100%);
      border-radius: 20px;
      color: white;
      max-width: 600px;
      margin-left: auto;
      margin-right: auto;
    }
    
    .rating-big {
      font-size: 48px;
      font-weight: 700;
      margin-bottom: 15px;
      color: #FFD700;
    }
    
    .rating-details p {
      font-size: 18px;
      margin-bottom: 20px;
      opacity: 0.9;
    }
    
    .view-all-reviews {
      color: #D5786C;
      text-decoration: none;
      font-weight: 600;
      background: white;
      padding: 12px 25px;
      border-radius: 25px;
      transition: all 0.3s ease;
      display: inline-block;
    }
    
    .view-all-reviews:hover {
      background: #f8f9fa;
      transform: translateY(-2px);
      box-shadow: 0 8px 25px rgba(0, 0, 0, 0.1);
    }

    /* TIMELINE DE FRESCURA */
    .freshness-timeline {
      background: linear-gradient(135deg, #FBF4E8 0%, #f8f5f0 100%);
      padding: 80px 20px;
      margin: 0 auto;
      width: 100%;
      max-width: 100vw;
      box-sizing: border-box;
    }
    
    .timeline-container {
      display: flex;
      align-items: center;
      justify-content: center;
      max-width: 1000px;
      margin: 0 auto;
      margin-top: 50px;
      flex-wrap: wrap;
      gap: 20px;
    }
    
    .timeline-step {
      background: white;
      padding: 30px 25px;
      border-radius: 20px;
      text-align: center;
      box-shadow: 0 10px 30px rgba(0, 0, 0, 0.08);
      border: 2px solid rgba(213, 120, 108, 0.1);
      transition: all 0.3s ease;
      flex: 1;
      min-width: 200px;
      max-width: 250px;
    }
    
    .timeline-step:hover {
      transform: translateY(-10px);
      box-shadow: 0 20px 40px rgba(0, 0, 0, 0.12);
      border-color: rgba(213, 120, 108, 0.3);
    }
    
    .step-icon {
      font-size: 48px;
      margin-bottom: 20px;
      display: block;
    }
    
    .timeline-step h3 {
      font-family: 'Playfair Display', serif;
      font-size: 20px;
      color: #D5786C;
      margin-bottom: 10px;
      font-weight: 700;
    }
    
    .timeline-step p {
      color: #666;
      margin-bottom: 15px;
      font-size: 15px;
      line-height: 1.5;
    }
    
    .step-time {
      background: linear-gradient(135deg, #D5786C 0%, #e0958a 100%);
      color: white;
      padding: 6px 15px;
      border-radius: 20px;
      font-weight: 600;
      font-size: 14px;
      display: inline-block;
    }
    
    .timeline-arrow {
      font-size: 24px;
      color: #D5786C;
      font-weight: 700;
      margin: 0 10px;
      opacity: 0.7;
    }
    
    .freshness-guarantee {
      text-align: center;
      margin-top: 50px;
      padding: 25px;
      background: linear-gradient(135deg, #28a745 0%, #20c997 100%);
      color: white;
      border-radius: 20px;
      max-width: 800px;
      margin-left: auto;
      margin-right: auto;
      box-shadow: 0 10px 30px rgba(40, 167, 69, 0.3);
    }
    
    .guarantee-icon {
      font-size: 24px;
      margin-right: 10px;
    }
    
    .freshness-guarantee strong {
      font-size: 18px;
    }

    /* PROGRAMA DE FIDELIDAD */
    .loyalty-program {
      background: linear-gradient(135deg, #253732 0%, #2d4139 100%);
      color: white;
      padding: 80px 20px;
      margin: 0 auto;
      position: relative;
      overflow: hidden;
      width: 100%;
      max-width: 100vw;
      box-sizing: border-box;
    }
    
    .loyalty-program::before {
      content: '';
      position: absolute;
      top: -50%;
      left: -50%;
      width: 200%;
      height: 200%;
      background: radial-gradient(circle, rgba(255,255,255,0.05) 0%, transparent 50%);
      animation: rotate 40s linear infinite reverse;
    }
    
    .loyalty-program h2,
    .loyalty-program .section-intro {
      color: white;
      position: relative;
      z-index: 2;
    }
    
    .loyalty-program h2::before,
    .loyalty-program h2::after {
      background: linear-gradient(90deg, transparent, white, transparent);
    }
    
    .loyalty-container {
      display: grid;
      grid-template-columns: repeat(auto-fit, minmax(280px, 1fr));
      gap: 30px;
      max-width: 1000px;
      margin: 0 auto;
      margin-top: 50px;
      position: relative;
      z-index: 2;
    }
    
    .loyalty-card {
      background: white;
      color: #333;
      padding: 30px 25px;
      border-radius: 20px;
      text-align: center;
      box-shadow: 0 10px 30px rgba(0, 0, 0, 0.2);
      transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
      border: 2px solid transparent;
      position: relative;
      overflow: hidden;
    }
    
    .loyalty-card.featured {
      border-color: #FFD700;
      transform: scale(1.05);
      background: linear-gradient(135deg, #fff9e6 0%, #fff 100%);
    }
    
    .loyalty-card::before {
      content: '';
      position: absolute;
      top: 0;
      left: -100%;
      width: 100%;
      height: 100%;
      background: linear-gradient(90deg, transparent, rgba(37, 55, 50, 0.05), transparent);
      transition: left 0.5s ease;
    }
    
    .loyalty-card:hover::before {
      left: 100%;
    }
    
    .loyalty-card:hover {
      transform: translateY(-10px) scale(1.02);
      box-shadow: 0 20px 40px rgba(0, 0, 0, 0.25);
    }
    
    .loyalty-card.featured:hover {
      transform: translateY(-10px) scale(1.08);
    }
    
    .loyalty-icon {
      font-size: 48px;
      margin-bottom: 20px;
      display: block;
    }
    
    .loyalty-card h3 {
      font-family: 'Playfair Display', serif;
      font-size: 22px;
      color: #253732;
      margin-bottom: 15px;
      font-weight: 700;
    }
    
    .loyalty-card p {
      color: #666;
      margin-bottom: 20px;
      font-size: 16px;
      line-height: 1.5;
    }
    
    .points-example {
      background: rgba(37, 55, 50, 0.1);
      color: #253732;
      padding: 10px 15px;
      border-radius: 20px;
      font-weight: 600;
      font-size: 14px;
    }
    
    .loyalty-cta {
      text-align: center;
      margin-top: 50px;
      position: relative;
      z-index: 2;
    }
    
    .loyalty-cta p {
      color: white;
      margin-bottom: 25px;
      font-size: 18px;
    }
    
    .loyalty-btn {
      background: linear-gradient(135deg, #FFD700 0%, #FFA500 50%, #FF8C00 100%);
      color: #333;
      border: none;
      padding: 20px 40px;
      border-radius: 50px;
      font-weight: 700;
      font-size: 16px;
      cursor: pointer;
      transition: all 0.4s cubic-bezier(0.4, 0, 0.2, 1);
      text-transform: uppercase;
      letter-spacing: 1px;
      box-shadow: 0 10px 30px rgba(255, 215, 0, 0.4);
      position: relative;
      overflow: hidden;
      backdrop-filter: blur(10px);
    }
    
    .loyalty-btn::before {
      content: '';
      position: absolute;
      top: 0;
      left: -100%;
      width: 100%;
      height: 100%;
      background: linear-gradient(135deg, #e6c200 0%, #e6930 50%, #e67e00 100%);
      transition: left 0.5s ease;
      z-index: 0;
    }
    
    .loyalty-btn::after {
      content: 'üëë';
      position: absolute;
      top: 50%;
      right: 30px;
      transform: translateY(-50%);
      opacity: 0;
      transition: all 0.4s ease;
      z-index: 2;
      font-size: 20px;
    }
    
    .loyalty-btn span {
      position: relative;
      z-index: 2;
    }
    
    .loyalty-btn:hover {
      transform: translateY(-5px) scale(1.05);
      box-shadow: 0 15px 40px rgba(255, 215, 0, 0.5);
    }
    
    .loyalty-btn:hover::before {
      left: 0;
    }
    
    .loyalty-btn:hover::after {
      opacity: 1;
      right: 25px;
      animation: crownShine 0.8s ease infinite;
    }
    
    @keyframes crownShine {
      0%, 100% { transform: translateY(-50%) scale(1); }
      50% { transform: translateY(-50%) scale(1.1); }
    }

    /* ZONA DE ENTREGA */
    .delivery-zone {
      background: linear-gradient(135deg, #FBF4E8 0%, #f8f5f0 100%);
      padding: 80px 20px;
      margin: 0 auto;
      width: 100%;
      max-width: 100vw;
      box-sizing: border-box;
    }
    
    .delivery-info-grid {
      display: grid;
      grid-template-columns: 1fr 1fr;
      gap: 50px;
      max-width: 1200px;
      margin: 0 auto;
      margin-top: 50px;
      align-items: start;
    }
    
    .delivery-map {
      background: white;
      border-radius: 20px;
      padding: 40px 30px;
      box-shadow: 0 10px 30px rgba(0, 0, 0, 0.08);
      border: 1px solid rgba(213, 120, 108, 0.1);
      text-align: center;
    }
    
    .map-placeholder {
      position: relative;
    }
    
    .map-icon {
      font-size: 64px;
      margin-bottom: 20px;
      display: block;
      color: #D5786C;
    }
    
    .delivery-map h3 {
      font-family: 'Playfair Display', serif;
      font-size: 24px;
      color: #333;
      margin-bottom: 10px;
      font-weight: 700;
    }
    
    .delivery-map p {
      color: #666;
      margin-bottom: 30px;
      font-size: 16px;
    }
    
    .delivery-zones {
      text-align: left;
    }
    
    .zone-item {
      display: flex;
      align-items: center;
      gap: 12px;
      margin-bottom: 12px;
      font-size: 15px;
      color: #555;
    }
    
    .zone-dot {
      width: 12px;
      height: 12px;
      border-radius: 50%;
      flex-shrink: 0;
    }
    
    .zona-a { background: #28a745; }
    .zona-b { background: #ffc107; }
    .zona-c { background: #dc3545; }
    
    .delivery-details {
      display: grid;
      gap: 25px;
    }
    
    .delivery-feature {
      background: white;
      padding: 25px;
      border-radius: 16px;
      display: flex;
      align-items: center;
      gap: 20px;
      box-shadow: 0 8px 25px rgba(0, 0, 0, 0.06);
      border: 1px solid rgba(213, 120, 108, 0.1);
      transition: all 0.3s ease;
    }
    
    .delivery-feature:hover {
      transform: translateY(-5px);
      box-shadow: 0 15px 35px rgba(0, 0, 0, 0.1);
    }
    
    .feature-icon {
      font-size: 32px;
      width: 60px;
      height: 60px;
      background: linear-gradient(135deg, rgba(213, 120, 108, 0.1) 0%, rgba(224, 149, 138, 0.1) 100%);
      border-radius: 50%;
      display: flex;
      align-items: center;
      justify-content: center;
      flex-shrink: 0;
    }
    
    .feature-content h4 {
      font-family: 'Playfair Display', serif;
      font-size: 18px;
      color: #333;
      margin-bottom: 5px;
      font-weight: 700;
    }
    
    .feature-content p {
      color: #666;
      margin: 0;
      font-size: 15px;
      line-height: 1.4;
    }

    /* WHATSAPP FLOATING BUTTON */
    .whatsapp-float {
      position: fixed;
      bottom: 30px;
      left: 30px;
      background: linear-gradient(135deg, #25D366 0%, #128C7E 100%);
      color: white;
      border-radius: 50px;
      padding: 15px 20px;
      box-shadow: 0 8px 30px rgba(37, 211, 102, 0.4);
      cursor: pointer;
      transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
      z-index: 999;
      display: flex;
      align-items: center;
      gap: 12px;
      font-weight: 600;
      min-width: 200px;
      position: relative;
      animation: whatsappPulse 3s ease-in-out infinite;
    }
    
    @keyframes whatsappPulse {
      0%, 100% { transform: scale(1); }
      50% { transform: scale(1.05); }
    }
    
    .whatsapp-float:hover {
      transform: translateY(-5px) scale(1.05);
      box-shadow: 0 15px 40px rgba(37, 211, 102, 0.5);
    }
    
    .whatsapp-icon {
      font-size: 24px;
      background: rgba(255, 255, 255, 0.2);
      border-radius: 50%;
      width: 40px;
      height: 40px;
      display: flex;
      align-items: center;
      justify-content: center;
    }
    
    .whatsapp-text {
      flex: 1;
    }
    
    .whatsapp-title {
      font-size: 14px;
      line-height: 1.2;
    }
    
    .whatsapp-subtitle {
      font-size: 12px;
      opacity: 0.9;
      line-height: 1.2;
    }
    
    .whatsapp-badge {
      position: absolute;
      top: -8px;
      right: -8px;
      background: #FF4444;
      color: white;
      font-size: 10px;
      padding: 4px 8px;
      border-radius: 10px;
      font-weight: 700;
      animation: badgeBounce 2s ease-in-out infinite;
    }
    
    @keyframes badgeBounce {
      0%, 100% { transform: scale(1); }
      50% { transform: scale(1.1); }
    }

    /* MENU DE USUARIO - Navegaci√≥n limpia sin botones
       Botones de usuario ahora en secci√≥n dedicada arriba del slider
       Para acceso al debug mode: Ctrl+Alt+D */
    .user-menu {
      display: flex;
      align-items: center;
      gap: 15px;
    }
    
    .user-menu a {
      display: flex;
      align-items: center;
      gap: 6px;
      padding: 8px 16px;
      border-radius: 20px;
      transition: all 0.3s ease;
      font-weight: 500;
      text-decoration: none;
      font-size: 13px;
      cursor: pointer;
      white-space: nowrap;
      position: relative;
      overflow: hidden;
      text-transform: uppercase;
      letter-spacing: 0.5px;
      min-height: 36px;
      box-shadow: 0 2px 8px rgba(0,0,0,0.08);
    }
    
    .user-menu .register-btn {
      background: linear-gradient(135deg, #D5786C 0%, #e0958a 50%, #f4a99c 100%);
      color: white;
      border: none;
      position: relative;
    }
    
    .user-menu .register-btn::before {
      content: '';
      position: absolute;
      top: 0;
      left: -100%;
      width: 100%;
      height: 100%;
      background: linear-gradient(135deg, #c16b5f 0%, #d07066 50%, #e08074 100%);
      transition: left 0.4s ease;
      z-index: -1;
    }
    
    .user-menu .register-btn::after {
      content: '‚ú®';
      position: absolute;
      top: 50%;
      right: 15px;
      transform: translateY(-50%);
      opacity: 0;
      transition: all 0.3s ease;
      font-size: 12px;
    }
    
    .user-menu .register-btn:hover {
      transform: translateY(-1px) scale(1.02);
      box-shadow: 0 6px 16px rgba(213, 120, 108, 0.3);
    }
    
    .user-menu .register-btn:hover::before {
      left: 0;
    }
    
    .user-menu .register-btn:hover::after {
      opacity: 1;
      right: 8px;
    }
    
    .user-menu .login-btn {
      background: linear-gradient(135deg, rgba(255,255,255,0.9) 0%, rgba(255,255,255,0.7) 100%);
      color: #D5786C;
      border: 2px solid #D5786C;
      backdrop-filter: blur(10px);
      position: relative;
    }
    
    .user-menu .login-btn::before {
      content: '';
      position: absolute;
      top: 0;
      left: -100%;
      width: 100%;
      height: 100%;
      background: linear-gradient(135deg, #D5786C 0%, #e0958a 100%);
      transition: left 0.4s ease;
      z-index: -1;
    }
    
    .user-menu .login-btn::after {
      content: 'üîê';
      position: absolute;
      top: 50%;
      right: 15px;
      transform: translateY(-50%);
      opacity: 0;
      transition: all 0.3s ease;
      font-size: 12px;
    }
    
    .user-menu .login-btn:hover {
      color: white;
      border-color: transparent;
      transform: translateY(-1px) scale(1.02);
      box-shadow: 0 6px 16px rgba(213, 120, 108, 0.25);
    }
    
    .user-menu .login-btn:hover::before {
      left: 0;
    }
    
    .user-menu .login-btn:hover::after {
      opacity: 1;
      right: 12px;
    }
    
    /* Asegurar que todos los spans est√©n por encima de los efectos */
    .button span,
    .quick-order-btn span,
    .login-btn-submit span,
    .register-btn span,
    .offer-cta span,
    .loyalty-btn span,
    .newsletter button span,
    .popup-cta span,
    .user-menu .register-btn span,
    .user-menu .login-btn span {
      position: relative;
      z-index: 2;
      display: inline-block;
    }
    
    .user-welcome {
      display: flex;
      align-items: center;
      gap: 10px;
      color: #D5786C;
      font-weight: 600;
      cursor: pointer;
      flex-wrap: wrap;
    }
    
    .user-avatar {
      width: 32px;
      height: 32px;
      background: linear-gradient(135deg, #D5786C 0%, #e0958a 100%);
      border-radius: 50%;
      display: flex;
      align-items: center;
      justify-content: center;
      color: white;
      font-weight: bold;
      font-size: 14px;
    }
    
    .user-dropdown {
      position: relative;
      display: inline-block;
    }
    
    .dropdown-content {
      display: none;
      position: absolute;
      right: 0;
      top: 100%;
      background: white;
      min-width: 180px;
      box-shadow: 0 8px 32px rgba(0,0,0,0.1);
      border-radius: 10px;
      z-index: 1000;
      border: 1px solid #eee;
      margin-top: 5px;
    }
    
    .dropdown-content.show {
      display: block;
      animation: dropdownFadeIn 0.2s ease;
    }
    
    .dropdown-content a {
      color: #333;
      padding: 12px 16px;
      text-decoration: none;
      display: flex;
      align-items: center;
      gap: 8px;
      transition: background 0.2s ease;
      border-radius: 8px;
      margin: 4px;
      white-space: nowrap;
    }
    
    .dropdown-content a:hover {
      background: #f8f8f8;
      color: #D5786C;
    }
    
    @keyframes dropdownFadeIn {
      from { opacity: 0; transform: translateY(-10px); }
      to { opacity: 1; transform: translateY(0); }
    }

    /* POPUP OVERLAY GENERAL */
    .popup-overlay {
      position: fixed;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      background: rgba(0, 0, 0, 0.7);
      display: flex;
      justify-content: center;
      align-items: center;
      z-index: 10000;
      opacity: 0;
      visibility: hidden;
      transition: all 0.3s ease;
    }
    
    .popup-overlay.show {
      opacity: 1;
      visibility: visible;
    }
    
    .popup-container {
      background: white;
      border-radius: 15px;
      width: 90%;
      max-width: 450px;
      max-height: 90vh;
      overflow-y: auto;
      box-shadow: 0 20px 40px rgba(0, 0, 0, 0.3);
      transform: scale(0.8);
      transition: transform 0.3s ease;
    }
    
    .popup-overlay.show .popup-container {
      transform: scale(1);
    }
    
    .popup-header {
      background: linear-gradient(135deg, #333 0%, #444 100%);
      color: white;
      padding: 20px;
      border-radius: 15px 15px 0 0;
      position: relative;
      text-align: center;
    }
    
    .popup-header h2 {
      margin: 0;
      font-family: 'Playfair Display', serif;
      font-size: 24px;
      font-weight: 700;
      color: white;
    }
    
    .close-btn {
      position: absolute;
      right: 15px;
      top: 50%;
      transform: translateY(-50%);
      background: none;
      border: none;
      color: white;
      font-size: 28px;
      cursor: pointer;
      width: 35px;
      height: 35px;
      border-radius: 50%;
      display: flex;
      align-items: center;
      justify-content: center;
      transition: background 0.2s ease;
    }
    
    .close-btn:hover {
      background: rgba(255, 255, 255, 0.2);
    }
    
    .popup-body {
      padding: 30px;
    }
    
    .form-group {
      margin-bottom: 20px;
    }
    
    .form-group input {
      width: 100%;
      padding: 15px;
      border: 2px solid #E8E8E8;
      border-radius: 10px;
      font-size: 16px;
      font-family: 'Open Sans', sans-serif;
      transition: border-color 0.3s ease;
      box-sizing: border-box;
    }
    
    .form-group input:focus {
      outline: none;
      border-color: #D5786C;
    }
    
    .login-btn-submit, .register-btn {
      width: 100%;
      background: linear-gradient(135deg, #D5786C 0%, #e0958a 50%, #f4a99c 100%);
      color: white;
      border: none;
      padding: 18px 25px;
      border-radius: 25px;
      font-size: 16px;
      font-weight: 700;
      cursor: pointer;
      transition: all 0.4s cubic-bezier(0.4, 0, 0.2, 1);
      margin-top: 15px;
      text-transform: uppercase;
      letter-spacing: 1px;
      position: relative;
      overflow: hidden;
      box-shadow: 0 8px 25px rgba(213, 120, 108, 0.3);
      backdrop-filter: blur(10px);
    }
    
    .login-btn-submit::before, .register-btn::before {
      content: '';
      position: absolute;
      top: 0;
      left: -100%;
      width: 100%;
      height: 100%;
      background: linear-gradient(135deg, #c16b5f 0%, #d07066 50%, #e08074 100%);
      transition: left 0.5s ease;
      z-index: 0;
    }
    
    .login-btn-submit::after {
      content: 'üîê';
      position: absolute;
      top: 50%;
      right: 25px;
      transform: translateY(-50%);
      opacity: 0;
      transition: all 0.4s ease;
      z-index: 2;
      font-size: 18px;
    }
    
    .register-btn::after {
      content: '‚ú®';
      position: absolute;
      top: 50%;
      right: 25px;
      transform: translateY(-50%);
      opacity: 0;
      transition: all 0.4s ease;
      z-index: 2;
      font-size: 18px;
    }
    
    .login-btn-submit span, .register-btn span {
      position: relative;
      z-index: 2;
    }
    
    .login-btn-submit:hover, .register-btn:hover {
      transform: translateY(-3px) scale(1.02);
      box-shadow: 0 15px 35px rgba(213, 120, 108, 0.4);
    }
    
    .login-btn-submit:hover::before, .register-btn:hover::before {
      left: 0;
    }
    
    .login-btn-submit:hover::after, .register-btn:hover::after {
      opacity: 1;
      right: 20px;
      animation: iconBounce 0.6s ease;
    }
    
    @keyframes iconBounce {
      0%, 100% { transform: translateY(-50%) scale(1); }
      50% { transform: translateY(-50%) scale(1.2); }
    }
    
    .login-btn-submit:active, .register-btn:active {
      transform: translateY(-1px) scale(1.01);
    }
    
    .login-options {
      text-align: center;
      margin: 20px 0;
    }
    
    .login-options a {
      color: #D5786C;
      text-decoration: none;
      font-size: 14px;
      transition: color 0.3s ease;
    }
    
    .login-options a:hover {
      color: #c06959;
    }
    
    .register-link, .login-link {
      text-align: center;
      margin-top: 20px;
      font-size: 14px;
      color: #666;
    }
    
    .register-link a, .login-link a {
      color: #D5786C;
      text-decoration: none;
      font-weight: 600;
      transition: color 0.3s ease;
    }
    
    .register-link a:hover, .login-link a:hover {
      color: #c06959;
    }
    
    .checkbox-group {
      margin: 20px 0;
    }
    
    .checkbox-label {
      display: flex;
      align-items: flex-start;
      gap: 10px;
      margin-bottom: 15px;
      font-size: 14px;
      line-height: 1.4;
      cursor: pointer;
    }
    
    .checkbox-label input[type="checkbox"] {
      display: none;
    }
    
    .checkmark {
      width: 20px;
      height: 20px;
      border: 2px solid #D5786C;
      border-radius: 4px;
      position: relative;
      transition: all 0.3s ease;
      flex-shrink: 0;
      margin-top: 2px;
    }
    
    .checkbox-label input[type="checkbox"]:checked + .checkmark {
      background: #D5786C;
    }
    
    .checkbox-label input[type="checkbox"]:checked + .checkmark::after {
      content: '‚úì';
      position: absolute;
      top: 50%;
      left: 50%;
      transform: translate(-50%, -50%);
      color: white;
      font-size: 14px;
      font-weight: bold;
    }
    
    .checkbox-label a {
      color: #D5786C;
      text-decoration: none;
      transition: color 0.3s ease;
    }
    
    .checkbox-label a:hover {
      color: #c06959;
      text-decoration: underline;
    }

    .login-error, .register-error {
      background: #ffe6e6;
      border: 1px solid #ffcccc;
      color: #cc0000;
      padding: 10px;
      border-radius: 8px;
      margin: 10px 0;
      text-align: center;
      display: none;
    }
    
    .login-error p, .register-error p {
      margin: 0;
      font-size: 14px;
    }

    /* POPUP DE DESCUENTO */
    .discount-popup {
      position: fixed;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      z-index: 9999;
      display: none;
      align-items: center;
      justify-content: center;
      padding: 20px;
    }
    
    .discount-popup.show {
      display: flex;
      animation: popupFadeIn 0.3s ease;
    }
    
    @keyframes popupFadeIn {
      from { opacity: 0; }
      to { opacity: 1; }
    }
    
    .discount-popup .popup-overlay {
      position: absolute;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      background: rgba(0, 0, 0, 0.6);
      backdrop-filter: blur(5px);
    }
    
    .popup-content {
      background: white;
      border-radius: 25px;
      max-width: 450px;
      width: 100%;
      position: relative;
      z-index: 10;
      overflow: hidden;
      box-shadow: 0 20px 60px rgba(0, 0, 0, 0.3);
      animation: popupSlideUp 0.4s cubic-bezier(0.34, 1.2, 0.64, 1);
    }
    
    @keyframes popupSlideUp {
      from { 
        transform: translateY(50px) scale(0.9);
        opacity: 0;
      }
      to { 
        transform: translateY(0) scale(1);
        opacity: 1;
      }
    }
    
    .popup-close {
      position: absolute;
      top: 15px;
      right: 15px;
      background: rgba(0, 0, 0, 0.1);
      border: none;
      color: #666;
      font-size: 24px;
      cursor: pointer;
      width: 40px;
      height: 40px;
      border-radius: 50%;
      display: flex;
      align-items: center;
      justify-content: center;
      transition: all 0.2s ease;
      z-index: 15;
    }
    
    .popup-close:hover {
      background: rgba(220, 53, 69, 0.1);
      color: #dc3545;
    }
    
    .discount-popup .popup-header {
      background: linear-gradient(135deg, #D5786C 0%, #e0958a 100%);
      color: white;
      padding: 40px 30px 30px 30px;
      text-align: center;
      position: relative;
    }
    
    .popup-pizza {
      font-size: 48px;
      margin-bottom: 15px;
      display: block;
      animation: pizzaRotate 3s ease-in-out infinite;
    }
    
    @keyframes pizzaRotate {
      0%, 100% { transform: rotate(0deg); }
      50% { transform: rotate(10deg); }
    }
    
    .discount-popup .popup-header h3 {
      font-family: 'Playfair Display', serif;
      font-size: 24px;
      margin-bottom: 10px;
      font-weight: 700;
    }
    
    .discount-popup .popup-header p {
      font-size: 16px;
      opacity: 0.95;
      margin: 0;
    }
    
    .discount-code {
      background: linear-gradient(135deg, #FFD700 0%, #FFA500 100%);
      color: #333;
      padding: 20px;
      border-radius: 15px;
      text-align: center;
      margin-bottom: 25px;
      position: relative;
      overflow: hidden;
    }
    
    .discount-code::before {
      content: '';
      position: absolute;
      top: 0;
      left: -100%;
      width: 100%;
      height: 100%;
      background: linear-gradient(90deg, transparent, rgba(255, 255, 255, 0.3), transparent);
      animation: codeShine 3s ease-in-out infinite;
    }
    
    @keyframes codeShine {
      0% { left: -100%; }
      100% { left: 100%; }
    }
    
    .code-label {
      font-size: 14px;
      display: block;
      margin-bottom: 5px;
    }
    
    .code-value {
      font-size: 24px;
      font-weight: 700;
      letter-spacing: 2px;
      position: relative;
      z-index: 2;
    }
    
    .popup-benefits {
      margin-bottom: 25px;
    }
    
    .benefit-item {
      color: #666;
      margin-bottom: 8px;
      font-size: 14px;
      line-height: 1.4;
    }
    
    .popup-cta {
      background: linear-gradient(135deg, #D5786C 0%, #e0958a 50%, #f4a99c 100%);
      color: white;
      border: none;
      padding: 18px 30px;
      border-radius: 50px;
      font-weight: 700;
      font-size: 16px;
      cursor: pointer;
      transition: all 0.4s cubic-bezier(0.4, 0, 0.2, 1);
      width: 100%;
      text-transform: uppercase;
      letter-spacing: 1px;
      margin-bottom: 20px;
      position: relative;
      overflow: hidden;
      box-shadow: 0 10px 30px rgba(213, 120, 108, 0.4);
      backdrop-filter: blur(10px);
    }
    
    .popup-cta::before {
      content: '';
      position: absolute;
      top: 0;
      left: -100%;
      width: 100%;
      height: 100%;
      background: linear-gradient(135deg, #c16b5f 0%, #d07066 50%, #e08074 100%);
      transition: left 0.5s ease;
      z-index: 0;
    }
    
    .popup-cta::after {
      content: 'üéâ';
      position: absolute;
      top: 50%;
      right: 25px;
      transform: translateY(-50%);
      opacity: 0;
      transition: all 0.4s ease;
      z-index: 2;
      font-size: 20px;
    }
    
    .popup-cta span {
      position: relative;
      z-index: 2;
    }
    
    .popup-cta:hover {
      transform: translateY(-4px) scale(1.03);
      box-shadow: 0 15px 40px rgba(213, 120, 108, 0.5);
    }
    
    .popup-cta:hover::before {
      left: 0;
    }
    
    .popup-cta:hover::after {
      opacity: 1;
      right: 20px;
      animation: celebration 0.8s ease infinite;
    }
    
    @keyframes celebration {
      0%, 100% { transform: translateY(-50%) rotate(0deg) scale(1); }
      25% { transform: translateY(-50%) rotate(-10deg) scale(1.1); }
      75% { transform: translateY(-50%) rotate(10deg) scale(1.1); }
    }
    
    .popup-timer {
      text-align: center;
      color: #dc3545;
      font-size: 13px;
      font-weight: 600;
      margin: 0;
    }
    
    #popup-countdown {
      background: rgba(220, 53, 69, 0.1);
      color: #dc3545;
      padding: 2px 8px;
      border-radius: 10px;
      font-weight: 700;
    }
    
    /* Reset completo para el slider */
    .fullwidth-slider {
      width: 100%;
      max-width: 100vw;
      height: calc(100vw * 325 / 1920);
      position: relative;
      overflow: hidden;
      margin: 0 auto;
      padding: 0;
      box-shadow: 0 8px 30px rgba(0,0,0,0.15);
    }
    
    .fullwidth-slider .slider-wrapper { 
      display: flex; 
      transition: transform 1s cubic-bezier(0.77, 0, 0.175, 1); 
      height: 100%;
      width: 100%;
    }
    
    .fullwidth-slider img { 
      flex: 0 0 100%; 
      width: 100%; 
      height: calc(100vw * 325 / 1920);
      object-fit: fill; 
      filter: brightness(0.95);
      transition: filter 0.3s ease;
    }
    
    .fullwidth-slider:hover img {
      filter: brightness(1);
    }
    
    .fullwidth-slider .slider-controls { 
      position: absolute; 
      top: 50%; 
      width: 100%; 
      display: flex; 
      justify-content: space-between; 
      transform: translateY(-50%); 
      padding: 0 30px; 
      opacity: 0; 
      transition: opacity 0.3s; 
    }
    
    .fullwidth-slider:hover .slider-controls { opacity: 1; }
    
    .fullwidth-slider .slider-controls button { 
      background: rgba(213, 120, 108, 0.9); 
      border: none; 
      color: #fff; 
      font-size: 1.8em; 
      padding: 15px 20px; 
      border-radius: 50%; 
      cursor: pointer; 
      transition: all 0.3s ease;
      backdrop-filter: blur(10px);
      box-shadow: 0 4px 15px rgba(213, 120, 108, 0.3);
    }
    
    .fullwidth-slider .slider-controls button:hover {
      background: rgba(213, 120, 108, 1);
      transform: scale(1.1);
      box-shadow: 0 6px 20px rgba(213, 120, 108, 0.4);
    }
    
    .fullwidth-slider .slider-dots { 
      position: absolute; 
      bottom: 20px; 
      width: 100%; 
      text-align: center; 
    }
    
    .fullwidth-slider .slider-dots span { 
      display: inline-block; 
      width: 12px; 
      height: 12px; 
      margin: 0 8px; 
      background: rgba(255,255,255,0.6); 
      border-radius: 50%; 
      cursor: pointer; 
      transition: all 0.3s ease;
      border: 2px solid transparent;
    }
    
    .fullwidth-slider .slider-dots span:hover {
      background: rgba(255,255,255,0.8);
      transform: scale(1.2);
    }
    
    .fullwidth-slider .slider-dots span.active { 
      background: #D5786C; 
      border-color: white;
      transform: scale(1.3);
    }
    
    section { 
      padding: 80px 20px; 
      max-width: 1200px; 
      margin: 0 auto; 
      width: 100%;
      box-sizing: border-box;
    }
    
    h2 { 
      font-family: 'Playfair Display', serif; 
      color: #D5786C; 
      font-size: 36px; 
      margin-bottom: 20px;
      text-shadow: 1px 1px 3px rgba(0,0,0,0.1);
      text-align: center;
      position: relative;
      padding-bottom: 25px;
      letter-spacing: 0.5px;
    }
    
    h2::before {
      content: '';
      position: absolute;
      bottom: 0;
      left: 50%;
      transform: translateX(-50%);
      width: 120px;
      height: 1px;
      background: linear-gradient(90deg, transparent, #D5786C, transparent);
    }
    
    h2::after {
      content: '';
      position: absolute;
      bottom: 8px;
      left: 50%;
      transform: translateX(-50%);
      width: 60px;
      height: 3px;
      background: linear-gradient(90deg, #D5786C, #e0958a);
      border-radius: 2px;
    }
    
    .section-intro {
      text-align: center;
      font-size: 18px;
      color: #666;
      margin-bottom: 50px;
      max-width: 600px;
      margin-left: auto;
      margin-right: auto;
      line-height: 1.7;
      position: relative;
      padding: 0 20px;
    }
    
    .section-intro::before {
      content: '';
      position: absolute;
      top: -20px;
      left: 50%;
      transform: translateX(-50%);
      width: 3px;
      height: 3px;
      background: #D5786C;
      border-radius: 50%;
      box-shadow: 
        -20px 0 0 #D5786C,
        20px 0 0 #D5786C,
        -10px 0 0 rgba(213, 120, 108, 0.5),
        10px 0 0 rgba(213, 120, 108, 0.5);
    }
    
    .galeria { 
      display: grid; 
      grid-template-columns: repeat(auto-fit, minmax(320px, 1fr)); 
      gap: 35px; 
      margin-top: 40px; 
    }
    
    .pizza-card { 
      position: relative; 
      background: linear-gradient(135deg, #FBF4E8 0%, #f8f5f0 100%);
      border-radius: 24px; 
      overflow: hidden; 
      box-shadow: 0 10px 30px rgba(0,0,0,0.08); 
      transition: all 0.4s cubic-bezier(0.4, 0, 0.2, 1);
      border: 1px solid rgba(213, 120, 108, 0.1);
      transform-style: preserve-3d;
    }
    
    .pizza-card::before {
      content: '';
      position: absolute;
      top: 0;
      left: -100%;
      width: 100%;
      height: 100%;
      background: linear-gradient(90deg, transparent, rgba(255,255,255,0.4), transparent);
      transition: left 0.5s ease;
      z-index: 1;
    }
    
    .pizza-card::after {
      content: '';
      position: absolute;
      top: 20px;
      right: 20px;
      width: 40px;
      height: 1px;
      background: linear-gradient(90deg, transparent, rgba(213, 120, 108, 0.3));
      transform: rotate(45deg);
      opacity: 0;
      transition: opacity 0.3s ease;
    }
    
    .pizza-card:hover::before {
      left: 100%;
    }
    
    .pizza-card:hover::after {
      opacity: 1;
    }
    
    .pizza-card:hover { 
      transform: translateY(-15px) scale(1.03);
      box-shadow: 0 25px 50px rgba(0,0,0,0.15);
      border-color: rgba(213, 120, 108, 0.3);
    }
    
    .pizza-card img { 
      width: 100%; 
      height: 220px;
      object-fit: cover;
      transition: transform 0.3s ease;
      border-radius: 24px 24px 0 0;
    }
    
    .pizza-card:hover img {
      transform: scale(1.05);
    }
    
    .pizza-info { 
      padding: 30px 25px; 
      text-align: center; 
      position: relative;
      z-index: 2;
      min-height: 120px;
      display: flex;
      flex-direction: column;
      justify-content: center;
      gap: 8px;
    }
    
    .pizza-name { 
      font-family: 'Playfair Display', serif; 
      font-size: 24px; 
      color: #111; 
      margin-bottom: 8px;
      font-weight: 700;
      line-height: 1.2;
      transition: all 0.4s ease;
      letter-spacing: 0.3px;
    }
    
    .pizza-card:hover .pizza-name {
      opacity: 0;
      transform: translateY(-10px);
    }
    
    .pizza-price { 
      color: #D5786C; 
      font-weight: 600; 
      font-size: 22px;
      margin-bottom: 0;
      background: rgba(213, 120, 108, 0.1);
      display: inline-block;
      padding: 8px 16px;
      border-radius: 20px;
      transition: all 0.4s ease;
      letter-spacing: 0.5px;
    }
    
    .pizza-card:hover .pizza-price {
      opacity: 0;
      transform: translateY(10px);
    }
    
    .pizza-description { 
      position: absolute; 
      bottom: -100%; 
      left: 0; 
      width: 100%; 
      background: linear-gradient(135deg, rgba(213, 120, 108, 0.95) 0%, rgba(224, 149, 138, 0.95) 100%);
      color: white;
      padding: 25px 20px; 
      font-size: 15px; 
      line-height: 1.6; 
      transition: bottom 0.4s cubic-bezier(0.68, -0.55, 0.265, 1.55);
      backdrop-filter: blur(10px);
      border-radius: 0 0 24px 24px;
      display: flex;
      align-items: center;
      justify-content: center;
      text-align: center;
    }
    
    .pizza-card:hover .pizza-description { 
      bottom: 0; 
    }
    
    .button { 
      display: inline-flex; 
      align-items: center;
      justify-content: center;
      gap: 10px;
      background: linear-gradient(135deg, #D5786C 0%, #e0958a 50%, #f4a99c 100%);
      color: #fff; 
      padding: 18px 35px; 
      border-radius: 50px; 
      text-decoration: none; 
      font-weight: 700; 
      font-size: 16px;
      transition: all 0.4s cubic-bezier(0.175, 0.885, 0.32, 1.275);
      box-shadow: 0 8px 25px rgba(213, 120, 108, 0.3);
      border: none;
      cursor: pointer;
      position: relative;
      overflow: hidden;
      min-height: 56px;
      min-width: 160px;
      text-align: center;
      -webkit-tap-highlight-color: transparent;
      touch-action: manipulation;
      text-transform: uppercase;
      letter-spacing: 1px;
      backdrop-filter: blur(10px);
    }
    
    .button::before {
      content: '';
      position: absolute;
      top: 0;
      left: -100%;
      width: 100%;
      height: 100%;
      background: linear-gradient(135deg, #c16b5f 0%, #d07066 50%, #e08074 100%);
      transition: left 0.5s ease;
      z-index: 0;
    }
    
    .button::after {
      content: 'üçï';
      position: absolute;
      top: 50%;
      right: 20px;
      transform: translateY(-50%);
      opacity: 0;
      transition: all 0.4s ease;
      z-index: 2;
      font-size: 18px;
    }
    
    .button span {
      position: relative;
      z-index: 2;
    }
    
    .button:hover::before {
      left: 0;
    }
    
    .button:hover::after {
      opacity: 1;
      right: 15px;
      animation: pizzaBounce 0.6s ease;
    }
    
    @keyframes pizzaBounce {
      0%, 100% { transform: translateY(-50%) scale(1); }
      50% { transform: translateY(-50%) scale(1.2); }
    }
    
    .button:hover {
      transform: translateY(-5px) scale(1.03);
      box-shadow: 0 15px 40px rgba(213, 120, 108, 0.4);
    }
    
    .button:active {
      transform: translateY(-2px) scale(1.01);
      box-shadow: 0 8px 20px rgba(213, 120, 108, 0.5);
    }
    
    .button-large {
      padding: 22px 45px;
      font-size: 18px;
      margin-top: 30px;
      min-height: 64px;
      min-width: 200px;
    }
    
    .button-large::after {
      font-size: 20px;
    }

    #servicio-pedidos {
      background: linear-gradient(135deg, #D5786C 0%, #e0958a 100%);
      color: white;
      text-align: center;
      margin: 80px auto;
      max-width: 1000px;
      border-radius: 20px;
      padding: 60px 40px;
      box-shadow: 0 15px 35px rgba(213, 120, 108, 0.3);
      position: relative;
      overflow: hidden;
      width: calc(100% - 40px);
      box-sizing: border-box;
    }
    
    #servicio-pedidos::before {
      content: '';
      position: absolute;
      top: -50%;
      left: -50%;
      width: 200%;
      height: 200%;
      background: radial-gradient(circle, rgba(255,255,255,0.1) 0%, transparent 50%);
      animation: rotate 20s linear infinite;
    }
    
    @keyframes rotate {
      0% { transform: rotate(0deg); }
      100% { transform: rotate(360deg); }
    }
    
    #servicio-pedidos h2 {
      color: white;
      font-size: 42px;
      margin-bottom: 20px;
      position: relative;
      z-index: 2;
    }
    
    #servicio-pedidos h2::after {
      background: linear-gradient(90deg, white, rgba(255,255,255,0.5));
    }
    
    #servicio-pedidos p {
      font-size: 20px;
      margin-bottom: 30px;
      position: relative;
      z-index: 2;
      opacity: 0.95;
    }
    
    #servicio-pedidos .button {
      background: white;
      color: #D5786C;
      font-size: 18px;
      padding: 18px 35px;
      position: relative;
      z-index: 2;
      border: 2px solid transparent;
    }
    
    #servicio-pedidos .button:hover {
      background: #f8f9fa;
      transform: translateY(-3px) scale(1.05);
      border-color: rgba(255,255,255,0.3);
    }
    
    #contacto {
      background: linear-gradient(135deg, #FBF4E8 0%, #f8f5f0 100%);
      border-radius: 20px;
      padding: 50px;
      box-shadow: 0 10px 30px rgba(0,0,0,0.08);
      text-align: center;
      margin: 40px auto;
      max-width: 1000px;
      border: 1px solid rgba(213, 120, 108, 0.1);
      width: calc(100% - 40px);
      box-sizing: border-box;
    }
    
    #contacto h2 {
      margin-bottom: 30px;
      color: #D5786C;
    }
    
    #contacto p {
      font-size: 18px;
      margin-bottom: 15px;
      display: flex;
      align-items: center;
      justify-content: center;
      gap: 10px;
      color: #555;
    }
    
    #contacto a {
      color: #D5786C;
      text-decoration: none;
      font-weight: 600;
      transition: all 0.3s ease;
      padding: 2px 6px;
      border-radius: 6px;
    }
    
    #contacto a:hover {
      color: #c16b5f;
      background: rgba(213, 120, 108, 0.1);
      transform: scale(1.05);
    }
    
    .newsletter { 
      background: linear-gradient(135deg, #253732 0%, #3a4f48 100%);
      color: white;
      padding: 60px 40px; 
      text-align: center; 
      margin: 80px auto;
      max-width: 1000px;
      border-radius: 20px;
      box-shadow: 0 15px 35px rgba(37, 55, 50, 0.3);
      position: relative;
      overflow: hidden;
      width: calc(100% - 40px);
      box-sizing: border-box;
    }
    
    .newsletter::before {
      content: '';
      position: absolute;
      top: -50%;
      left: -50%;
      width: 200%;
      height: 200%;
      background: radial-gradient(circle, rgba(255,255,255,0.05) 0%, transparent 50%);
      animation: rotate 25s linear infinite reverse;
    }
    
    .newsletter h2 {
      color: white;
      margin-bottom: 15px;
      font-size: 32px;
      position: relative;
      z-index: 2;
    }
    
    .newsletter h2::after {
      background: linear-gradient(90deg, white, rgba(255,255,255,0.3));
    }
    
    .newsletter p {
      font-size: 18px;
      margin-bottom: 30px;
      opacity: 0.9;
      position: relative;
      z-index: 2;
    }
    
    .newsletter-form {
      display: flex;
      justify-content: center;
      gap: 15px;
      flex-wrap: wrap;
      max-width: 500px;
      margin: 0 auto;
      position: relative;
      z-index: 2;
    }
    
    .newsletter input[type=email] { 
      padding: 15px 20px; 
      flex: 1;
      min-width: 250px;
      border: none; 
      border-radius: 12px; 
      font-family: 'Open Sans', sans-serif;
      font-size: 16px;
      box-shadow: 0 4px 15px rgba(0,0,0,0.1);
      outline: none;
      transition: all 0.3s ease;
      -webkit-appearance: none;
      -webkit-border-radius: 12px;
    }
    
    .newsletter input[type=email]:focus {
      box-shadow: 0 6px 20px rgba(213, 120, 108, 0.2);
      transform: translateY(-2px);
    }
    
    /* Prevenir zoom en iOS */
    @supports (-webkit-touch-callout: none) {
      .newsletter input[type=email] {
        font-size: 16px !important;
        transform: scale(1);
      }
    }
    
    .newsletter button { 
      padding: 18px 35px; 
      background: linear-gradient(135deg, #D5786C 0%, #e0958a 50%, #f4a99c 100%);
      color: #fff; 
      border: none; 
      border-radius: 25px; 
      cursor: pointer; 
      font-weight: 700;
      font-size: 16px;
      transition: all 0.4s cubic-bezier(0.4, 0, 0.2, 1);
      box-shadow: 0 8px 25px rgba(213, 120, 108, 0.3);
      position: relative;
      overflow: hidden;
      text-transform: uppercase;
      letter-spacing: 1px;
      backdrop-filter: blur(10px);
    }
    
    .newsletter button::before {
      content: '';
      position: absolute;
      top: 0;
      left: -100%;
      width: 100%;
      height: 100%;
      background: linear-gradient(135deg, #c16b5f 0%, #d07066 50%, #e08074 100%);
      transition: left 0.5s ease;
      z-index: 0;
    }
    
    .newsletter button::after {
      content: 'üìß';
      position: absolute;
      top: 50%;
      right: 25px;
      transform: translateY(-50%);
      opacity: 0;
      transition: all 0.4s ease;
      z-index: 2;
      font-size: 18px;
    }
    
    .newsletter button span {
      position: relative;
      z-index: 2;
    }
    
    .newsletter button:hover {
      transform: translateY(-4px) scale(1.05);
      box-shadow: 0 12px 35px rgba(213, 120, 108, 0.4);
    }
    
    .newsletter button:hover::before {
      left: 0;
    }
    
    .newsletter button:hover::after {
      opacity: 1;
      right: 20px;
      animation: emailFloat 0.6s ease infinite;
    }
    
    @keyframes emailFloat {
      0%, 100% { transform: translateY(-50%) translateX(0); }
      50% { transform: translateY(-50%) translateX(-3px); }
    }
    
    footer { 
      text-align: center; 
      background: linear-gradient(135deg, #1a1a1a 0%, #2d2d2d 100%);
      color: #fff; 
      padding: 50px 20px; 
      font-size: 16px;
      position: relative;
      overflow: hidden;
      width: 100%;
      max-width: 100vw;
      margin: 0 auto;
      box-sizing: border-box;
    }
    
    footer::before {
      content: '';
      position: absolute;
      top: 0;
      left: 50%;
      transform: translateX(-50%);
      width: 100px;
      height: 1px;
      background: linear-gradient(90deg, transparent, rgba(213, 120, 108, 0.3), transparent);
    }
    
    footer p {
      opacity: 0.8;
      line-height: 1.5;
      position: relative;
      z-index: 2;
    }

    /* EFECTOS ADICIONALES PARA BOTONES */
    
    /* Efecto de resplandor para botones principales */
    .button:hover,
    .login-btn-submit:hover,
    .register-btn:hover,
    .popup-cta:hover {
      box-shadow: 
        0 15px 40px rgba(213, 120, 108, 0.4),
        0 0 0 1px rgba(255, 255, 255, 0.1),
        inset 0 1px 0 rgba(255, 255, 255, 0.2);
    }
    
    /* Efecto de presi√≥n para todos los botones */
    .button:active,
    .quick-order-btn:active,
    .login-btn-submit:active,
    .register-btn:active,
    .offer-cta:active,
    .loyalty-btn:active,
    .newsletter button:active,
    .popup-cta:active,
    nav a:active {
      transform: translateY(0) scale(0.98);
      transition: all 0.1s ease;
    }
    
    /* Animaci√≥n de ondas para botones especiales */
    @keyframes ripple {
      0% {
        transform: scale(0);
        opacity: 1;
      }
      100% {
        transform: scale(4);
        opacity: 0;
      }
    }
    
    .button-large::before,
    .popup-cta::before {
      animation: ripple 0.6s ease-out;
    }
    
    /* Mejoras de accesibilidad */
    .button:focus,
    .quick-order-btn:focus,
    .login-btn-submit:focus,
    .register-btn:focus,
    .offer-cta:focus,
    .loyalty-btn:focus,
    .newsletter button:focus,
    .popup-cta:focus,
    nav a:focus {
      outline: 3px solid rgba(213, 120, 108, 0.3);
      outline-offset: 2px;
    }
    
    /* Estados de carga para botones */
    .button.loading,
    .login-btn-submit.loading,
    .register-btn.loading {
      pointer-events: none;
      opacity: 0.7;
    }
    
    .button.loading::after,
    .login-btn-submit.loading::after,
    .register-btn.loading::after {
      content: '';
      width: 20px;
      height: 20px;
      border: 2px solid transparent;
      border-top: 2px solid currentColor;
      border-radius: 50%;
      animation: spin 1s linear infinite;
    }
    
    @keyframes spin {
      0% { transform: translateY(-50%) rotate(0deg); }
      100% { transform: translateY(-50%) rotate(360deg); }
    }
    
    /* Efecto de brillo para botones dorados */
    .loyalty-btn {
      background: linear-gradient(135deg, #FFD700 0%, #FFA500 50%, #FF8C00 100%);
      position: relative;
    }
    
    .loyalty-btn::before {
      background: linear-gradient(135deg, #e6c200 0%, #e69500 50%, #e67e00 100%);
    }
    
    /* Efecto adicional de brillo dorado */
    .loyalty-btn:hover {
      box-shadow: 
        0 15px 40px rgba(255, 215, 0, 0.5),
        0 0 20px rgba(255, 215, 0, 0.3),
        inset 0 1px 0 rgba(255, 255, 255, 0.3);
    }
    
    /* Responsive Design Principal */
    @media (max-width: 768px) {
      body {
        padding-top: 40px;
      }
      
      .notification-container {
        top: 80px;
        right: 15px;
        left: 15px;
        max-width: none;
      }

      .notification {
        min-width: auto;
        width: 100%;
        padding: 16px 20px;
      }

      .notification-header {
        margin-bottom: 10px;
      }

      .notification-title {
        font-size: 15px;
      }

      .notification-message {
        font-size: 13px;
      }

      .notification-actions {
        margin-top: 12px;
      }

      .notification-btn {
        padding: 6px 12px;
        font-size: 11px;
      }
      
      .urgent-offer-banner {
        padding: 8px 15px;
        font-size: 12px;
      }
      
      .offer-content {
        flex-direction: column;
        gap: 8px;
        text-align: center;
      }
      
      .offer-cta {
        margin-top: 8px;
      }
      
      .close-banner {
        position: relative;
        right: auto;
        margin-top: 10px;
      }
      
      header {
        padding: 20px 15px;
      }
      
      header h1 {
        font-size: 28px;
      }
      
      nav {
        gap: 15px;
      }
      
      nav a {
        padding: 6px 8px;
        font-size: 13px;
        min-height: auto;
        min-width: auto;
      }
      
      .user-menu .register-btn,
      .user-menu .login-btn {
        padding: 6px 12px;
        font-size: 12px;
        border-radius: 18px;
        min-height: 32px;
      }
      
      .user-menu .register-btn::after,
      .user-menu .login-btn::after {
        font-size: 10px;
        right: 10px;
      }
      
      .button {
        padding: 14px 25px;
        font-size: 14px;
        border-radius: 35px;
      }
      
      .button::after {
        font-size: 16px;
        right: 15px;
      }
      
      .button-large {
        padding: 18px 30px;
        font-size: 16px;
      }
      
      .quick-order-btn {
        padding: 12px 18px;
        font-size: 12px;
        border-radius: 20px;
      }
      
      .quick-order-btn::after {
        font-size: 14px;
        right: 6px;
      }
      
      .login-btn-submit, .register-btn {
        padding: 16px 20px;
        font-size: 14px;
        border-radius: 20px;
      }
      
      .login-btn-submit::after, .register-btn::after {
        font-size: 16px;
        right: 18px;
      }
      
      .offer-cta {
        padding: 8px 15px;
        font-size: 11px;
        border-radius: 20px;
      }
      
      .offer-cta::after {
        font-size: 12px;
        right: 6px;
      }
      
      .loyalty-btn {
        padding: 16px 30px;
        font-size: 14px;
        border-radius: 35px;
      }
      
      .loyalty-btn::after {
        font-size: 18px;
        right: 20px;
      }
      
      .newsletter button {
        padding: 16px 25px;
        font-size: 14px;
        border-radius: 20px;
      }
      
      .newsletter button::after {
        font-size: 16px;
        right: 15px;
      }
      
      .popup-cta {
        padding: 16px 25px;
        font-size: 14px;
        border-radius: 35px;
      }
      
      .popup-cta::after {
        font-size: 18px;
        right: 15px;
      }
      
      /* Optimizaciones de rendimiento para botones en m√≥vil */
      .button::before,
      .quick-order-btn::before,
      .login-btn-submit::before,
      .register-btn::before,
      .offer-cta::before,
      .loyalty-btn::before,
      .newsletter button::before,
      .popup-cta::before,
      nav a::before {
        transition: left 0.3s ease;
      }
      
      .button::after,
      .quick-order-btn::after,
      .login-btn-submit::after,
      .register-btn::after,
      .offer-cta::after,
      .loyalty-btn::after,
      .newsletter button::after,
      .popup-cta::after,
      nav a::after {
        transition: all 0.2s ease;
      }
      
      .fullwidth-slider {
        height: calc(100vw * 325 / 1920);
        min-height: 180px;
      }
      
      .fullwidth-slider img {
        height: calc(100vw * 325 / 1920);
        min-height: 180px;
      }
      
      section {
        padding: 50px 15px;
      }
      
      h2 {
        font-size: 24px;
      }
      
      .galeria {
        grid-template-columns: 1fr;
        gap: 20px;
      }
      
      .pizza-card img {
        height: 160px;
      }
      
      .benefits-grid {
        grid-template-columns: 1fr;
        gap: 20px;
      }
      
      .featured-pizzas {
        grid-template-columns: 1fr;
        gap: 25px;
      }
      
      .reviews-container {
        grid-template-columns: 1fr;
        gap: 20px;
      }
      
      .timeline-container {
        flex-direction: column;
        gap: 15px;
      }
      
      .timeline-arrow {
        transform: rotate(90deg);
      }
      
      .loyalty-container {
        grid-template-columns: 1fr;
        gap: 20px;
      }
      
      .delivery-info-grid {
        grid-template-columns: 1fr;
        gap: 30px;
      }
      
      .newsletter-form {
        flex-direction: column;
        gap: 12px;
      }
      
      .newsletter input[type=email] {
        min-width: 100%;
      }
      
      .user-action-panel {
        padding: 30px 15px;
      }
      
      .welcome-message h2 {
        font-size: 28px;
      }
      
      .welcome-message p {
        font-size: 16px;
        margin-bottom: 30px;
      }
      
      .action-buttons {
        flex-direction: column;
        align-items: center;
        gap: 15px;
        margin-bottom: 30px;
      }
      
      .action-btn {
        min-width: 250px;
        padding: 16px 30px;
        font-size: 14px;
      }
      
      .whatsapp-float {
        bottom: 20px;
        left: 20px;
        min-width: 160px;
        padding: 12px 16px;
      }
      
      .user-action-panel {
        padding: 30px 15px;
      }
      
      .welcome-message h2 {
        font-size: 28px;
      }
      
      .welcome-message p {
        font-size: 16px;
        margin-bottom: 30px;
      }
      
      .action-buttons {
        flex-direction: column;
        align-items: center;
        gap: 15px;
        margin-bottom: 30px;
      }
      
      .action-btn {
        min-width: 250px;
        padding: 16px 30px;
        font-size: 14px;
      }
      
      .benefits-preview {
        gap: 25px;
      }
    }

    /* Small mobile - Action Panel responsive */
    @media (max-width: 480px) {
      header h1 {
        font-size: 24px;
      }
      
      nav {
        gap: 10px;
      }
      
      nav a {
        padding: 6px 8px;
        font-size: 12px;
        min-width: auto;
        min-height: auto;
      }
      
      .user-menu {
        gap: 12px;
      }
      
      .user-menu .register-btn,
      .user-menu .login-btn {
        padding: 6px 10px;
        font-size: 11px;
        min-height: 30px;
      }
      
      .user-welcome {
        flex-direction: column;
        gap: 5px;
        align-items: flex-end;
      }
      
      .user-welcome span:not(:first-child) {
        font-size: 10px;
      }
      
      .dropdown-content {
        min-width: 150px;
        right: -10px;
      }
      
      section {
        padding: 40px 12px;
      }
      
      h2 {
        font-size: 20px;
      }
      
      .pizza-card img {
        height: 140px;
      }
      
      .auth-section {
        padding: 30px 12px;
      }
      
      .auth-icon {
        font-size: 40px;
      }
      
      .auth-welcome h2 {
        font-size: 22px;
      }
      
      .auth-welcome p {
        font-size: 14px;
      }
      
      .auth-btn {
        min-width: 100%;
        padding: 18px 20px;
      }
      
      .btn-icon {
        width: 45px;
        height: 45px;
        font-size: 20px;
      }
      
      .btn-title {
        font-size: 14px;
      }
      
      .btn-subtitle {
        font-size: 12px;
      }
      
      .benefit-item {
        font-size: 12px;
      }
      
      .benefit-icon {
        width: 30px;
        height: 30px;
        font-size: 16px;
      }
    }
  </style>
</head>
<body>
  <!-- CONTENEDOR DE NOTIFICACIONES -->
  <div class="notification-container" id="notificationContainer"></div>

  <!-- MODAL DE CONFIRMACI√ìN -->
  <div class="confirmation-modal" id="confirmationModal">
    <div class="confirmation-content">
      <div class="confirmation-icon" id="confirmationIcon">üçï</div>
      <h3 class="confirmation-title" id="confirmationTitle">¬øEst√°s seguro?</h3>
      <p class="confirmation-message" id="confirmationMessage">Esta acci√≥n no se puede deshacer.</p>
      <div class="confirmation-actions">
        <button class="confirmation-btn cancel" id="confirmationCancel">Cancelar</button>
        <button class="confirmation-btn confirm" id="confirmationConfirm">Confirmar</button>
      </div>
    </div>
  </div>

  <!-- FULLSCREEN LOADER -->
  <div class="fullscreen-loader" id="pageLoader">
    <div class="logo-loader">
      <div class="logo-text">Fratelli Pazzi</div>
      <div class="logo-underline"></div>
    </div>
    <div class="loading-text">Preparando tu experiencia italiana...</div>
    <div class="pizza-spinner">
      <div class="pizza-base">
        <div class="pizza-sauce">
          <div class="pizza-cheese"></div>
          <div class="pizza-cheese"></div>
          <div class="pizza-cheese"></div>
        </div>
      </div>
    </div>
  </div>

  <!-- BANNER DE OFERTA URGENTE -->
  <div class="urgent-offer-banner" id="urgentBanner">
    <div class="offer-content">
      <span class="offer-icon">üî•</span>
      <span class="offer-text">OFERTA ESPECIAL: <strong>20% OFF</strong> en pedidos +15‚Ç¨</span>
      <span class="offer-code">C√≥digo: <strong>FRATELLI20</strong></span>
      <span class="offer-timer">‚è∞ Termina en <span id="countdown">2:30:00</span></span>
      <button class="offer-cta" onclick="window.location.href='pedido.html'"><span>¬°PEDIR AHORA!</span></button>
    </div>
    <button class="close-banner" onclick="FratelliPazzi.closeBanner()">√ó</button>
  </div>

  <!-- OVERLAY DE TRANSICI√ìN -->
  <div class="page-transition-overlay" id="pageTransitionOverlay"></div>
  
  <header id="header">
    <h1>Fratelli Pazzi</h1>
    <nav>
      <a href="#ofertas">Ofertas</a>
      <a href="#nuestras-pizzas">Pizzas</a>
      <a href="#calzones">Calzones</a>
      <a href="pedido.html">Pedido</a>
      <a href="#contacto">Contacto</a>
    </nav>
    <!-- Solo dropdown para usuarios logueados -->
    <div class="user-menu" id="userMenu"></div>
  </header>

  <!-- USER AUTHENTICATION SECTION - Secci√≥n completamente separada -->
  <section class="auth-section" id="authSection" style="display: none;">
    <div class="auth-container">
      <div class="auth-welcome">
        <div class="auth-icon">üçï</div>
        <h2>¬°√önete a la Famiglia Fratelli!</h2>
        <p>Crea tu cuenta para acumular puntos, conseguir pizzas gratis y disfrutar de ofertas exclusivas</p>
      </div>
      
      <div class="auth-buttons">
        <button class="auth-btn register-primary" onclick="FratelliPazzi.showRegisterForm()">
          <div class="btn-content">
            <span class="btn-icon">‚ú®</span>
            <div class="btn-text">
              <span class="btn-title">Crear Cuenta Gratis</span>
              <span class="btn-subtitle">¬°Empieza a acumular puntos!</span>
            </div>
          </div>
        </button>
        
        <button class="auth-btn login-secondary" onclick="FratelliPazzi.showLoginForm()">
          <div class="btn-content">
            <span class="btn-icon">üîê</span>
            <div class="btn-text">
              <span class="btn-title">Ya tengo cuenta</span>
              <span class="btn-subtitle">Iniciar sesi√≥n</span>
            </div>
          </div>
        </button>
      </div>
      
      <div class="auth-benefits">
        <div class="benefit-item">
          <span class="benefit-icon">üéÅ</span>
          <span class="benefit-text">Pizza gratis cada 100 puntos</span>
        </div>
        <div class="benefit-item">
          <span class="benefit-icon">‚ö°</span>
          <span class="benefit-text">Checkout r√°pido</span>
        </div>
        <div class="benefit-item">
          <span class="benefit-icon">üîî</span>
          <span class="benefit-text">Ofertas exclusivas por email</span>
        </div>
      </div>
      
      <div class="auth-stats">
        <span>+300 clientes ya disfrutan de nuestros beneficios</span>
      </div>
    </div>
  </section>

  <!-- USER PROFILE SECTION - Solo visible para usuarios logueados -->
  <section class="profile-section" id="profileSection" style="display: none;">
    <div class="profile-container">
      <div class="profile-welcome">
        <div class="profile-avatar" id="profileAvatar">
          <!-- Se llenar√° din√°micamente -->
        </div>
        <div class="profile-info">
          <h2 id="profileGreeting">¬°Hola Usuario!</h2>
          <p id="profileStatus">Miembro de la Famiglia Fratelli</p>
        </div>
        <div class="profile-actions">
          <button class="profile-btn logout-btn" onclick="FratelliPazzi.logout()">
            <span class="btn-icon">üëã</span>
            <span class="btn-text">Cerrar Sesi√≥n</span>
          </button>
        </div>
      </div>
      
      <div class="profile-stats">
        <div class="stat-card">
          <div class="stat-icon">‚≠ê</div>
          <div class="stat-content">
            <span class="stat-number" id="userPoints">0</span>
            <span class="stat-label">Puntos</span>
          </div>
        </div>
        
        <div class="stat-card">
          <div class="stat-icon">üçï</div>
          <div class="stat-content">
            <span class="stat-number" id="userOrders">0</span>
            <span class="stat-label">Pedidos</span>
          </div>
        </div>
        
        <div class="stat-card">
          <div class="stat-icon">üéÅ</div>
          <div class="stat-content">
            <span class="stat-number" id="freeRewards">0</span>
            <span class="stat-label">Pizzas Gratis</span>
          </div>
        </div>
        
        <div class="stat-card verification-card" id="verificationCard" style="display: none;">
          <div class="stat-icon">üìß</div>
          <div class="stat-content">
            <span class="stat-label">Email NO verificado</span>
            <button class="verify-btn" onclick="FratelliPazzi.resendVerificationEmail()">
              Verificar ahora
            </button>
          </div>
        </div>
      </div>
      
      <div class="profile-quick-actions">
        <button class="quick-action-btn" onclick="FratelliPazzi.showProfile()">
          <span class="action-icon">üë§</span>
          <span class="action-text">Mi Perfil</span>
        </button>
        
        <button class="quick-action-btn" onclick="FratelliPazzi.showOrderHistory()">
          <span class="action-icon">üìã</span>
          <span class="action-text">Mis Pedidos</span>
        </button>
        
        <button class="quick-action-btn" onclick="window.location.href='pedido.html'">
          <span class="action-icon">üõí</span>
          <span class="action-text">Hacer Pedido</span>
        </button>
        
        <button class="quick-action-btn" onclick="FratelliPazzi.showUserPoints()">
          <span class="action-icon">üèÜ</span>
          <span class="action-text">Mis Recompensas</span>
        </button>
      </div>
      
      <div class="profile-progress" id="profileProgress">
        <div class="progress-info">
          <span class="progress-text">Progreso hacia pizza gratis:</span>
          <span class="progress-points" id="progressPoints">0 / 100 puntos</span>
        </div>
        <div class="progress-bar">
          <div class="progress-fill" id="progressFill" style="width: 0%"></div>
        </div>
      </div>
    </div>
  </section>

  <!-- Contenedor principal para centrar todo el contenido -->
  <main style="width: 100%; max-width: 100vw; margin: 0 auto; display: flex; flex-direction: column; align-items: center;">

    <div class="fullwidth-slider" id="ofertas">
      <div class="slider-wrapper">
        <img src="images/oferta1.png" alt="Oferta especial 1 - Fratelli Pazzi" loading="lazy">
        <img src="images/oferta2.png" alt="Oferta especial 2 - Fratelli Pazzi" loading="lazy">
        <img src="images/oferta3.png" alt="Oferta especial 3 - Fratelli Pazzi" loading="lazy">
        <img src="images/oferta4.png" alt="Oferta especial 4 - Fratelli Pazzi" loading="lazy">
      </div>
      <div class="slider-controls">
        <button onclick="FratelliPazzi.moveSlider(-1)" aria-label="Oferta anterior">&#10094;</button>
        <button onclick="FratelliPazzi.moveSlider(1)" aria-label="Siguiente oferta">&#10095;</button>
      </div>
      <div class="slider-dots">
        <span onclick="FratelliPazzi.moveSliderTo(0)" class="active" aria-label="Ir a oferta 1"></span>
        <span onclick="FratelliPazzi.moveSliderTo(1)" aria-label="Ir a oferta 2"></span>
        <span onclick="FratelliPazzi.moveSliderTo(2)" aria-label="Ir a oferta 3"></span>
        <span onclick="FratelliPazzi.moveSliderTo(3)" aria-label="Ir a oferta 4"></span>
      </div>
    </div>

    <!-- CONTADOR DE ACTIVIDAD EN TIEMPO REAL -->
    <section class="live-activity section-transition">
      <div class="activity-content">
        <div class="activity-item">
          <span class="live-indicator">üî¥</span>
          <span id="viewersCount">3</span> personas viendo el men√∫ ahora
        </div>
      </div>
    </section>

    <!-- ¬øPOR QU√â FRATELLI PAZZI? -->
    <section class="why-us section-transition">
      <h2>¬øPor qu√© elegir Fratelli Pazzi?</h2>
      <div class="benefits-grid">
        <div class="benefit-card">
          <div class="benefit-icon">üë®‚Äçüç≥</div>
          <h3>Maestros Pizzaiolos</h3>
          <p>Chefs entrenados en N√°poles<br><span class="highlight">T√©cnica tradicional</span></p>
        </div>
        <div class="benefit-card">
          <div class="benefit-icon">‚≠ê</div>
          <h3>+300 Clientes</h3>
          <p>Satisfechos en Las Rozas<br><span class="highlight">4.8/5 estrellas en Google</span></p>
        </div>
        <div class="benefit-card">
          <div class="benefit-icon">üõ°Ô∏è</div>
          <h3>Garant√≠a Total</h3>
          <p>Frescura y calidad garantizada<br><span class="highlight">100% satisfacci√≥n</span></p>
        </div>
        <div class="benefit-card">
          <div class="benefit-icon">üî•</div>
          <h3>Horno de Le√±a</h3>
          <p>Cocci√≥n a 450¬∞C tradicional<br><span class="highlight">Sabor aut√©ntico napolitano</span></p>
        </div>
      </div>
    </section>

    <!-- PIZZAS M√ÅS PEDIDAS -->
    <section class="most-ordered section-transition">
      <h2>Las Favoritas de Nuestros Clientes</h2>
      <p class="section-intro">Las pizzas m√°s pedidas en Las Rozas. ¬°Descubre por qu√© son las preferidas!</p>
      <div class="featured-pizzas">
        <div class="featured-pizza-card bestseller">
          <div class="bestseller-badge">üî• M√ÅS VENDIDA</div>
          <img src="images/Margarita.png" alt="Pizza Margarita" loading="lazy">
          <div class="featured-info">
            <h3>Margarita Cl√°sica</h3>
            <p class="customer-quote">"¬°La mejor Margarita de Madrid!"</p>
            <div class="price-action">
              <span class="featured-price">10‚Ç¨</span>
              <button class="quick-order-btn" onclick="window.location.href='pedido.html'"><span>PEDIR AHORA</span></button>
            </div>
          </div>
        </div>
        <div class="featured-pizza-card">
          <div class="popular-badge">‚≠ê TOP 3</div>
          <img src="images/LeonardoDaVinci.png" alt="Pizza Leonardo Da Vinci" loading="lazy">
          <div class="featured-info">
            <h3>Leonardo Da Vinci</h3>
            <p class="customer-quote">"Salm√≥n ahumado espectacular"</p>
            <div class="price-action">
              <span class="featured-price">14‚Ç¨</span>
              <button class="quick-order-btn" onclick="window.location.href='pedido.html'">PEDIR AHORA</button>
            </div>
          </div>
        </div>
        <div class="featured-pizza-card">
          <div class="popular-badge">üëë PREMIUM</div>
          <img src="images/Quatro formaggi.png" alt="Pizza Cuatro Formaggi" loading="lazy">
          <div class="featured-info">
            <h3>Cuatro Formaggi</h3>
            <p class="customer-quote">"Incre√≠ble mezcla de quesos"</p>
            <div class="price-action">
              <span class="featured-price">12‚Ç¨</span>
              <button class="quick-order-btn" onclick="window.location.href='pedido.html'">PEDIR AHORA</button>
            </div>
          </div>
        </div>
      </div>
    </section>

    <!-- TESTIMONIOS Y RESE√ëAS DE GOOGLE -->
    <section class="testimonials section-transition">
      <h2>Lo que dicen nuestros clientes</h2>
      <p class="section-intro">Rese√±as reales de Google My Business</p>
      <div class="reviews-container">
        <div class="review-card">
          <div class="review-header">
            <div class="reviewer-info">
              <div class="reviewer-avatar">M</div>
              <div class="reviewer-details">
                <h4>Miguel Rafael</h4>
                <span class="review-date">Hace 2 meses</span>
              </div>
            </div>
            <div class="stars">‚≠ê‚≠ê‚≠ê‚≠ê‚≠ê</div>
          </div>
          <p class="review-text">
            Fui con unos amigos para probar y nos encant√≥ las 6 pizzas distintas que pedimos. Riqu√≠simas y la atenci√≥n un lujo. Repetiremos ‚ù§Ô∏è
          </p>
        </div>

        <div class="review-card">
          <div class="review-header">
            <div class="reviewer-info">
              <div class="reviewer-avatar">E</div>
              <div class="reviewer-details">
                <h4>Elena Salgueiro</h4>
                <span class="review-date">Hace 3 meses</span>
              </div>
            </div>
            <div class="stars">‚≠ê‚≠ê‚≠ê‚≠ê‚≠ê</div>
          </div>
          <p class="review-text">
            No somos sus colegas (como pone la rese√±a anterior), somos vecinos de la zona. Es la segunda vez que pedimos y no ser√° la √∫ltima. RIQU√çSIMA. Todo lo que uno espera de una pizza. Nada m√°s que a√±adir üòãüòãüòã
          </p>
        </div>

        <div class="review-card">
          <div class="review-header">
            <div class="reviewer-info">
              <div class="reviewer-avatar">J</div>
              <div class="reviewer-details">
                <h4>JOSE RAMON Diez</h4>
                <span class="review-date">Hace 3 meses</span>
              </div>
            </div>
            <div class="stars">‚≠ê‚≠ê‚≠ê‚≠ê‚≠ê</div>
          </div>
          <p class="review-text">
            Aut√©ntica y muy rica pizza napolitana, tienen un horno espectacular‚Ä¶
          </p>
        </div>

        <div class="review-card">
          <div class="review-header">
            <div class="reviewer-info">
              <div class="reviewer-avatar">B</div>
              <div class="reviewer-details">
                <h4>Bel√©n Snchz</h4>
                <span class="review-date">Hace 3 meses</span>
              </div>
            </div>
            <div class="stars">‚≠ê‚≠ê‚≠ê‚≠ê‚≠ê</div>
          </div>
          <p class="review-text">
            Pizzas buen√≠simas, la masa nos ha encantado. El repartidor muy amable. Ya tenemos nuevo sitio favorito para pedir pizzas aut√©nticas!
          </p>
        </div>

        <div class="review-card">
          <div class="review-header">
            <div class="reviewer-info">
              <div class="reviewer-avatar">A</div>
              <div class="reviewer-details">
                <h4>Antonio S√°nchez</h4>
                <span class="review-date">Hace 3 meses</span>
              </div>
            </div>
            <div class="stars">‚≠ê‚≠ê‚≠ê‚≠ê‚≠ê</div>
          </div>
          <p class="review-text">
            Pizzas super buenas y muy buen precio, encima los chicos que la llevan son muy majos y r√°pidos. Volver√©, incre√≠ble experiencia‚Ä¶
          </p>
        </div>
      </div>

      <div class="google-rating-summary">
        <div class="rating-big">4.7 ‚≠ê</div>
        <div class="rating-details">
          <p>Basado en <strong>43 rese√±as</strong> de Google</p>
          <a href="https://g.co/kgs/DzYRGju" target="_blank" class="view-all-reviews">Ver todas las rese√±as en Google</a>
        </div>
      </div>
    </section>

    <!-- TIMELINE DE FRESCURA -->
    <section class="freshness-timeline section-transition">
      <h2>De Nuestro Horno a Tu Casa</h2>
      <p class="section-intro">Proceso garantizado de frescura m√°xima</p>
      <div class="timeline-container">
        <div class="timeline-step">
          <div class="step-icon">üïê</div>
          <div class="step-content">
            <h3>Tu Pedido</h3>
            <p>Confirmas tu pedido online</p>
            <span class="step-time">2 min</span>
          </div>
        </div>
        
        <div class="timeline-arrow">‚Üí</div>
        
        <div class="timeline-step">
          <div class="step-icon">üçï</div>
          <div class="step-content">
            <h3>Horno de Le√±a</h3>
            <p>Cocci√≥n a 450¬∞C tradicional</p>
            <span class="step-time">12-15 min</span>
          </div>
        </div>
        
        <div class="timeline-arrow">‚Üí</div>
        
        <div class="timeline-step">
          <div class="step-icon">üè†</div>
          <div class="step-content">
            <h3>Tu Casa</h3>
            <p>Entrega caliente garantizada</p>
            <span class="step-time">25-30 min</span>
          </div>
        </div>
      </div>
      <div class="freshness-guarantee">
        <span class="guarantee-icon">üõ°Ô∏è</span>
        <strong>Garant√≠a de Frescura:</strong> Pizzas siempre calientes y reci√©n hechas
      </div>
    </section>

    <!-- PROGRAMA DE FIDELIDAD -->
    <section class="loyalty-program section-transition">
      <h2>Programa Fratelli VIP</h2>
      <p class="section-intro">Cada pedido te acerca m√°s a pizzas gratis y beneficios exclusivos</p>
      <div class="loyalty-container">
        <div class="loyalty-card">
          <div class="loyalty-icon">üí∞</div>
          <h3>Acumula Puntos</h3>
          <p>1‚Ç¨ gastado = 1 punto<br><span class="highlight">Cada pedido suma</span></p>
          <div class="points-example">Pedido 15‚Ç¨ = 15 puntos</div>
        </div>
        
        <div class="loyalty-card featured">
          <div class="loyalty-icon">üéÅ</div>
          <h3>Pizza Gratis</h3>
          <p>Acumula 100 puntos<br><span class="highlight">Pizza Margarita gratis</span></p>
          <div class="points-example">‚âà 7 pedidos promedio</div>
        </div>
        
        <div class="loyalty-card">
          <div class="loyalty-icon">üëë</div>
          <h3>Cliente VIP</h3>
          <p>Desde 200 puntos<br><span class="highlight">Descuentos exclusivos</span></p>
          <div class="points-example">Ofertas especiales</div>
        </div>
      </div>
      <div class="loyalty-cta">
        <p><strong>¬°Empieza a acumular puntos hoy!</strong> Autom√°tico en todos los pedidos</p>
        <button class="loyalty-btn" onclick="window.location.href='pedido.html'"><span>EMPEZAR A ACUMULAR</span></button>
      </div>
    </section>

    <!-- ZONA DE ENTREGA CON MAPA -->
    <section class="delivery-zone section-transition">
      <h2>Zona de Entrega</h2>
      <p class="section-intro">Entregamos en Las Rozas y Torrelodones con tiempos garantizados</p>
      <div class="delivery-info-grid">
        <div class="delivery-map">
          <div class="map-placeholder">
            <div class="map-icon">üìç</div>
            <h3>Las Rozas y Torrelodones</h3>
            <p>Cobertura completa</p>
            <div class="delivery-zones">
              <div class="zone-item">
                <span class="zone-dot zona-a"></span>
                <span>Centro: 20-25 min</span>
              </div>
              <div class="zone-item">
                <span class="zone-dot zona-b"></span>
                <span>Residencial: 25-30 min</span>
              </div>
              <div class="zone-item">
                <span class="zone-dot zona-c"></span>
                <span>Periferia: 30-35 min</span>
              </div>
            </div>
          </div>
        </div>
        <div class="delivery-details">
          <div class="delivery-feature">
            <div class="feature-icon">üïê</div>
            <div class="feature-content">
              <h4>Horarios de Entrega</h4>
              <p>Lunes a Domingo<br><strong>20:00 - 23:00</strong></p>
            </div>
          </div>
          <div class="delivery-feature">
            <div class="feature-icon">üöó</div>
            <div class="feature-content">
              <h4>Entrega Garantizada</h4>
              <p>Servicio puntual<br><strong>25-30 minutos</strong></p>
            </div>
          </div>
          <div class="delivery-feature">
            <div class="feature-icon">üí≥</div>
            <div class="feature-content">
              <h4>Pedido M√≠nimo</h4>
              <p>Solo <strong>12‚Ç¨</strong><br>Env√≠o incluido en Las Rozas y Torrelodones</p>
            </div>
          </div>
          <div class="delivery-feature">
            <div class="feature-icon">üì±</div>
            <div class="feature-content">
              <h4>Seguimiento</h4>
              <p>Te avisamos por WhatsApp<br><strong>Estado en tiempo real</strong></p>
            </div>
          </div>
        </div>
      </div>
    </section>

    <!-- PIZZAS SECTION -->
    <section id="nuestras-pizzas" class="section-transition">
      <h2>Nuestras Pizzas</h2>
      <p class="section-intro">Elaboradas con ingredientes frescos importados directamente de Italia. Masa fermentada 48 horas y cocidas en horno de le√±a.</p>
      <div class="galeria">
        <div class="pizza-card">
          <img src="images/Margarita.png" alt="Pizza Margarita" loading="lazy">
          <div class="pizza-info">
            <div class="pizza-name">Margarita</div>
            <div class="pizza-price">10‚Ç¨</div>
          </div>
          <div class="pizza-description">Tomate San Marzano, fior di latte y albahaca fresca. La pizza m√°s cl√°sica y aut√©ntica.</div>
        </div>
        
        <div class="pizza-card">
          <img src="images/Prosciutto.png" alt="Pizza Prosciutto" loading="lazy">
          <div class="pizza-info">
            <div class="pizza-name">Prosciutto</div>
            <div class="pizza-price">12‚Ç¨</div>
          </div>
          <div class="pizza-description">Tomate San Marzano, fior di latte y jam√≥n cocido de primera calidad.</div>
        </div>
        
        <div class="pizza-card">
          <img src="images/Quatro formaggi.png" alt="Pizza Cuatro Formaggi" loading="lazy">
          <div class="pizza-info">
            <div class="pizza-name">Cuatro Formaggi</div>
            <div class="pizza-price">12‚Ç¨</div>
          </div>
          <div class="pizza-description">Fior di latte, pecorino romano, gorgonzola DOP y grana padano. Un festival de sabores.</div>
        </div>
        
        <div class="pizza-card">
          <img src="images/Capriciossa.png" alt="Pizza Capricciosa" loading="lazy">
          <div class="pizza-info">
            <div class="pizza-name">Capricciosa</div>
            <div class="pizza-price">12‚Ç¨</div>
          </div>
          <div class="pizza-description">Tomate San Marzano, fior di latte, champi√±ones, jam√≥n cocido, aceitunas y alcachofa.</div>
        </div>
        
        <div class="pizza-card">
          <img src="images/LeonardoDaVinci.png" alt="Pizza Leonardo Da Vinci" loading="lazy">
          <div class="pizza-info">
            <div class="pizza-name">Leonardo Da Vinci</div>
            <div class="pizza-price">14‚Ç¨</div>
          </div>
          <div class="pizza-description">Tomate San Marzano, fior di latte, salm√≥n ahumado, queso philadelphia y r√∫cula fresca.</div>
        </div>
        
        <div class="pizza-card">
          <img src="images/SalchichaFriarielli.png" alt="Pizza Salchicha y Friarielli" loading="lazy">
          <div class="pizza-info">
            <div class="pizza-name">Salchicha y Friarielli</div>
            <div class="pizza-price">12‚Ç¨</div>
          </div>
          <div class="pizza-description">Fior di latte, jam√≥n serrano, salchicha italiana y friarielli napolitanos.</div>
        </div>
        
        <div class="pizza-card">
          <img src="images/Bufala.png" alt="Pizza Bufala" loading="lazy">
          <div class="pizza-info">
            <div class="pizza-name">Bufala</div>
            <div class="pizza-price">14‚Ç¨</div>
          </div>
          <div class="pizza-description">Tomate San Marzano, mozzarella di bufala, tomate cherry, pesto serrano y albahaca fresca.</div>
        </div>
        
        <div class="pizza-card">
          <img src="images/Peperonni.png" alt="Pizza Diavola" loading="lazy">
          <div class="pizza-info">
            <div class="pizza-name">Diavola</div>
            <div class="pizza-price">12‚Ç¨</div>
          </div>
          <div class="pizza-description">Fior di latte, salsa de tomate San Marzano y pepperoni picante. Sabor americano con estilo italiano.</div>
        </div>
        
        <div class="pizza-card">
          <img src="images/Vegetariana.png" alt="Pizza Vegetariana" loading="lazy">
          <div class="pizza-info">
            <div class="pizza-name">Vegetariana</div>
            <div class="pizza-price">12‚Ç¨</div>
          </div>
          <div class="pizza-description">Tomate San Marzano, fior di latte, cebolla, champi√±√≥n, tomate natural y aceitunas negras.</div>
        </div>
        
        <div class="pizza-card">
          <img src="images/Focaccia.png" alt="Focaccia" loading="lazy">
          <div class="pizza-info">
            <div class="pizza-name">Focaccia</div>
            <div class="pizza-price">5‚Ç¨</div>
          </div>
          <div class="pizza-description">Base de pizza crujiente con mantequilla de ajo, romero fresco y sal marina.</div>
        </div>
      </div>
    </section>

    <!-- CALZONES SECTION -->
    <section id="calzones" class="section-transition">
      <h2>Calzones</h2>
      <p class="section-intro">Nuestros calzones est√°n rellenos de los mejores ingredientes y horneados hasta conseguir una textura perfecta.</p>
      <div class="galeria">
        <div class="pizza-card">
          <img src="images/Calzone Traditionale.png" alt="Calzone Tradizionale" loading="lazy">
          <div class="pizza-info">
            <div class="pizza-name">Calzone Tradizionale</div>
            <div class="pizza-price">12‚Ç¨</div>
          </div>
          <div class="pizza-description">San Marzano, fior di latte y jam√≥n cocido. El calzone m√°s tradicional.</div>
        </div>
        
        <div class="pizza-card">
          <img src="images/Calzone Pepperoni.png" alt="Calzone Pepperoni" loading="lazy">
          <div class="pizza-info">
            <div class="pizza-name">Calzone Pepperoni</div>
            <div class="pizza-price">12‚Ç¨</div>
          </div>
          <div class="pizza-description">Tomate San Marzano, fior di latte, prosciutto y peperonni.</div>
        </div>
        
        <div class="pizza-card">
          <img src="images/Calzone Vegetariano.png" alt="Calzone Vegetariano" loading="lazy">
          <div class="pizza-info">
            <div class="pizza-name">Calzone Vegetariano</div>
            <div class="pizza-price">12‚Ç¨</div>
          </div>
          <div class="pizza-description">Tomate San Marzano, fior di latte, champi√±ones, tomate natural y berenjena.</div>
        </div>
      </div>
    </section>

    <!-- CTA SECTION -->
    <section id="servicio-pedidos" class="section-transition">
      <h2>¬øTienes hambre?</h2>
      <p>Haz tu pedido online desde nuestra plataforma segura y rec√≠belo caliente en casa.</p>
      <a class="button button-large" href="pedido.html"><span>Haz tu pedido ahora</span></a>
    </section>

    <!-- CONTACT SECTION -->
    <section id="contacto" class="section-transition">
      <h2>Contacto</h2>
      <p>Avenida de Atenas 3, 28290 Las Rozas (Madrid), Espa√±a</p>
      <p>Tel√©fono: <a href="tel:660668812">660 668 812</a></p>
      <p>Email: <a href="mailto:PIZZASFRATELLIPAZZI@GMAIL.COM">PIZZASFRATELLIPAZZI@GMAIL.COM</a></p>
      <p>Horarios: Lunes a Domingo 20:00 - 23:00</p>
      <p>CIF: B16359283</p>
    </section>

    <!-- NEWSLETTER SECTION -->
    <section class="newsletter section-transition">
      <h2>Suscr√≠bete a nuestro bolet√≠n</h2>
      <p>Recibe nuestras √∫ltimas ofertas y novedades directamente en tu correo.</p>
      <div class="newsletter-form">
        <input type="email" placeholder="Tu email" id="newsletter-email" required>
        <button onclick="FratelliPazzi.suscribirse()"><span>Suscribirse</span></button>
      </div>
    </section>

  </main>

  <!-- WHATSAPP FLOATING BUTTON -->
  <div class="whatsapp-float" onclick="FratelliPazzi.openWhatsApp()">
    <div class="whatsapp-icon">üí¨</div>
    <div class="whatsapp-text">
      <div class="whatsapp-title">¬øDudas?</div>
      <div class="whatsapp-subtitle">Chatea con nosotros</div>
    </div>
    <div class="whatsapp-badge" id="whatsapp-badge">¬°Nuevo!</div>
  </div>

  <!-- POPUPS -->
  
  <!-- LOGIN POPUP -->
  <div class="popup-overlay" id="loginPopup">
    <div class="popup-container">
      <div class="popup-header">
        <h2>Iniciar Sesi√≥n</h2>
        <button class="close-btn" onclick="FratelliPazzi.closeLoginForm()">√ó</button>
      </div>
      <div class="popup-body">
        <form onsubmit="FratelliPazzi.handleLogin(event)">
          <div class="form-group">
            <input type="email" id="login-email" placeholder="Tu email" required>
          </div>
          <div class="form-group">
            <input type="password" id="login-password" placeholder="Tu contrase√±a" required>
          </div>
          <button type="submit" class="login-btn-submit"><span>INICIAR SESI√ìN</span></button>
          <div class="login-error" id="loginError">
            <p>‚ùå Email o contrase√±a incorrectos</p>
          </div>
        </form>
        <div class="login-options">
          <a href="javascript:void(0)" onclick="FratelliPazzi.forgotPassword()">¬øOlvidaste tu contrase√±a?</a>
        </div>
        <p class="register-link">¬øNo tienes cuenta? <a href="javascript:void(0)" onclick="FratelliPazzi.switchToRegister()">Reg√≠strate aqu√≠</a></p>
      </div>
    </div>
  </div>

  <!-- REGISTER POPUP -->
  <div class="popup-overlay" id="registerPopup">
    <div class="popup-container">
      <div class="popup-header">
        <h2>¬°√önete a la Famiglia!</h2>
        <button class="close-btn" onclick="FratelliPazzi.closeRegisterForm()">√ó</button>
      </div>
      <div class="popup-body">
        <form onsubmit="FratelliPazzi.handleRegistration(event)">
          <div class="form-group">
            <input type="text" id="register-name" placeholder="Tu nombre completo" required>
          </div>
          <div class="form-group">
            <input type="email" id="register-email" placeholder="Tu email" required>
          </div>
          <div class="form-group">
            <input type="password" id="register-password" placeholder="Tu contrase√±a (m√≠n. 6 caracteres)" required>
          </div>
          <div class="form-group">
            <input type="password" id="register-confirm-password" placeholder="Confirma tu contrase√±a" required>
          </div>
          <div class="form-group">
            <input type="tel" id="register-phone" placeholder="Tu tel√©fono (opcional)">
          </div>
          <div class="checkbox-group">
            <label class="checkbox-label">
              <input type="checkbox" id="register-offers" checked>
              <span class="checkmark"></span>
              Quiero recibir ofertas especiales por email
            </label>
            <label class="checkbox-label">
              <input type="checkbox" id="register-terms" required>
              <span class="checkmark"></span>
              Acepto los <a href="javascript:void(0)" onclick="FratelliPazzi.showTerms()">t√©rminos y condiciones</a>
            </label>
          </div>
          <button type="submit" class="register-btn"><span>CREAR MI CUENTA</span></button>
          <div class="register-error" id="register-error">
            <p></p>
          </div>
        </form>
        <p class="login-link">¬øYa tienes cuenta? <a href="javascript:void(0)" onclick="FratelliPazzi.showLoginFormFromRegister()">Inicia sesi√≥n</a></p>
      </div>
    </div>
  </div>

  <!-- DISCOUNT POPUP -->
  <div class="discount-popup" id="discountPopup">
    <div class="popup-content">
      <button class="popup-close" onclick="FratelliPazzi.closeDiscountPopup()">√ó</button>
      <div class="popup-header">
        <div class="popup-pizza">üçï</div>
        <h3>¬°Bienvenido a Fratelli Pazzi!</h3>
        <p>Obt√©n <strong>15% de descuento</strong> en tu primera pizza</p>
      </div>
      <div class="popup-body">
        <div class="discount-code">
          <span class="code-label">Tu c√≥digo:</span>
          <span class="code-value">BIENVENIDO15</span>
        </div>
        <div class="popup-benefits">
          <div class="benefit-item">‚úÖ Ingredientes premium de Italia</div>
          <div class="benefit-item">‚úÖ Entrega en 25-30 minutos</div>
          <div class="benefit-item">‚úÖ M√°s de 300 clientes satisfechos</div>
        </div>
        <button class="popup-cta" onclick="FratelliPazzi.useDiscountCode()"><span>USAR MI DESCUENTO</span></button>
        <p class="popup-timer">Oferta v√°lida por <span id="popup-countdown">15:00</span> minutos</p>
      </div>
    </div>
    <div class="popup-overlay" onclick="FratelliPazzi.closeDiscountPopup()"></div>
  </div>

  <footer>
    <p>&copy; 2025 Fratelli Pazzi. Todos los derechos reservados. | Aut√©ntica cocina italiana en Madrid</p>
  </footer>
	
  <!-- MAIN APPLICATION SCRIPT -->
  <script type="module">
	    // Import the functions you need from the SDKs you need
import { initializeApp } from "https://www.gstatic.com/firebasejs/10.7.1/firebase-app.js";
import { getAuth, onAuthStateChanged, signInWithEmailAndPassword,
         createUserWithEmailAndPassword, sendEmailVerification,
         sendPasswordResetEmail, signOut, updateProfile } 
  from "https://www.gstatic.com/firebasejs/10.7.1/firebase-auth.js";
import { getFirestore, doc, setDoc, getDoc } 
  from "https://www.gstatic.com/firebasejs/10.7.1/firebase-firestore.js";

// Your web app's Firebase configuration
const firebaseConfig = {
  apiKey: "AIzaSyDG1xj3HzkxuYXS1pl1mK-jN3xctgSQ4Xs",
  authDomain: "fratelli-pazzi-pizzeria.firebaseapp.com",
  projectId: "fratelli-pazzi-pizzeria",
  storageBucket: "fratelli-pazzi-pizzeria.firebasestorage.app",
  messagingSenderId: "391760015146",
  appId: "1:391760015146:web:24a265cabeefbff2187853"
};

// Initialize Firebase
const app = initializeApp(firebaseConfig);
const auth = getAuth(app);
const db   = getFirestore(app);

// Hacemos accesible auth y db globalmente para tu c√≥digo existente
window.firebase = { auth, db,
  signInWithEmailAndPassword, createUserWithEmailAndPassword,
  sendEmailVerification, sendPasswordResetEmail, signOut,
  updateProfile, onAuthStateChanged, doc, setDoc, getDoc
};
    // ========== FRATELLI PAZZI APPLICATION ==========
    const FratelliPazzi = {
      // ========== STATE MANAGEMENT ==========
      state: {
        currentSlide: 0,
        currentUser: null,
        intervals: {
          autoPlay: null,
          countdown: null,
          activity: null,
          popupCountdown: null
        },
        hasVisited: false,
        isFirebaseEnabled: false,
        notifications: new Map(),
        notificationId: 0
      },

      // ========== SISTEMA DE NOTIFICACIONES MEJORADO ==========
      
      /**
       * Muestra una notificaci√≥n elegante
       * @param {string} message - Mensaje principal
       * @param {string} type - Tipo: 'success', 'error', 'warning', 'info', 'fratelli'
       * @param {string} title - T√≠tulo opcional
       * @param {Object} options - Opciones adicionales
       */
      showNotification(message, type = 'info', title = '', options = {}) {
        const container = document.getElementById('notificationContainer');
        if (!container) return;

        const notificationId = ++this.state.notificationId;
        
        // Configurar t√≠tulos e iconos por defecto
        const config = {
          success: { icon: '‚úÖ', title: title || '¬°√âxito!' },
          error: { icon: '‚ùå', title: title || '¬°Oops!' },
          warning: { icon: '‚ö†Ô∏è', title: title || '¬°Atenci√≥n!' },
          info: { icon: '‚ÑπÔ∏è', title: title || 'Informaci√≥n' },
          fratelli: { icon: 'üçï', title: title || 'Fratelli Pazzi' }
        };

        const { icon, title: defaultTitle } = config[type] || config.info;
        const finalTitle = title || defaultTitle;

        // Crear elemento de notificaci√≥n
        const notification = document.createElement('div');
        notification.className = `notification ${type}`;
        notification.setAttribute('data-id', notificationId);
        
        // Botones de acci√≥n opcionales
        const actionsHtml = options.actions ? `
          <div class="notification-actions">
            ${options.actions.map(action => `
              <button class="notification-btn ${action.style || 'secondary'}" 
                      onclick="${action.callback}"
                      data-notification-id="${notificationId}">
                ${action.text}
              </button>
            `).join('')}
          </div>
        ` : '';

        // Barra de progreso para auto-cerrar
        const progressHtml = options.autoClose !== false ? `
          <div class="notification-progress">
            <div class="notification-progress-bar"></div>
          </div>
        ` : '';

        notification.innerHTML = `
          <div class="notification-header">
            <div class="notification-icon">${icon}</div>
            <h4 class="notification-title">${finalTitle}</h4>
          </div>
          <p class="notification-message">${message}</p>
          ${actionsHtml}
          <button class="notification-close" onclick="FratelliPazzi.closeNotification(${notificationId})">√ó</button>
          ${progressHtml}
        `;

        // Agregar al contenedor
        container.appendChild(notification);
        
        // Almacenar referencia
        this.state.notifications.set(notificationId, notification);

        // Mostrar con animaci√≥n
        setTimeout(() => {
          notification.classList.add('show');
        }, 10);

        // Auto-cerrar despu√©s del tiempo especificado
        if (options.autoClose !== false) {
          const duration = options.duration || 5000;
          setTimeout(() => {
            this.closeNotification(notificationId);
          }, duration);
        }

        // Agregar sonido de notificaci√≥n sutil (opcional)
        if (options.sound && typeof Audio !== 'undefined') {
          try {
            // Crear un sonido sutil con Web Audio API si est√° disponible
            this.playNotificationSound(type);
          } catch (e) {
            // Silenciar errores de audio
          }
        }

        return notificationId;
      },

      /**
       * Cierra una notificaci√≥n espec√≠fica
       */
      closeNotification(notificationId) {
        const notification = this.state.notifications.get(notificationId);
        if (!notification) return;

        notification.classList.remove('show');
        
        setTimeout(() => {
          if (notification.parentNode) {
            notification.parentNode.removeChild(notification);
          }
          this.state.notifications.delete(notificationId);
        }, 400);
      },

      /**
       * Cierra todas las notificaciones
       */
      closeAllNotifications() {
        this.state.notifications.forEach((notification, id) => {
          this.closeNotification(id);
        });
      },

      /**
       * Reproduce un sonido sutil de notificaci√≥n usando Web Audio API
       */
      playNotificationSound(type) {
        try {
          const audioContext = new (window.AudioContext || window.webkitAudioContext)();
          const oscillator = audioContext.createOscillator();
          const gainNode = audioContext.createGain();
          
          oscillator.connect(gainNode);
          gainNode.connect(audioContext.destination);
          
          // Frecuencias diferentes seg√∫n el tipo
          const frequencies = {
            success: [523.25, 659.25], // Do, Mi
            error: [293.66, 246.94],   // Re, Si
            warning: [440, 523.25],    // La, Do
            info: [523.25],            // Do
            fratelli: [523.25, 659.25, 783.99] // Do, Mi, Sol
          };
          
          const freqs = frequencies[type] || frequencies.info;
          
          // Configurar el sonido
          oscillator.type = 'sine';
          gainNode.gain.setValueAtTime(0, audioContext.currentTime);
          gainNode.gain.linearRampToValueAtTime(0.05, audioContext.currentTime + 0.01);
          gainNode.gain.exponentialRampToValueAtTime(0.001, audioContext.currentTime + 0.3);
          
          // Reproducir las frecuencias
          freqs.forEach((freq, index) => {
            setTimeout(() => {
              oscillator.frequency.setValueAtTime(freq, audioContext.currentTime);
            }, index * 100);
          });
          
          oscillator.start(audioContext.currentTime);
          oscillator.stop(audioContext.currentTime + 0.3);
        } catch (e) {
          // Fallar silenciosamente si no hay soporte de audio
        }
      },

      /**
       * Muestra un modal de confirmaci√≥n elegante
       */
      showConfirmation(message, title = '¬øEst√°s seguro?', icon = 'üçï') {
        return new Promise((resolve) => {
          const modal = document.getElementById('confirmationModal');
          const titleEl = document.getElementById('confirmationTitle');
          const messageEl = document.getElementById('confirmationMessage');
          const iconEl = document.getElementById('confirmationIcon');
          const confirmBtn = document.getElementById('confirmationConfirm');
          const cancelBtn = document.getElementById('confirmationCancel');

          if (!modal) {
            resolve(false);
            return;
          }

          // Configurar contenido
          titleEl.textContent = title;
          messageEl.textContent = message;
          iconEl.textContent = icon;

          // Limpiar eventos anteriores
          const newConfirmBtn = confirmBtn.cloneNode(true);
          const newCancelBtn = cancelBtn.cloneNode(true);
          confirmBtn.parentNode.replaceChild(newConfirmBtn, confirmBtn);
          cancelBtn.parentNode.replaceChild(newCancelBtn, cancelBtn);

          // Agregar nuevos eventos
          newConfirmBtn.addEventListener('click', () => {
            modal.classList.remove('show');
            resolve(true);
          });

          newCancelBtn.addEventListener('click', () => {
            modal.classList.remove('show');
            resolve(false);
          });

          // Cerrar con Escape
          const escapeHandler = (e) => {
            if (e.key === 'Escape') {
              modal.classList.remove('show');
              document.removeEventListener('keydown', escapeHandler);
              resolve(false);
            }
          };
          document.addEventListener('keydown', escapeHandler);

          // Mostrar modal
          modal.classList.add('show');
        });
      },

      // ========== INITIALIZATION ==========
      init() {
        console.log('üçï Inicializando Fratelli Pazzi...');
        
        // Verificar si Firebase est√° disponible
        this.checkFirebaseAvailability();
        
        // Event listeners
        this.setupEventListeners();
        
        // Inicializar slider
        this.updateSlider();
        
        // Precargar im√°genes
        this.preloadImages();
        
        // Optimizaciones m√≥vil
        this.initMobileOptimizations();
        
        // Verificar sesi√≥n del usuario
        this.checkUserSession();
        
        // Verificar si el usuario viene de verificar email
        this.checkEmailVerificationReturn();
        
        console.log('‚úÖ Fratelli Pazzi inicializado correctamente');
      },

      /**
       * Verifica si el usuario regresa despu√©s de verificar su email
       */
      checkEmailVerificationReturn() {
        const urlParams = new URLSearchParams(window.location.search);
        const emailVerified = urlParams.get('emailVerified');
        const resent = urlParams.get('resent');
        
        if (emailVerified === 'true') {
          // El usuario regresa despu√©s de verificar el email
          setTimeout(() => {
            if (this.state.currentUser && this.state.isFirebaseEnabled) {
              // Recargar la informaci√≥n del usuario desde Firebase
              this.refreshUserEmailStatus();
            }
            
            let message = '¬°Excelente! Tu email ha sido verificado correctamente.';
            if (resent === 'true') {
              message += '\n\nGracias por verificar tu email despu√©s del reenv√≠o.';
            }
            message += '\n\nüéâ Ahora puedes disfrutar de todos los beneficios:\n‚Ä¢ Acumular puntos en cada pedido\n‚Ä¢ Pizzas gratis cada 100 puntos\n‚Ä¢ Ofertas exclusivas por email\n\n¬°Bienvenido oficialmente a la Famiglia Fratelli!';
            
            this.showNotification(
              message,
              'success',
              '‚úÖ Email verificado',
              { 
                duration: 10000,
                actions: [
                  {
                    text: '¬°Hacer mi primer pedido!',
                    style: 'primary',
                    callback: 'window.location.href="pedido.html"'
                  }
                ]
              }
            );
            
            // Limpiar los par√°metros de la URL
            const cleanUrl = window.location.origin + window.location.pathname;
            window.history.replaceState({}, document.title, cleanUrl);
            
          }, 2000);
        }
      },

      /**
       * Refresca el estado de verificaci√≥n del email desde Firebase
       */
      async refreshUserEmailStatus() {
        if (!this.state.isFirebaseEnabled || !window.firebase.auth.currentUser) {
          return;
        }
        
        try {
          // Recargar la informaci√≥n del usuario
          await window.firebase.auth.currentUser.reload();
          
          const isNowVerified = window.firebase.auth.currentUser.emailVerified;
          
          if (isNowVerified && this.state.currentUser && !this.state.currentUser.emailVerified) {
            console.log('‚úÖ Email verificado detectado, actualizando estado...');
            
            // Actualizar estado local
            this.state.currentUser.emailVerified = true;
            
            // Actualizar Firestore
            try {
              await window.firebase.setDoc(
                window.firebase.doc(window.firebase.db, 'users', window.firebase.auth.currentUser.uid),
                {
                  emailVerified: true,
                  emailVerifiedAt: new Date().toISOString()
                },
                { merge: true }
              );
            } catch (firestoreError) {
              console.error('‚ö†Ô∏è Error actualizando Firestore:', firestoreError);
            }
            
            // Actualizar la interfaz
            this.updateUserInterface();
            
            console.log('üéâ Estado de verificaci√≥n actualizado correctamente');
          }
        } catch (error) {
          console.error('‚ùå Error refrescando estado del email:', error);
        }
      },

      checkFirebaseAvailability() {
        if (typeof window.firebase !== 'undefined') {
          this.state.isFirebaseEnabled = true;
          console.log('üî• Firebase habilitado');
          this.setupFirebaseAuth();
        } else {
          console.log('‚ö†Ô∏è Firebase no disponible, usando localStorage');
          this.state.isFirebaseEnabled = false;
        }
        
        // Debug info
        console.log('üîç Estado de Firebase:', {
          disponible: typeof window.firebase !== 'undefined',
          habilitado: this.state.isFirebaseEnabled,
          windowFirebase: window.firebase ? 'SI' : 'NO'
        });
      },

      setupFirebaseAuth() {
        if (!this.state.isFirebaseEnabled) return;
        
        try {
          window.firebase.onAuthStateChanged(window.firebase.auth, async (user) => {
            if (user) {
              console.log('üë§ Usuario autenticado:', {
                uid: user.uid,
                email: user.email,
                emailVerified: user.emailVerified,
                displayName: user.displayName,
                metadata: {
                  creationTime: user.metadata.creationTime,
                  lastSignInTime: user.metadata.lastSignInTime
                }
              });
              
              // Obtener datos adicionales del usuario desde Firestore
              let userData = {
                uid: user.uid,
                email: user.email,
                name: user.displayName || 'Usuario',
                emailVerified: user.emailVerified,
                points: 0
              };
              
              try {
                const userDoc = await window.firebase.getDoc(
                  window.firebase.doc(window.firebase.db, 'users', user.uid)
                );
                
                if (userDoc.exists()) {
                  const firestoreData = userDoc.data();
                  userData = {
                    ...userData,
                    name: firestoreData.name || user.displayName || 'Usuario',
                    points: firestoreData.points || 0,
                    phone: firestoreData.phone,
                    acceptsOffers: firestoreData.acceptsOffers,
                    registeredAt: firestoreData.registeredAt
                  };
                  console.log('‚úÖ Datos de Firestore cargados:', firestoreData);
                }
              } catch (firestoreError) {
                console.error('‚ö†Ô∏è Error cargando datos de Firestore:', firestoreError);
              }
              
              this.state.currentUser = userData;
              this.updateUserInterface();
              
              // Si el email se verific√≥ desde la √∫ltima vez que checamos, mostrar celebraci√≥n
              const wasUnverified = localStorage.getItem('fratelli_was_unverified') === 'true';
              if (user.emailVerified && wasUnverified) {
                localStorage.removeItem('fratelli_was_unverified');
                setTimeout(() => {
                  this.showNotification(
                    '¬°Felicidades! Tu email ha sido verificado exitosamente.\n\nüéâ Ahora puedes disfrutar de todos los beneficios de Fratelli Pazzi:\n‚Ä¢ Acumular puntos en cada pedido\n‚Ä¢ Pizzas gratis cada 100 puntos\n‚Ä¢ Ofertas exclusivas por email\n\n¬°Bienvenido oficialmente a la Famiglia!',
                    'success',
                    '‚úÖ Email verificado',
                    { 
                      duration: 10000,
                      actions: [
                        {
                          text: '¬°Hacer mi primer pedido!',
                          style: 'primary',
                          callback: 'window.location.href="pedido.html"'
                        }
                      ]
                    }
                  );
                }, 1000);
              }
              
              // Guardar estado para detectar cambios futuros
              if (!user.emailVerified) {
                localStorage.setItem('fratelli_was_unverified', 'true');
              }
              
            } else {
              console.log('üë§ Usuario no autenticado');
              this.state.currentUser = null;
              localStorage.removeItem('fratelli_was_unverified');
              this.showGuestInterface();
            }
          });
        } catch (error) {
          console.error('Error configurando Firebase Auth:', error);
          this.state.isFirebaseEnabled = false;
          this.showNotification(
            'Error de conexi√≥n con el sistema de autenticaci√≥n. Usando modo offline.',
            'warning',
            'Modo Offline'
          );
        }
      },

      // ========== EVENT LISTENERS ==========
      setupEventListeners() {
        // Load event
        window.addEventListener('load', () => {
          this.hideMainLoader();
          this.startAutoPlay();
        });

        // DOM Content Loaded
        document.addEventListener('DOMContentLoaded', () => {
          // Slider touch events
          this.setupSliderTouchEvents();
          
          // Navigation smooth scroll
          this.setupSmoothScroll();
          
          // Dropdown close on outside click
          document.addEventListener('click', (e) => {
            const dropdown = document.getElementById('userDropdown');
            const userWelcome = document.querySelector('.user-welcome');
            
            if (dropdown && !userWelcome?.contains(e.target)) {
              dropdown.classList.remove('show');
            }
          });
        });

        // Cleanup on page unload
        window.addEventListener('beforeunload', () => {
          this.cleanup();
        });

        // Keyboard navigation for slider
        document.addEventListener('keydown', (e) => {
          if (e.key === 'ArrowLeft') {
            this.moveSlider(-1);
          } else if (e.key === 'ArrowRight') {
            this.moveSlider(1);
          }
          
          // Debug mode con Ctrl+Alt+D
          if (e.ctrlKey && e.altKey && e.key === 'D') {
            this.showDebugInfo();
          }
        });

        // Slider hover events
        const sliderElement = document.querySelector('.fullwidth-slider');
        if (sliderElement) {
          sliderElement.addEventListener('mouseenter', () => this.stopAutoPlay());
          sliderElement.addEventListener('mouseleave', () => this.startAutoPlay());
        }
      },

      // ========== LOADER MANAGEMENT ==========
      hideMainLoader() {
        const loader = document.getElementById('pageLoader');
        if (loader) {
          setTimeout(() => {
            loader.classList.add('hidden');
            this.startSectionAnimations();
            
            setTimeout(() => {
              this.startCountdown();
              this.startActivityCounter();
            }, 500);
          }, 3000);
        }
      },

      startSectionAnimations() {
        const observer = new IntersectionObserver((entries) => {
          entries.forEach(entry => {
            if (entry.isIntersecting) {
              entry.target.classList.add('visible');
            }
          });
        }, {
          threshold: 0.2,
          rootMargin: '0px 0px -50px 0px'
        });

        document.querySelectorAll('.section-transition').forEach(section => {
          observer.observe(section);
        });

        document.querySelectorAll('.pizza-card').forEach(card => {
          observer.observe(card);
        });
      },

      // ========== SLIDER FUNCTIONALITY ==========
      updateSlider() {
        const wrapper = document.querySelector('.slider-wrapper');
        const dots = document.querySelectorAll('.slider-dots span');
        
        if (wrapper) {
          wrapper.style.transform = `translateX(-${this.state.currentSlide * 100}%)`;
        }
        
        dots.forEach(dot => dot.classList.remove('active'));
        if (dots[this.state.currentSlide]) {
          dots[this.state.currentSlide].classList.add('active');
        }
      },

      moveSlider(direction) {
        const slides = document.querySelectorAll('.slider-wrapper img');
        if (slides.length > 0) {
          this.state.currentSlide = (this.state.currentSlide + direction + slides.length) % slides.length;
          this.updateSlider();
        }
      },

      moveSliderTo(index) {
        const slides = document.querySelectorAll('.slider-wrapper img');
        if (slides.length > 0 && index >= 0 && index < slides.length) {
          this.state.currentSlide = index;
          this.updateSlider();
        }
      },

      startAutoPlay() {
        const slides = document.querySelectorAll('.slider-wrapper img');
        if (slides.length > 0) {
          this.state.intervals.autoPlay = setInterval(() => {
            this.moveSlider(1);
          }, 5000);
        }
      },

      stopAutoPlay() {
        if (this.state.intervals.autoPlay) {
          clearInterval(this.state.intervals.autoPlay);
          this.state.intervals.autoPlay = null;
        }
      },

      setupSliderTouchEvents() {
        const slider = document.querySelector('.fullwidth-slider');
        if (!slider) return;

        let startX, currentX, isDragging = false;
        
        slider.addEventListener('touchstart', (e) => {
          startX = e.touches[0].clientX;
          isDragging = true;
          this.stopAutoPlay();
        }, { passive: true });
        
        slider.addEventListener('touchmove', (e) => {
          if (!isDragging) return;
          currentX = e.touches[0].clientX;
        }, { passive: true });
        
        slider.addEventListener('touchend', (e) => {
          if (!isDragging) return;
          isDragging = false;
          
          const diffX = startX - currentX;
          const threshold = 50;
          
          if (Math.abs(diffX) > threshold) {
            if (diffX > 0) {
              this.moveSlider(1);
            } else {
              this.moveSlider(-1);
            }
          }
          
          this.startAutoPlay();
        }, { passive: true });
      },

      // ========== COUNTDOWN & ACTIVITY ==========
      startCountdown() {
        let timeLeft = 2.5 * 60 * 60; // 2.5 horas en segundos
        
        this.state.intervals.countdown = setInterval(() => {
          const hours = Math.floor(timeLeft / 3600);
          const minutes = Math.floor((timeLeft % 3600) / 60);
          const seconds = timeLeft % 60;
          
          const countdownElement = document.getElementById('countdown');
          if (countdownElement) {
            countdownElement.textContent = 
              `${hours}:${minutes.toString().padStart(2, '0')}:${seconds.toString().padStart(2, '0')}`;
          }
          
          timeLeft--;
          
          if (timeLeft < 0) {
            clearInterval(this.state.intervals.countdown);
            this.closeBanner();
          }
        }, 1000);
      },

      startActivityCounter() {
        const viewersElement = document.getElementById('viewersCount');
        if (!viewersElement) return;
        
        let viewers = 3;
        
        this.state.intervals.activity = setInterval(() => {
          const viewerChange = Math.floor(Math.random() * 5) - 2;
          viewers = Math.max(1, Math.min(8, viewers + viewerChange));
          viewersElement.textContent = viewers;
        }, 8000);
      },

      closeBanner() {
        const banner = document.getElementById('urgentBanner');
        const header = document.getElementById('header');
        const body = document.body;
        
        if (banner) {
          banner.classList.add('hidden');
          if (header) header.classList.remove('with-banner');
          if (body) {
            body.style.paddingTop = '0';
            body.classList.add('banner-hidden');
          }
          
          setTimeout(() => {
            banner.style.display = 'none';
          }, 300);
        }
      },

      // ========== USER AUTHENTICATION ==========
      checkUserSession() {
        if (this.state.isFirebaseEnabled) {
          // Firebase manejar√° esto autom√°ticamente
          return;
        }
        
        // Fallback a localStorage
        const userMenu = document.getElementById('userMenu');
        if (!userMenu) {
          setTimeout(() => this.checkUserSession(), 200);
          return;
        }
        
        const savedUser = localStorage.getItem('fratelli_current_user');
        if (savedUser) {
          this.state.currentUser = JSON.parse(savedUser);
          this.updateUserInterface();
        } else {
          this.showGuestInterface();
        }
      },

      updateUserInterface() {
        const userMenu = document.getElementById('userMenu');
        const authSection = document.getElementById('authSection');
        
        if (!userMenu || !this.state.currentUser) return;
        
        // Ocultar la secci√≥n de autenticaci√≥n cuando hay usuario logueado
        if (authSection) {
          authSection.style.display = 'none';
        }
        
        const emailVerificationBadge = !this.state.currentUser.emailVerified ? 
          '<span style="background: #ff6b6b; color: white; font-size: 10px; padding: 2px 6px; border-radius: 10px; margin-left: 5px;">üìß No verificado</span>' : '';
        
        userMenu.innerHTML = `
          <div class="user-dropdown">
            <div class="user-welcome" onclick="FratelliPazzi.toggleDropdown()">
              <div class="user-avatar">${this.state.currentUser.name.charAt(0).toUpperCase()}</div>
              <span>Hola, ${this.state.currentUser.name.split(' ')[0]}</span>
              ${emailVerificationBadge}
              <span style="font-size: 12px;">‚ñº</span>
            </div>
            <div class="dropdown-content" id="userDropdown">
              ${!this.state.currentUser.emailVerified ? 
                '<a href="javascript:void(0)" onclick="FratelliPazzi.resendVerificationEmail()" style="color: #ff6b6b; font-weight: bold;">üìß Verificar Email</a>' : ''}
              <a href="javascript:void(0)" onclick="FratelliPazzi.showProfile()">Mi Perfil</a>
              <a href="javascript:void(0)" onclick="FratelliPazzi.showOrderHistory()">Mis Pedidos</a>
              <a href="javascript:void(0)" onclick="FratelliPazzi.showUserPoints()">Mis Puntos (${this.state.currentUser.points || 0})</a>
              <a href="javascript:void(0)" onclick="FratelliPazzi.logout()">Cerrar Sesi√≥n</a>
            </div>
          </div>
        `;
      },

      showGuestInterface() {
        const userMenu = document.getElementById('userMenu');
        const authSection = document.getElementById('authSection');
        
        if (!userMenu) return;
        
        // Limpiar la navegaci√≥n principal - sin botones
        userMenu.innerHTML = '';
        
        // Mostrar la secci√≥n de autenticaci√≥n separada
        if (authSection) {
          authSection.style.display = 'block';
        }
      },

      toggleDropdown() {
        const dropdown = document.getElementById('userDropdown');
        if (dropdown) {
          dropdown.classList.toggle('show');
        }
      },

      // ========== LOGIN FUNCTIONALITY ==========
      showLoginForm() {
        this.closeRegisterForm();
        const popup = document.getElementById('loginPopup');
        if (popup) {
          popup.classList.add('show');
          document.getElementById('loginError').style.display = 'none';
        }
      },

      closeLoginForm() {
        const popup = document.getElementById('loginPopup');
        if (popup) {
          popup.classList.remove('show');
          document.getElementById('login-email').value = '';
          document.getElementById('login-password').value = '';
          document.getElementById('loginError').style.display = 'none';
        }
      },

      async handleLogin(event) {
        event.preventDefault();
        
        console.log('üîë Iniciando proceso de login...');
        
        const email = document.getElementById('login-email').value;
        const password = document.getElementById('login-password').value;
        const errorDiv = document.getElementById('loginError');
        
        console.log('üìã Datos de login:', {
          email: email,
          passwordLength: password.length,
          firebaseEnabled: this.state.isFirebaseEnabled
        });
        
        if (this.state.isFirebaseEnabled) {
          console.log('üî• Intentando login con Firebase...');
          try {
            const userCredential = await window.firebase.signInWithEmailAndPassword(window.firebase.auth, email, password);
            console.log('‚úÖ Login exitoso con Firebase');
            
            // Verificar si el email est√° verificado
            if (!userCredential.user.emailVerified) {
              console.log('‚ö†Ô∏è Email no verificado');
              this.closeLoginForm();
              
              // Usar el nuevo sistema de notificaciones en lugar de confirm
              const shouldResend = await this.showConfirmation(
                `Tu email no est√° verificado a√∫n.\n\nüìß Email: ${email}\n\n¬øQuieres que te reenviemos el email de verificaci√≥n?`,
                '‚ö†Ô∏è Email no verificado',
                'üìß'
              );
              
              if (shouldResend) {
                try {
                  await window.firebase.sendEmailVerification(userCredential.user);
                  this.showNotification(
                    'Email de verificaci√≥n reenviado exitosamente.\n\nRevisa tu bandeja de entrada y la carpeta de spam.',
                    'success',
                    'üìß Email enviado'
                  );
                } catch (error) {
                  console.error('Error reenviando verificaci√≥n:', error);
                  this.showNotification(
                    'Error al reenviar el email. Puedes intentarlo desde tu perfil.',
                    'error',
                    'Error en env√≠o'
                  );
                }
              }
              
              this.updateUserInterface();
              this.showNotification(
                `¬°Hola ${email}! Recuerda verificar tu email üìß`,
                'fratelli',
                '¬°Bienvenido!'
              );
            } else {
              console.log('‚úÖ Email verificado correctamente');
              this.closeLoginForm();
              this.showNotification(
                '¬°Bienvenido de vuelta! Ya puedes empezar a acumular puntos.',
                'success',
                '¬°Perfecto!'
              );
            }
          } catch (error) {
            console.error('‚ùå Error en login Firebase:', {
              code: error.code,
              message: error.message
            });
            
            let errorMessage = 'Email o contrase√±a incorrectos';
            if (error.code === 'auth/user-not-found') {
              errorMessage = 'No existe una cuenta con este email';
            } else if (error.code === 'auth/wrong-password') {
              errorMessage = 'Contrase√±a incorrecta';
            } else if (error.code === 'auth/invalid-email') {
              errorMessage = 'Email no v√°lido';
            }
            
            this.showNotification(errorMessage, 'error', 'Error de acceso');
          }
        } else {
          console.log('üíæ Intentando login con localStorage...');
          
          // Fallback a localStorage
          const users = JSON.parse(localStorage.getItem('fratelli_users') || '[]');
          console.log('üë• Usuarios en localStorage:', users.length);
          
          const user = users.find(u => u.email === email && u.password === password);
          
          if (user) {
            console.log('‚úÖ Login exitoso con localStorage');
            this.state.currentUser = user;
            localStorage.setItem('fratelli_current_user', JSON.stringify(user));
            this.closeLoginForm();
            this.updateUserInterface();
            this.showNotification(
              `¬°Bienvenido de vuelta, ${user.name.split(' ')[0]}!`,
              'success',
              '¬°Hola de nuevo!'
            );
          } else {
            console.log('‚ùå Login fallido en localStorage');
            this.showNotification(
              'Email o contrase√±a incorrectos. Verifica tus datos.',
              'error',
              'Error de acceso'
            );
          }
        }
      },

      switchToRegister() {
        this.closeLoginForm();
        setTimeout(() => this.showRegisterForm(), 300);
      },

      async forgotPassword() {
        // Crear un prompt personalizado con notificaci√≥n
        const email = prompt('Introduce tu email para restablecer la contrase√±a:');
        
        if (!email) {
          return;
        }
        
        if (!email.includes('@')) {
          this.showNotification(
            'Por favor, introduce un email v√°lido.',
            'warning',
            'Email inv√°lido'
          );
          return;
        }
        
        if (this.state.isFirebaseEnabled) {
          console.log('üìß Enviando email de restablecimiento para:', email);
          
          try {
            await window.firebase.sendPasswordResetEmail(window.firebase.auth, email);
            console.log('‚úÖ Email de restablecimiento enviado');
            
            this.showNotification(
              `Email de restablecimiento enviado a ${email}\n\nRevisa tu bandeja de entrada y sigue las instrucciones.\n\nSi no ves el email, revisa la carpeta de spam.`,
              'success',
              'üìß Email enviado',
              { duration: 8000 }
            );
          } catch (error) {
            console.error('‚ùå Error enviando email de restablecimiento:', error);
            
            let errorMessage = 'Error al enviar el email de restablecimiento.';
            
            if (error.code === 'auth/user-not-found') {
              errorMessage = 'No existe una cuenta registrada con este email.';
            } else if (error.code === 'auth/invalid-email') {
              errorMessage = 'El formato del email no es v√°lido.';
            } else if (error.code === 'auth/too-many-requests') {
              errorMessage = 'Demasiados intentos. Espera unos minutos e int√©ntalo de nuevo.';
            }
            
            this.showNotification(
              `${errorMessage}\n\nSi el problema persiste, contacta con nosotros:\nüìß PIZZASFRATELLIPAZZI@GMAIL.COM\nüì± 660 668 812`,
              'error',
              'Error en restablecimiento',
              { duration: 10000 }
            );
          }
        } else {
          // Fallback para localStorage
          this.showNotification(
            'Para recuperar tu contrase√±a en modo offline, contacta con nosotros:\nüìß PIZZASFRATELLIPAZZI@GMAIL.COM\nüì± 660 668 812',
            'info',
            'Contacto requerido',
            { duration: 8000 }
          );
        }
      },

      async resendVerificationEmail() {
        if (!this.state.currentUser || this.state.currentUser.emailVerified) {
          this.showNotification(
            'Tu email ya est√° verificado o no tienes una sesi√≥n activa.',
            'info',
            'No es necesario'
          );
          return;
        }
        
        if (this.state.isFirebaseEnabled && window.firebase.auth.currentUser) {
          console.log('üìß Reenviando email de verificaci√≥n...');
          
          // Mostrar progreso
          this.showNotification(
            'Preparando reenv√≠o del email de verificaci√≥n...',
            'info',
            'üìß Procesando',
            { autoClose: false }
          );
          
          // Verificar que el usuario actual de Firebase existe
          const currentUser = window.firebase.auth.currentUser;
          if (!currentUser) {
            this.closeAllNotifications();
            this.showNotification(
              'No hay una sesi√≥n activa. Por favor, inicia sesi√≥n de nuevo.',
              'error',
              'Sesi√≥n requerida'
            );
            return;
          }
          
          console.log('üë§ Usuario actual en Firebase:', {
            uid: currentUser.uid,
            email: currentUser.email,
            emailVerified: currentUser.emailVerified
          });
          
          // Verificar si ya est√° verificado
          if (currentUser.emailVerified) {
            this.closeAllNotifications();
            this.showNotification(
              '¬°Tu email ya est√° verificado! Puedes empezar a acumular puntos.',
              'success',
              '‚úÖ Email verificado'
            );
            
            // Actualizar el estado local
            this.state.currentUser.emailVerified = true;
            this.updateUserInterface();
            return;
          }
          
          // Configuraci√≥n mejorada para el reenv√≠o
          const actionCodeSettings = {
            url: `${window.location.origin}?emailVerified=true&resent=true`,
            handleCodeInApp: false,
            // Informaci√≥n adicional para debugging
            iOS: {
              bundleId: 'com.fratellipazzi.app'
            },
            android: {
              packageName: 'com.fratellipazzi.app',
              installApp: false,
              minimumVersion: '1'
            }
          };
          
          try {
            // Actualizar progreso
            this.closeAllNotifications();
            this.showNotification(
              'Enviando email de verificaci√≥n...',
              'info',
              'üì® Enviando',
              { autoClose: false }
            );
            
            await window.firebase.sendEmailVerification(currentUser, actionCodeSettings);
            
            // Cerrar notificaci√≥n de progreso
            this.closeAllNotifications();
            
            console.log('‚úÖ Email de verificaci√≥n reenviado exitosamente');
            
            const timestamp = new Date().toISOString();
            
            // Guardar informaci√≥n del reenv√≠o
            localStorage.setItem('fratelli_last_verification_resend', JSON.stringify({
              email: this.state.currentUser.email,
              resentAt: timestamp,
              uid: currentUser.uid
            }));
            
            // Actualizar Firestore si es posible
            try {
              await window.firebase.setDoc(
                window.firebase.doc(window.firebase.db, 'users', currentUser.uid),
                {
                  lastVerificationEmailSent: timestamp,
                  verificationEmailResendCount: (this.state.currentUser.verificationEmailResendCount || 0) + 1
                },
                { merge: true }
              );
            } catch (firestoreError) {
              console.error('‚ö†Ô∏è Error actualizando Firestore (no cr√≠tico):', firestoreError);
            }
            
            this.showNotification(
              `Email de verificaci√≥n reenviado exitosamente\n\nüì¨ Enviado a: ${this.state.currentUser.email}\n\n‚úÖ Revisa tu bandeja de entrada y la carpeta de spam.\n\nüí° El email viene de Firebase Auth y puede tardar hasta 5 minutos en llegar.\n\nüîç Si el problema persiste, verifica:\n‚Ä¢ Que el email est√© escrito correctamente\n‚Ä¢ Tu conexi√≥n a internet\n‚Ä¢ Los filtros de tu email\n\nüìß Enviado el: ${new Date().toLocaleString('es-ES')}`,
              'success',
              'üìß Email reenviado',
              { 
                duration: 15000,
                actions: [
                  {
                    text: 'Entendido',
                    style: 'primary',
                    callback: `FratelliPazzi.closeNotification(this.dataset.notificationId)`
                  }
                ]
              }
            );
            
          } catch (error) {
            // Cerrar notificaci√≥n de progreso
            this.closeAllNotifications();
            
            console.error('‚ùå Error detallado reenviando verificaci√≥n:', {
              code: error.code,
              message: error.message,
              stack: error.stack,
              userEmail: this.state.currentUser.email,
              userUID: currentUser?.uid,
              timestamp: new Date().toISOString()
            });
            
            let errorMessage = 'Error al reenviar el email de verificaci√≥n.';
            let errorTitle = '‚ùå Error en reenv√≠o';
            
            if (error.code === 'auth/too-many-requests') {
              errorMessage = 'Demasiados intentos de reenv√≠o. Espera al menos 1 minuto antes de intentar de nuevo.\n\nPor tu seguridad, Firebase limita el n√∫mero de emails que se pueden enviar.';
              errorTitle = 'üö´ L√≠mite de reenv√≠os';
            } else if (error.code === 'auth/user-disabled') {
              errorMessage = 'Esta cuenta ha sido deshabilitada. Contacta con soporte para m√°s informaci√≥n.';
              errorTitle = 'üö´ Cuenta deshabilitada';
            } else if (error.code === 'auth/user-not-found') {
              errorMessage = 'Usuario no encontrado. Intenta cerrar sesi√≥n y registrarte de nuevo.';
              errorTitle = 'üë§ Usuario no encontrado';
            } else if (error.code === 'auth/network-request-failed') {
              errorMessage = 'Error de conexi√≥n a internet. Verifica tu conexi√≥n e int√©ntalo de nuevo.';
              errorTitle = 'üåê Sin conexi√≥n';
            } else if (error.code === 'auth/invalid-action-code') {
              errorMessage = 'C√≥digo de acci√≥n inv√°lido. Intenta cerrar sesi√≥n y volver a iniciar sesi√≥n.';
              errorTitle = 'üîë C√≥digo inv√°lido';
            } else if (error.message.includes('domain') || error.message.includes('unauthorized')) {
              errorMessage = 'Problema de configuraci√≥n del servidor. Contacta con soporte t√©cnico.';
              errorTitle = '‚öôÔ∏è Error de configuraci√≥n';
            }
            
            // Guardar error para debugging
            localStorage.setItem('fratelli_verification_resend_error', JSON.stringify({
              error: {
                code: error.code,
                message: error.message
              },
              email: this.state.currentUser.email,
              uid: currentUser?.uid,
              timestamp: new Date().toISOString()
            }));
            
            this.showNotification(
              `${errorMessage}\n\nüîç Detalles t√©cnicos: ${error.message}\n\nüí¨ Si el problema persiste, contacta con nosotros:\nüìß PIZZASFRATELLIPAZZI@GMAIL.COM\nüì± 660 668 812`,
              'error',
              errorTitle,
              { 
                duration: 12000,
                actions: [
                  {
                    text: 'Contactar Soporte',
                    style: 'secondary',
                    callback: 'window.open("mailto:PIZZASFRATELLIPAZZI@GMAIL.COM?subject=Problema%20verificaci√≥n%20email")'
                  }
                ]
              }
            );
          }
        } else {
          this.showNotification(
            'Para reenviar la verificaci√≥n por email, contacta con nosotros:\nüìß PIZZASFRATELLIPAZZI@GMAIL.COM\nüì± 660 668 812\n\nProporciona tu email registrado para que podamos ayudarte.',
            'info',
            'Contacto requerido',
            {
              actions: [
                {
                  text: 'Enviar Email',
                  style: 'primary',
                  callback: 'window.open("mailto:PIZZASFRATELLIPAZZI@GMAIL.COM?subject=Reenv√≠o%20verificaci√≥n%20email")'
                }
              ]
            }
          );
        }
      },

      // ========== REGISTER FUNCTIONALITY ==========
      showRegisterForm() {
        this.closeLoginForm();
        const popup = document.getElementById('registerPopup');
        if (popup) {
          popup.classList.add('show');
        }
      },

      closeRegisterForm() {
        const popup = document.getElementById('registerPopup');
        if (popup) {
          popup.classList.remove('show');
          this.clearRegistrationForm();
        }
      },

      async handleRegistration(event) {
        event.preventDefault();
        
        console.log('üîÑ Iniciando proceso de registro...');
        
        const name = document.getElementById('register-name').value.trim();
        const email = document.getElementById('register-email').value.trim().toLowerCase();
        const password = document.getElementById('register-password').value;
        const confirmPassword = document.getElementById('register-confirm-password').value;
        const phone = document.getElementById('register-phone').value.trim();
        const acceptsOffers = document.getElementById('register-offers').checked;
        const acceptsTerms = document.getElementById('register-terms').checked;
        
        console.log('üìã Datos del formulario:', {
          name: name,
          email: email,
          passwordLength: password.length,
          confirmPasswordMatch: password === confirmPassword,
          acceptsTerms: acceptsTerms,
          firebaseEnabled: this.state.isFirebaseEnabled
        });
        
        // Validaciones
        if (!acceptsTerms) {
          this.showNotification(
            'Debes aceptar los t√©rminos y condiciones para continuar.',
            'warning',
            'T√©rminos requeridos'
          );
          return;
        }
        
        if (password.length < 6) {
          this.showNotification(
            'La contrase√±a debe tener al menos 6 caracteres.',
            'warning',
            'Contrase√±a muy corta'
          );
          return;
        }
        
        if (password !== confirmPassword) {
          this.showNotification(
            'Las contrase√±as no coinciden. Por favor, verifica que sean iguales.',
            'error',
            'Contrase√±as diferentes'
          );
          return;
        }

        const registerBtn = document.querySelector('.register-btn');
        const originalText = registerBtn.innerHTML;
        registerBtn.innerHTML = '<div class="pizza-spinner" style="width: 20px; height: 20px; margin: 0 auto;"><div class="pizza-base"><div class="pizza-sauce"><div class="pizza-cheese"></div><div class="pizza-cheese"></div></div></div></div>';
        registerBtn.disabled = true;

        try {
          if (this.state.isFirebaseEnabled) {
            console.log('üî• Intentando registro con Firebase...');
            
            // Verificar que Firebase est√© realmente disponible
            if (!window.firebase || !window.firebase.auth || !window.firebase.createUserWithEmailAndPassword) {
              throw new Error('Firebase no est√° completamente cargado');
            }
            
            // Mostrar notificaci√≥n de progreso
            this.showNotification(
              'Creando tu cuenta... Por favor espera.',
              'info',
              'üîÑ Procesando',
              { autoClose: false }
            );
            
            // Registrar con Firebase
            console.log('üìß Creando usuario con email y contrase√±a...');
            const userCredential = await window.firebase.createUserWithEmailAndPassword(window.firebase.auth, email, password);
            console.log('‚úÖ Usuario creado en Firebase Auth:', {
              uid: userCredential.user.uid,
              email: userCredential.user.email,
              emailVerified: userCredential.user.emailVerified
            });
            
            // Cerrar notificaci√≥n de progreso
            this.closeAllNotifications();
            
            // IMPORTANTE: Actualizar displayName antes de enviar email de verificaci√≥n
            try {
              const { updateProfile } = await import('https://www.gstatic.com/firebasejs/10.7.1/firebase-auth.js');
              await updateProfile(userCredential.user, {
                displayName: name
              });
              console.log('‚úÖ DisplayName actualizado:', name);
            } catch (profileError) {
              console.error('‚ö†Ô∏è Error actualizando perfil (no cr√≠tico):', profileError);
            }
            
            // Configuraci√≥n mejorada para el email de verificaci√≥n
            const actionCodeSettings = {
              // URL a la que se redirige despu√©s de verificar el email
              url: `${window.location.origin}?emailVerified=true`,
              handleCodeInApp: false
            };
            
            console.log('üì® Configuraci√≥n del email:', {
              url: actionCodeSettings.url,
              userEmail: email,
              userUID: userCredential.user.uid,
              userCreated: userCredential.user.metadata.creationTime
            });
            
            // Enviar email de verificaci√≥n con configuraci√≥n personalizada
            console.log('üì® Enviando email de verificaci√≥n...');
            try {
              // Verificar que el usuario est√© autenticado
              if (!userCredential.user) {
                throw new Error('Usuario no encontrado despu√©s del registro');
              }
              
              // Verificar que el email no est√© ya verificado
              if (userCredential.user.emailVerified) {
                console.log('‚úÖ El email ya est√° verificado, saltando env√≠o');
                this.closeAllNotifications();
              } else {
                // Mostrar progreso del env√≠o
                this.showNotification(
                  'Enviando email de verificaci√≥n...',
                  'info',
                  'üìß Preparando email',
                  { autoClose: false }
                );
                
                console.log('üì§ Llamando a sendEmailVerification...');
                await window.firebase.sendEmailVerification(userCredential.user, actionCodeSettings);
                
                // Cerrar notificaci√≥n de progreso
                this.closeAllNotifications();
                
                console.log('‚úÖ Email de verificaci√≥n enviado exitosamente');
                console.log('üìß Detalles del env√≠o:', {
                  timestamp: new Date().toISOString(),
                  destinatario: email,
                  configUrl: actionCodeSettings.url
                });
                
                // Verificar que el email se haya enviado correctamente
                const emailSentTime = new Date().toISOString();
                
                // Guardar informaci√≥n del env√≠o en localStorage para debugging
                localStorage.setItem('fratelli_last_verification_email', JSON.stringify({
                  email: email,
                  sentAt: emailSentTime,
                  uid: userCredential.user.uid,
                  actionUrl: actionCodeSettings.url
                }));
                
                // Mostrar mensaje de confirmaci√≥n del env√≠o
                this.showNotification(
                  '¬°Email de verificaci√≥n enviado exitosamente!\n\nüì¨ Enviado a: ' + email + '\nüìÖ Hora: ' + new Date().toLocaleString('es-ES'),
                  'success',
                  'üìß Email enviado',
                  { duration: 3000 }
                );
              }
              
            } catch (emailError) {
              console.error('‚ùå Error detallado enviando email de verificaci√≥n:', {
                code: emailError.code,
                message: emailError.message,
                stack: emailError.stack,
                userEmail: email,
                userUID: userCredential.user?.uid,
                timestamp: new Date().toISOString(),
                actionCodeSettings: actionCodeSettings
              });
              
              // Cerrar cualquier notificaci√≥n de progreso
              this.closeAllNotifications();
              
              // An√°lisis detallado del error
              let errorMessage = '';
              let errorTitle = '‚ö†Ô∏è Problema con verificaci√≥n';
              let shouldShowResendOption = true;
              
              if (emailError.code === 'auth/too-many-requests') {
                errorMessage = 'Demasiados intentos de env√≠o. Por favor espera al menos 1 minuto antes de intentar de nuevo.\n\nEsto es una medida de seguridad de Firebase.';
                errorTitle = 'üö´ L√≠mite de env√≠os alcanzado';
                shouldShowResendOption = false;
              } else if (emailError.code === 'auth/user-disabled') {
                errorMessage = 'Esta cuenta ha sido deshabilitada temporalmente. Contacta con nuestro soporte t√©cnico.';
                errorTitle = 'üö´ Cuenta deshabilitada';
                shouldShowResendOption = false;
              } else if (emailError.code === 'auth/user-not-found') {
                errorMessage = 'Error interno del sistema: usuario no encontrado despu√©s del registro.\n\nIntenta cerrar la web y registrarte de nuevo.';
                errorTitle = '‚ùå Error del sistema';
                shouldShowResendOption = false;
              } else if (emailError.code === 'auth/network-request-failed') {
                errorMessage = 'Error de conexi√≥n a internet. Verifica tu conexi√≥n e int√©ntalo de nuevo.';
                errorTitle = 'üåê Sin conexi√≥n';
              } else if (emailError.code === 'auth/invalid-email') {
                errorMessage = 'El formato del email no es v√°lido. Verifica que est√© escrito correctamente.';
                errorTitle = 'üìß Email inv√°lido';
                shouldShowResendOption = false;
              } else if (emailError.message.includes('domain') || emailError.message.includes('unauthorized')) {
                errorMessage = 'Problema de configuraci√≥n del servidor de emails. Nuestro equipo t√©cnico est√° trabajando en ello.';
                errorTitle = '‚öôÔ∏è Error de configuraci√≥n';
                shouldShowResendOption = false;
              } else {
                errorMessage = `Error t√©cnico inesperado: ${emailError.message}\n\nC√≥digo de error: ${emailError.code || 'UNKNOWN'}`;
                errorTitle = 'üîß Error t√©cnico';
              }
              
              // Preparar acciones seg√∫n el tipo de error
              const actions = [];
              if (shouldShowResendOption) {
                actions.push({
                  text: 'Reintentar Env√≠o',
                  style: 'primary',
                  callback: 'FratelliPazzi.resendVerificationEmail()'
                });
              }
              actions.push({
                text: 'Contactar Soporte',
                style: 'secondary',
                callback: 'window.open("mailto:PIZZASFRATELLIPAZZI@GMAIL.COM?subject=Error%20verificaci√≥n%20email&body=Error:%20' + encodeURIComponent(emailError.code + ' - ' + emailError.message) + '")'
              });
              
              // Mostrar mensaje espec√≠fico del error
              this.showNotification(
                `Tu cuenta fue creada exitosamente, pero hubo un problema enviando el email de verificaci√≥n.\n\nüìß Email: ${email}\nüîç Problema: ${errorMessage}\n\nüí° OPCIONES:\n‚Ä¢ Tu cuenta ya est√° creada y funcional\n‚Ä¢ Puedes intentar reenviar el email\n‚Ä¢ Contacta con soporte si el problema persiste`,
                'warning',
                errorTitle,
                { 
                  duration: 20000,
                  actions: actions
                }
              );
              
              // Guardar informaci√≥n del error para debugging
              localStorage.setItem('fratelli_verification_error', JSON.stringify({
                error: {
                  code: emailError.code,
                  message: emailError.message
                },
                email: email,
                uid: userCredential.user?.uid,
                timestamp: new Date().toISOString(),
                actionCodeSettings: actionCodeSettings
              }));
            }
            
            // Guardar datos adicionales en Firestore
            console.log('üíæ Guardando datos adicionales en Firestore...');
            try {
              await window.firebase.setDoc(window.firebase.doc(window.firebase.db, 'users', userCredential.user.uid), {
                name: name,
                email: email,
                phone: phone || null,
                acceptsOffers: acceptsOffers,
                registeredAt: new Date().toISOString(),
                points: 0,
                orders: [],
                hasUsedWelcomeDiscount: false,
                emailVerified: false,
                verificationEmailSent: true,
                lastVerificationEmailSent: new Date().toISOString()
              });
              console.log('‚úÖ Datos guardados en Firestore');
            } catch (firestoreError) {
              console.error('‚ö†Ô∏è Error guardando en Firestore (no cr√≠tico):', firestoreError);
            }

            this.state.currentUser = {
              uid: userCredential.user.uid,
              name: name,
              email: email,
              points: 0,
              emailVerified: false
            };
            
            console.log('‚úÖ Usuario registrado exitosamente con Firebase');
            
            // Mostrar mensaje de √©xito con el nuevo sistema
            setTimeout(() => {
              this.closeRegisterForm();
              this.updateUserInterface();
              
              // Mensaje de verificaci√≥n m√°s detallado usando notificaciones
              this.showNotification(
                `¬°Hola ${name.split(' ')[0]}! Tu cuenta ha sido creada exitosamente.\n\nüìß VERIFICACI√ìN DE EMAIL:\nHemos enviado un email de verificaci√≥n a:\n${email}\n\nüìã PASOS SIGUIENTES:\n1. Revisa tu bandeja de entrada\n2. Busca el email de Firebase Auth\n3. Haz clic en el enlace de verificaci√≥n\n4. ¬°Listo! Ya puedes empezar a acumular puntos\n\nüí° Si no ves el email:\n- Revisa la carpeta de spam/promociones\n- Espera unos minutos (puede tardar hasta 5 min)\n- Puedes reenviar desde tu perfil de usuario\n\nüéâ ¬°Bienvenido a la Famiglia Fratelli!`,
                'fratelli',
                'üçï ¬°Cuenta creada exitosamente!',
                { 
                  duration: 20000,
                  actions: [
                    {
                      text: 'Entendido',
                      style: 'primary',
                      callback: `FratelliPazzi.closeNotification(this.dataset.notificationId)`
                    },
                    {
                      text: 'Reenviar Email',
                      style: 'secondary',
                      callback: 'FratelliPazzi.resendVerificationEmail()'
                    }
                  ]
                }
              );
              
              registerBtn.innerHTML = originalText;
              registerBtn.disabled = false;
              
              console.log('üéâ Proceso de registro completado exitosamente');
            }, 2000);
            
            return; // Salir aqu√≠ para Firebase
          } else {
            console.log('üíæ Usando localStorage como fallback...');
            
            // Fallback a localStorage
            const existingUsers = JSON.parse(localStorage.getItem('fratelli_users') || '[]');
            console.log('üìä Usuarios existentes:', existingUsers.length);
            
            const emailExists = existingUsers.find(u => u.email.toLowerCase() === email);
            
            if (emailExists) {
              console.log('‚ùå Email ya existe en localStorage');
              this.showNotification(
                `Ya existe una cuenta registrada con el email: ${email}`,
                'error',
                'Email ya registrado'
              );
              registerBtn.innerHTML = originalText;
              registerBtn.disabled = false;
              return;
            }

            const newUser = {
              id: Date.now(),
              name: name,
              email: email,
              password: password,
              phone: phone || null,
              acceptsOffers: acceptsOffers,
              registeredAt: new Date().toISOString(),
              points: 0,
              orders: [],
              hasUsedWelcomeDiscount: false,
              emailVerified: true // En modo localStorage, marcamos como verificado
            };

            existingUsers.push(newUser);
            localStorage.setItem('fratelli_users', JSON.stringify(existingUsers));
            localStorage.setItem('fratelli_current_user', JSON.stringify(newUser));
            
            this.state.currentUser = newUser;
            console.log('‚úÖ Usuario registrado exitosamente en localStorage');
          }

          setTimeout(() => {
            this.closeRegisterForm();
            this.updateUserInterface();
            
            this.showNotification(
              `¬°Bienvenido ${name.split(' ')[0]}! Tu cuenta ha sido creada exitosamente. ¬°Ya puedes empezar a acumular puntos!`,
              'success',
              'üçï ¬°Cuenta creada!'
            );
            
            registerBtn.innerHTML = originalText;
            registerBtn.disabled = false;
            
            console.log('üéâ Proceso de registro completado exitosamente');
          }, 2000);

        } catch (error) {
          console.error('‚ùå Error detallado en registro:', {
            message: error.message,
            code: error.code,
            stack: error.stack,
            firebaseEnabled: this.state.isFirebaseEnabled,
            windowFirebase: typeof window.firebase,
            auth: typeof window.firebase?.auth,
            createUser: typeof window.firebase?.createUserWithEmailAndPassword
          });
          
          // Mostrar error espec√≠fico seg√∫n el tipo
          let errorMessage = 'Error al crear la cuenta. ';
          
          if (error.code === 'auth/email-already-in-use') {
            errorMessage = '¬øQuieres iniciar sesi√≥n en su lugar?';
            this.showNotification(
              'Ya existe una cuenta con este email.',
              'warning',
              'Email ya registrado',
              {
                actions: [
                  {
                    text: 'Iniciar Sesi√≥n',
                    style: 'primary',
                    callback: 'FratelliPazzi.switchToLogin()'
                  }
                ]
              }
            );
          } else if (error.code === 'auth/invalid-email') {
            this.showNotification(
              'El formato del email no es v√°lido.',
              'error',
              'Email inv√°lido'
            );
          } else if (error.code === 'auth/weak-password') {
            this.showNotification(
              'La contrase√±a es muy d√©bil. Debe tener al menos 6 caracteres.',
              'warning',
              'Contrase√±a d√©bil'
            );
          } else if (error.code === 'auth/network-request-failed') {
            this.showNotification(
              'Error de conexi√≥n. Verifica tu internet.',
              'error',
              'Sin conexi√≥n'
            );
          } else if (error.message.includes('Firebase not available') || error.message.includes('Firebase no est√°')) {
            // Intentar con localStorage como fallback
            console.log('üîÑ Intentando fallback a localStorage...');
            try {
              const existingUsers = JSON.parse(localStorage.getItem('fratelli_users') || '[]');
              const emailExists = existingUsers.find(u => u.email.toLowerCase() === email);
              
              if (emailExists) {
                this.showNotification(
                  `Ya existe una cuenta registrada con el email: ${email}`,
                  'error',
                  'Email ya registrado'
                );
              } else {
                const newUser = {
                  id: Date.now(),
                  name: name,
                  email: email,
                  password: password,
                  phone: phone || null,
                  acceptsOffers: acceptsOffers,
                  registeredAt: new Date().toISOString(),
                  points: 0,
                  orders: [],
                  hasUsedWelcomeDiscount: false,
                  emailVerified: true
                };

                existingUsers.push(newUser);
                localStorage.setItem('fratelli_users', JSON.stringify(existingUsers));
                localStorage.setItem('fratelli_current_user', JSON.stringify(newUser));
                
                this.state.currentUser = newUser;
                
                setTimeout(() => {
                  this.closeRegisterForm();
                  this.updateUserInterface();
                  this.showNotification(
                    `¬°Bienvenido ${name.split(' ')[0]}! Cuenta creada en modo offline.`,
                    'success',
                    'üçï ¬°Cuenta creada!'
                  );
                  
                  registerBtn.innerHTML = originalText;
                  registerBtn.disabled = false;
                }, 2000);
                
                return; // Salir sin mostrar error
              }
            } catch (localError) {
              console.error('‚ùå Error tambi√©n en localStorage:', localError);
              this.showNotification(
                'Error t√©cnico. Por favor, contacta con soporte.',
                'error',
                'Error del sistema'
              );
            }
          } else {
            this.showNotification(
              `${errorMessage}Detalles: ${error.message}`,
              'error',
              'Error de registro'
            );
          }
          
          registerBtn.innerHTML = originalText;
          registerBtn.disabled = false;
        }
      },

      switchToLogin() {
        this.closeRegisterForm();
        setTimeout(() => this.showLoginForm(), 300);
      },

      clearRegistrationForm() {
        const fields = ['register-name', 'register-email', 'register-password', 'register-confirm-password', 'register-phone'];
        fields.forEach(id => {
          const field = document.getElementById(id);
          if (field) field.value = '';
        });
        
        const checkboxes = ['register-offers', 'register-terms'];
        checkboxes.forEach(id => {
          const checkbox = document.getElementById(id);
          if (checkbox) checkbox.checked = id === 'register-offers';
        });
      },

      showLoginFormFromRegister() {
        this.closeRegisterForm();
        setTimeout(() => this.showLoginForm(), 300);
      },

      showTerms() {
        window.open('terminos-condiciones.html', '_blank', 'width=900,height=700,scrollbars=yes,resizable=yes');
      },

      // ========== USER ACTIONS ==========
      async logout() {
        const shouldLogout = await this.showConfirmation(
          'Se cerrar√° tu sesi√≥n y tendr√°s que iniciar sesi√≥n de nuevo para acceder a tu cuenta.',
          '¬øCerrar sesi√≥n?',
          'üëã'
        );

        if (shouldLogout) {
          if (this.state.isFirebaseEnabled) {
            try {
              await window.firebase.signOut(window.firebase.auth);
            } catch (error) {
              console.error('Error al cerrar sesi√≥n:', error);
            }
          } else {
            localStorage.removeItem('fratelli_current_user');
          }
          
          this.state.currentUser = null;
          this.showGuestInterface(); // Esto mostrar√° la nueva secci√≥n de autenticaci√≥n
          this.showNotification(
            '¬°Hasta pronto! Te esperamos para tu pr√≥xima pizza deliciosa.',
            'fratelli',
            'üëã ¬°Nos vemos!'
          );
        }
      },

      showOrderHistory() {
        if (!this.state.currentUser) return;
        
        this.showNotification(
          '¬°A√∫n no has realizado ning√∫n pedido!\n\n¬øQu√© te parece si empezamos con una deliciosa Margarita?',
          'info',
          'üìã Historial de Pedidos',
          {
            actions: [
              {
                text: 'Ver Men√∫',
                style: 'primary',
                callback: 'window.location.href="pedido.html"'
              }
            ]
          }
        );
      },

      showUserPoints() {
        if (!this.state.currentUser) return;
        
        const points = this.state.currentUser.points || 0;
        const nextReward = 100 - (points % 100);
        
        this.showNotification(
          `Puntos actuales: ${points}\n\nüéÅ PR√ìXIMA RECOMPENSA:\nTe faltan ${nextReward} puntos para una pizza Margarita GRATIS\n\nüí° C√ìMO GANAR PUNTOS:\n‚Ä¢ 1 punto por cada 1‚Ç¨ gastado\n‚Ä¢ Bonificaciones en fechas especiales\n‚Ä¢ Rese√±as y recomendaciones\n\n¬°Sigue pidiendo y acumula puntos!`,
          'fratelli',
          '‚≠ê Mis Puntos Fratelli',
          { duration: 10000 }
        );
      },

      // ========== DISCOUNT POPUP ==========
      showWelcomeDiscount(userName) {
        const popup = document.getElementById('discountPopup');
        if (popup) {
          const welcomeText = popup.querySelector('.popup-header p');
          if (welcomeText && userName) {
            welcomeText.innerHTML = `¬°Hola ${userName}! Obt√©n <strong>15% de descuento</strong> en tu primera pizza`;
          }
          
          popup.classList.add('show');
          this.startPopupCountdown();
          this.state.hasVisited = true;
        }
      },

      startPopupCountdown() {
        let timeLeft = 15 * 60; // 15 minutos
        
        this.state.intervals.popupCountdown = setInterval(() => {
          const minutes = Math.floor(timeLeft / 60);
          const seconds = timeLeft % 60;
          
          const countdownElement = document.getElementById('popup-countdown');
          if (countdownElement) {
            countdownElement.textContent = `${minutes}:${seconds.toString().padStart(2, '0')}`;
          }
          
          timeLeft--;
          
          if (timeLeft < 0) {
            clearInterval(this.state.intervals.popupCountdown);
            this.closeDiscountPopup();
          }
        }, 1000);
      },

      closeDiscountPopup() {
        const popup = document.getElementById('discountPopup');
        if (popup) {
          popup.classList.remove('show');
          if (this.state.intervals.popupCountdown) {
            clearInterval(this.state.intervals.popupCountdown);
          }
        }
      },

      useDiscountCode() {
        if (navigator.clipboard) {
          navigator.clipboard.writeText('BIENVENIDO15').then(() => {
            this.showNotification(
              '¬°C√≥digo copiado! Te redirigimos al men√∫ para hacer tu pedido.',
              'success',
              'üìã C√≥digo copiado'
            );
          }).catch(() => {
            this.showNotification(
              'C√≥digo: BIENVENIDO15 - ¬°Te redirigimos al men√∫!',
              'info',
              'Tu c√≥digo de descuento'
            );
          });
        } else {
          this.showNotification(
            'Tu c√≥digo de descuento: BIENVENIDO15',
            'info',
            'C√≥digo de descuento'
          );
        }
        
        this.closeDiscountPopup();
        window.location.href = 'pedido.html';
      },

      // ========== DEBUG FUNCTIONS ==========
      showDebugInfo() {
        const debugInfo = {
          'Estado Firebase': this.state.isFirebaseEnabled ? '‚úÖ Habilitado' : '‚ùå Deshabilitado',
          'window.firebase': typeof window.firebase !== 'undefined' ? '‚úÖ Disponible' : '‚ùå No disponible',
          'Firebase Auth': window.firebase?.auth ? '‚úÖ Disponible' : '‚ùå No disponible',
          'Firebase Firestore': window.firebase?.db ? '‚úÖ Disponible' : '‚ùå No disponible',
          'Usuario actual': this.state.currentUser ? `‚úÖ ${this.state.currentUser.name}` : '‚ùå No logueado',
          'Email verificado': this.state.currentUser?.emailVerified ? '‚úÖ Verificado' : '‚ùå No verificado',
          'Usuarios localStorage': JSON.parse(localStorage.getItem('fratelli_users') || '[]').length + ' usuarios',
          'Modo actual': this.state.isFirebaseEnabled ? 'üî• Firebase' : 'üíæ localStorage'
        };
        
        // Informaci√≥n adicional de debugging para emails
        const emailDebugInfo = {};
        
        // Verificar √∫ltimo email enviado
        const lastVerificationEmail = localStorage.getItem('fratelli_last_verification_email');
        if (lastVerificationEmail) {
          const emailData = JSON.parse(lastVerificationEmail);
          emailDebugInfo['√öltimo email enviado'] = new Date(emailData.sentAt).toLocaleString('es-ES');
          emailDebugInfo['Email destinatario'] = emailData.email;
        }
        
        // Verificar √∫ltimo reenv√≠o
        const lastResend = localStorage.getItem('fratelli_last_verification_resend');
        if (lastResend) {
          const resendData = JSON.parse(lastResend);
          emailDebugInfo['√öltimo reenv√≠o'] = new Date(resendData.resentAt).toLocaleString('es-ES');
        }
        
        // Verificar errores de email
        const emailError = localStorage.getItem('fratelli_verification_error');
        if (emailError) {
          const errorData = JSON.parse(emailError);
          emailDebugInfo['√öltimo error email'] = `${errorData.error.code}: ${errorData.error.message}`;
        }
        
        // Informaci√≥n del usuario actual de Firebase
        if (this.state.isFirebaseEnabled && window.firebase.auth.currentUser) {
          const firebaseUser = window.firebase.auth.currentUser;
          emailDebugInfo['Firebase User UID'] = firebaseUser.uid;
          emailDebugInfo['Firebase Email'] = firebaseUser.email;
          emailDebugInfo['Firebase Verificado'] = firebaseUser.emailVerified ? '‚úÖ S√≠' : '‚ùå No';
          emailDebugInfo['Firebase Creation Time'] = new Date(firebaseUser.metadata.creationTime).toLocaleString('es-ES');
          emailDebugInfo['Firebase Last Sign In'] = new Date(firebaseUser.metadata.lastSignInTime).toLocaleString('es-ES');
        }
        
        const allDebugInfo = { ...debugInfo, ...emailDebugInfo };
        
        const debugText = Object.entries(allDebugInfo)
          .map(([key, value]) => `${key}: ${value}`)
          .join('\n');
        
        this.showNotification(
          debugText + '\n\nüìã Esta informaci√≥n ayuda a diagnosticar problemas con emails y Firebase',
          'info',
          'üîç Informaci√≥n de Debug',
          { 
            duration: 20000,
            actions: [
              {
                text: 'Copiar Info',
                style: 'secondary',
                callback: 'navigator.clipboard.writeText(this.parentElement.previousElementSibling.textContent)'
              },
              {
                text: 'Test Sistema',
                style: 'primary',
                callback: 'FratelliPazzi.testEmailVerificationSystem()'
              },
              {
                text: 'Refrescar Estado',
                style: 'primary',
                callback: 'FratelliPazzi.refreshUserEmailStatus()'
              }
            ]
          }
        );
        
        console.log('üîç Debug Info Completo:', {
          state: this.state,
          windowFirebase: window.firebase,
          currentUser: window.firebase?.auth?.currentUser,
          localStorage: {
            users: localStorage.getItem('fratelli_users'),
            currentUser: localStorage.getItem('fratelli_current_user'),
            lastVerificationEmail: localStorage.getItem('fratelli_last_verification_email'),
            lastVerificationResend: localStorage.getItem('fratelli_last_verification_resend'),
            verificationError: localStorage.getItem('fratelli_verification_error')
          },
          emailDebugInfo: emailDebugInfo
        });
      },

      /**
       * Funci√≥n para probar manualmente el env√≠o de email (solo para testing)
       */
      async manualTestEmailSend() {
        if (!this.state.isFirebaseEnabled) {
          this.showNotification(
            'Firebase no est√° habilitado. No se puede probar el env√≠o de emails.',
            'error',
            'Firebase no disponible'
          );
          return;
        }

        if (!window.firebase.auth.currentUser) {
          this.showNotification(
            'No hay usuario logueado. Inicia sesi√≥n para probar el env√≠o de emails.',
            'warning',
            'Usuario requerido'
          );
          return;
        }

        const user = window.firebase.auth.currentUser;
        
        if (user.emailVerified) {
          this.showNotification(
            'El email ya est√° verificado. No es necesario enviar otro email.',
            'info',
            'Ya verificado'
          );
          return;
        }

        const confirmed = await this.showConfirmation(
          '¬øEst√°s seguro de que quieres enviar un email de verificaci√≥n de prueba?\n\nEsto enviar√° un email real a: ' + user.email,
          'Test de Email',
          'üìß'
        );

        if (confirmed) {
          try {
            this.showNotification(
              'Enviando email de verificaci√≥n de prueba...',
              'info',
              'üß™ Probando',
              { autoClose: false }
            );

            const actionCodeSettings = {
              url: `${window.location.origin}?emailVerified=true&test=true`,
              handleCodeInApp: false
            };

            await window.firebase.sendEmailVerification(user, actionCodeSettings);
            
            this.closeAllNotifications();
            
            this.showNotification(
              '‚úÖ Email de verificaci√≥n de prueba enviado exitosamente!\n\nüì¨ Enviado a: ' + user.email + '\n‚è∞ Hora: ' + new Date().toLocaleString('es-ES') + '\n\nüîç Revisa tu bandeja de entrada.',
              'success',
              'üß™ Test Exitoso'
            );
            
            // Guardar info del test
            localStorage.setItem('fratelli_test_email_sent', JSON.stringify({
              email: user.email,
              sentAt: new Date().toISOString(),
              isTest: true
            }));

          } catch (error) {
            this.closeAllNotifications();
            this.showNotification(
              'Error en el test: ' + error.message + '\n\nC√≥digo: ' + error.code,
              'error',
              '‚ùå Test Fallido'
            );
          }
        }
      },

      // ========== UTILITY FUNCTIONS ==========
      suscribirse() {
        const email = document.getElementById('newsletter-email');
        if (!email) return;
        
        const emailValue = email.value;
        if (emailValue && emailValue.includes('@')) {
          const button = document.querySelector('.newsletter button');
          if (button) {
            const originalText = button.innerHTML;
            
            button.innerHTML = '<div class="pizza-spinner" style="width: 20px; height: 20px; margin: 0 auto;"><div class="pizza-base"><div class="pizza-sauce"><div class="pizza-cheese"></div><div class="pizza-cheese"></div></div></div></div>';
            button.disabled = true;
            
            setTimeout(() => {
              button.innerHTML = originalText;
              button.disabled = false;
              this.showNotification(
                `¬°Gracias por suscribirte! Recibir√°s nuestras ofertas en ${emailValue}`,
                'success',
                'üìß ¬°Suscrito!'
              );
              email.value = '';
            }, 2000);
          }
        } else {
          this.showNotification(
            'Por favor, introduce un email v√°lido.',
            'warning',
            'Email requerido'
          );
        }
      },

      openWhatsApp() {
        const phoneNumber = '34660668812';
        const message = encodeURIComponent('¬°Hola! Me gustar√≠a hacer un pedido en Fratelli Pazzi üçï');
        const whatsappURL = `https://wa.me/${phoneNumber}?text=${message}`;
        
        const badge = document.getElementById('whatsapp-badge');
        if (badge) {
          badge.style.display = 'none';
        }
        
        window.open(whatsappURL, '_blank');
      },

      showPageTransition(callback) {
        const overlay = document.getElementById('pageTransitionOverlay');
        if (overlay) {
          overlay.classList.add('active');
          
          setTimeout(() => {
            if (callback) callback();
          }, 300);
          
          setTimeout(() => {
            overlay.classList.remove('active');
          }, 600);
        } else if (callback) {
          callback();
        }
      },

      setupSmoothScroll() {
        document.querySelectorAll('nav a').forEach(link => {
          link.addEventListener('click', (e) => {
            const href = link.getAttribute('href');
            
            if (href && href.startsWith('#') && href.length > 1) {
              e.preventDefault();
              const targetId = href.substring(1);
              const targetElement = document.getElementById(targetId);
              
              if (targetElement) {
                this.showPageTransition(() => {
                  const header = document.getElementById('header') || document.querySelector('header');
                  const headerHeight = header ? header.offsetHeight : 80;
                  const offsetTop = targetElement.offsetTop - headerHeight - 20;
                  window.scrollTo({
                    top: Math.max(0, offsetTop),
                    behavior: 'smooth'
                  });
                });
              }
            } else if (href === 'pedido.html') {
              e.preventDefault();
              this.showPageTransition(() => {
                window.location.href = href;
              });
            }
          });
        });
      },

      initMobileOptimizations() {
        let lastScrollTop = 0;
        const header = document.getElementById('header') || document.querySelector('header');
        
        if (header) {
          window.addEventListener('scroll', () => {
            const scrollTop = window.pageYOffset || document.documentElement.scrollTop;
            
            if (scrollTop > 50) {
              header.classList.add('header-scrolled');
            } else {
              header.classList.remove('header-scrolled');
            }
            
            lastScrollTop = scrollTop <= 0 ? 0 : scrollTop;
          }, { passive: true });
        }

        // Optimizar formulario newsletter en m√≥vil
        const newsletterEmail = document.getElementById('newsletter-email');
        if (newsletterEmail) {
          newsletterEmail.addEventListener('focus', function() {
            if (window.innerWidth < 768) {
              this.style.fontSize = '16px';
            }
          });
        }

        // Prevenir bounce en iOS
        document.body.addEventListener('touchmove', (e) => {
          if (e.target === document.body) {
            e.preventDefault();
          }
        }, { passive: false });
      },

      preloadImages() {
        const imageUrls = [
          'images/oferta1.png',
          'images/oferta2.png', 
          'images/oferta3.png',
          'images/oferta4.png'
        ];
        
        imageUrls.forEach(url => {
          const img = new Image();
          img.src = url;
        });
      },

      cleanup() {
        Object.values(this.state.intervals).forEach(interval => {
          if (interval) clearInterval(interval);
        });
      }
    };

    // ========== AUTO-INITIALIZATION ==========
    // Inicializar cuando el DOM est√© listo
    if (document.readyState === 'loading') {
      document.addEventListener('DOMContentLoaded', () => FratelliPazzi.init());
    } else {
      FratelliPazzi.init();
    }

    // Hacer FratelliPazzi disponible globalmente
    window.FratelliPazzi = FratelliPazzi;

    // ========== FUNCIONES DE DEBUG GLOBAL ==========
    // Estas funciones est√°n disponibles en la consola del navegador para debugging
    
    /**
     * Funci√≥n global para probar el sistema de emails
     * Uso en consola: testEmails()
     */
    window.testEmails = function() {
      return FratelliPazzi.testEmailVerificationSystem();
    };
    
    /**
     * Funci√≥n global para enviar un email de prueba
     * Uso en consola: sendTestEmail()
     */
    window.sendTestEmail = function() {
      return FratelliPazzi.manualTestEmailSend();
    };
    
    /**
     * Funci√≥n global para mostrar informaci√≥n de debug
     * Uso en consola: debugInfo()
     */
    window.debugInfo = function() {
      return FratelliPazzi.showDebugInfo();
    };
    
    /**
     * Funci√≥n global para limpiar todos los datos de debug
     * Uso en consola: clearDebugData()
     */
    window.clearDebugData = function() {
      const keysToRemove = [
        'fratelli_last_verification_email',
        'fratelli_last_verification_resend', 
        'fratelli_verification_error',
        'fratelli_verification_resend_error',
        'fratelli_test_email_sent',
        'fratelli_was_unverified'
      ];
      
      keysToRemove.forEach(key => localStorage.removeItem(key));
      
      console.log('üßπ Datos de debug limpiados:', keysToRemove);
      FratelliPazzi.showNotification(
        'Todos los datos de debug han sido limpiados del navegador.',
        'success',
        'üßπ Limpieza completada'
      );
    };
    
    /**
     * Funci√≥n global para verificar el estado de Firebase
     * Uso en consola: checkFirebase()
     */
    window.checkFirebase = function() {
      const status = {
        firebaseLoaded: typeof window.firebase !== 'undefined',
        authLoaded: !!window.firebase?.auth,
        currentUser: !!window.firebase?.auth?.currentUser,
        userEmail: window.firebase?.auth?.currentUser?.email || null,
        userVerified: window.firebase?.auth?.currentUser?.emailVerified || false,
        functionsAvailable: {
          sendEmailVerification: !!window.firebase?.sendEmailVerification,
          createUser: !!window.firebase?.createUserWithEmailAndPassword,
          signIn: !!window.firebase?.signInWithEmailAndPassword
        }
      };
      
      console.log('üî• Estado de Firebase:', status);
      return status;
    };
    
    /**
     * Funci√≥n global para simular un registro completo (solo para testing)
     * Uso en consola: simulateRegistration('test@example.com', 'Test User')
     */
    window.simulateRegistration = function(email, name) {
      if (!email || !name) {
        console.error('‚ùå Uso: simulateRegistration("email@ejemplo.com", "Nombre Usuario")');
        return;
      }
      
      console.log('üß™ Simulando registro para:', { email, name });
      
      // Llenar el formulario autom√°ticamente
      const fillForm = () => {
        document.getElementById('register-name').value = name;
        document.getElementById('register-email').value = email;
        document.getElementById('register-password').value = 'test123456';
        document.getElementById('register-confirm-password').value = 'test123456';
        document.getElementById('register-terms').checked = true;
        
        console.log('üìù Formulario llenado autom√°ticamente');
        FratelliPazzi.showNotification(
          'Formulario de registro llenado autom√°ticamente.\n\nRevisa los datos y haz clic en "CREAR MI CUENTA" para probar.',
          'info',
          'üß™ Test de Registro'
        );
      };
      
      // Abrir el formulario de registro si no est√° abierto
      if (!document.getElementById('registerPopup').classList.contains('show')) {
        FratelliPazzi.showRegisterForm();
        setTimeout(fillForm, 500);
      } else {
        fillForm();
      }
    };
    
    console.log(`
üçï FRATELLI PAZZI - DEBUG CONSOLE
================================

Funciones disponibles en la consola:

üìß testEmails()           - Probar sistema de emails
üì® sendTestEmail()        - Enviar email de prueba
üîç debugInfo()           - Mostrar informaci√≥n de debug
üî• checkFirebase()       - Verificar estado de Firebase
üßπ clearDebugData()      - Limpiar datos de debug
üß™ simulateRegistration(email, name) - Simular registro

Ejemplo de uso:
> testEmails()
> sendTestEmail()
> simulateRegistration('test@ejemplo.com', 'Usuario Test')

Para debug avanzado usa: Ctrl+Alt+D
    `);
  </script>
</body>
</html>
